<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=0.8, user-scalable=no">
    <title>佩乐点点勒</title>
    <link rel="icon" href="pelkie.bmp" type="image/x-icon">
    <script type="text/javascript" src="vue.js"></script>
    <script type="text/javascript" src="pako.js"></script>
    <script type="text/javascript" src="break_infinity.js"></script>
    <style>
        body {
            text-align: center;
            font-family: MonospaceTypewriter, monospace;
        }

        button {
            text-align: center;
            font-family: MonospaceTypewriter, monospace;
            font-size: 16px;
        }

        .container {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 0 auto;
        max-width: 540px;
        width: 100%;
        background: #ffffff;
        border-radius: 10px;
        }

/* 移动端适配优化 */
        @media (max-width: 540px) {
            .container {
                width: 100%;
            }
        }

        .header-fixed {
            position: sticky;
            top: 0;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(5px);
            z-index: 100;
            width: 100%;
        }

        .header-text{
            font-weight: bold;
            line-height:150%;
        }

        .tabs {
            display: grid;
            grid-template-columns: repeat(4, minmax(130px,1fr)); /* 4列 */
            grid-auto-rows: minmax(40px, auto); /* 行高 */
            gap: 5px; /* 间距 */
            margin: 10px 0;
        }

        .tab {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            text-align: center;
            font-size: 16px;
        }

        /* 响应式适配 */
        @media (max-width: 540px) {
            .tabs {
                grid-template-columns: repeat(4, minmax(60px,130px));
            }

            .tab {
                font-size: 16px;
                padding: 5px;
            }
        }

        .active-tab {
            background-color: #f0f0f0;
        }

        .clickable {
            cursor: pointer;
        }

        .click-effects-container {
            position: relative;
            bottom: -50%;
            left: 30%;
            right: 0;
            pointer-events: none;
        }

        .click-effect {
            position: absolute;
            font-size: 16px;
            color: #114514;
            font-weight: bold;
            animation: floatUp 2s ease-out forwards;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        @keyframes floatUp {
            0% {
                transform: translateY(0);
                opacity: 1;
            }

            100% {
                transform: translateY(-100px);
                opacity: 0;
            }
        }

/* 响应式调整 */
        @media (max-width: 540px) {
            .big-pei {
                font-size: 80px;
            }

            .click-effect {
                font-size: 18px;
            }
        }

        .golden-pei {
            width: 50px;
            height: 50px;
            background-color: gold;
        }

        .golden-pei-hide {
            width: 50px;
            height: 50px;
            background-color: #cccccc;
        }

        .effect-toast {
            position: fixed;
            right: 20px;
            bottom: 20px;
            background: #fff3e0;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border-left: 5px solid #ff9800;
            animation: slideIn 0.3s ease-out;
        }

        .disabled {
            background-color: #ccc;
        }

        .divider {
            line-height:0px;
            color:white;
        }

        .building-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, 1fr);
        }

        .building {
            border: 2px solid #ccc;
            border-radius: 8px;
            padding: 8px;
            display: flex;
            align-items: center;
            justify-content: space-between; /* 添加这行 */
            background: #f8f8f8;
        }

        .bulk-selector {
            margin: 10px 0;
            padding: 5px;
            background: #f0f0f0;
        }

        .upgrade-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, 1fr);
        }

        .upgrade {
            border: 2px solid #ccc;
            border-radius: 4px;
            padding: 4px;
            display: flex;
            align-items: center;
            justify-content: space-between; /* 添加这行 */
            background: #f8f8f8;
        }

        .achievement-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, 1fr);
        }

        .achievement {
            border: 2px solid #ccc;
            border-radius: 4px;
            padding: 4px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #f8f8f8;
        }

            .achievement.unlocked {
                border-color: #4CAF50;
                background: #e8f5e9;
            }

        .achievement-icon {
            font-size: 2em;
            margin-right: 15px;
        }

        .achievement-info h4 {
            margin: 0 0 5px 0;
            color: #333;
        }

        .achievement-info p {
            margin: 0;
            color: #666;
        }

        .achievement-info small {
            color: #999;
            font-size: 0.8em;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
            }

            to {
                transform: translateX(0);
            }
        }

        .achievement-toast {
            position: fixed;
            right: 20px;
            bottom: 20px;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            animation: slideIn 0.3s ease-out;
            border-left: 5px solid #4CAF50;
        }

        .shop {
            margin-top: 20px;
            border-top: 2px solid #666;
            padding-top: 15px;
        }

        .upgrade-item {
            border: 2px solid #aaa;
            padding: 10px;
            border-radius: 5px;
            background: rgba(248,248,248,0.2);
        }

            .upgrade-item button {
                margin: 5px 0;
            }

            .upgrade-item.unlocked {
                border-color: #4CAF50;
                background: rgba(200,255,200,0.2);
            }


        .space {
            background-color: #001c60;
            color:#FFE29F
        }
        .space-reset-section {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .space-reset-button {
            background: #4a6cf7;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        .space-reset-button:hover {
            background: #3a5ce7;
        }
        .reset-locked {
            color: #ff6b6b;
        }
        .reset-ready {
            color: #4ecdc4;
        }
        .space-upgrades-tree {
            margin-top: 20px;
        }
        .upgrade-node {
            margin: 5px 0;
            padding: 5px;
            border-radius: 5px;
            background: rgba(0,0,0,0.2);
        }
        .upgrade-node.unlocked {
            background: rgba(78,205,196,0.2);
        }
        .children-container {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-left: 5px;
            padding-left: 5px;
            border-left: 2px dashed #4ecdc4;
        }
        .upgrade-info {
            min-width: 300px;
        }
                /* 进度条现代样式 */
        .progress-bar {
            height: 16px;
            background: #f0f0f0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
            margin: 8px;
        }
        .progress-bar > div {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50 0%, #81C784 100%);
            border-radius: 8px;
        }

        .pei-life {
            background: white;
            border:#dfbf0d solid 2px;
            border-radius: 8px;
            padding: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .pei-cele {
            background: white;
            border:#0d1bdf solid 2px;
            border-radius: 8px;
            padding: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .offline-toast {
            position: fixed;
            right: 20px;
            bottom: 80px;
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border-left: 5px solid #2196F3;
            animation: slideIn 0.3s ease-out;
        }
    </style>
</head>
<body>
    <div id="app" class="container">
        <div class="header-fixed" v-if="currentArea==1">
            <div class="header-text" style="font-size: 32px;">你有 {{ format(peiCount) }} 佩干</div>
            <div class="header-text" style="font-size: 20px;">{{ format(peiPerSecond) }}/秒</div>
            <div class="header-text" style="font-size: 20px;">{{ format(peiPerClick) }}/点击</div>
        </div>
        <div class="header-fixed" v-if="currentArea==2">
            <div class="header-text" style="font-size: 32px;">你有 {{ format(fosskie) }} 化石饼干</div>
            <div class="header-text" style="font-size: 20px;">{{ format(fosskiePerSecond) }}/秒</div>
            <div class="header-text" style="font-size: 20px;">{{ format(fosskiePerClick) }}/点击</div>
        </div>
        <div class="header-fixed" v-if="currentArea==4">
            <div class="header-text" style="font-size: 32px;">你有 {{ format(starkie) }} 星尘饼干</div>
            <div class="header-text" style="font-size: 20px;">{{ format(starkiePerSecond) }}/秒</div>
            <div class="header-text" style="font-size: 20px;">{{ format(starkiePerClick) }}/点击</div>
        </div>
        <div class="header-fixed" v-if="currentArea==5">
            <div class="header-text" style="font-size: 32px;">你有 {{ format(dataKie) }} 数据饼干</div>
            <div class="header-text" style="font-size: 20px;">{{ format(dataKiePerSecond) }}/秒</div>
            <div class="header-text" style="font-size: 20px;">{{ format(dataKiePerClick) }}/点击</div>
        </div>

        <div class="clickable" @click="clickPei" style="width: 200px; height: 200px; background-image: url('pelkie.bmp')">
            <div class="click-effects-container">
                <div v-for="(effect, index) in clickEffects"
                     :key="index"
                     :style="effect.style"
                     class="click-effect">
                    +{{ format(effect.amount) }}
                </div>
            </div>
        </div>

        <div :class="goldenPeiVisible?'golden-pei clickable':'golden-pei-hide'" @click="clickGoldenPei" style="font-size:36px; text-align:center">♅</div>

        <div class="bonus-status">
            <div>牛奶: {{ format(milk) }}</div>
            <div>糖块: {{ format(sugar) }}</div>
        </div>

        <div>金佩勒效果: <span id="effectSpan"></span></div>

        <div class="tabs">
            <div v-for="(tab, index) in tabs" :key="index"
                 v-show="showTab(index)"
                 class="tab clickable"
                 :class="{ 'active-tab': currentTab === index }"
                 @click="currentTab = index">
                {{ t(`t${index}_0`) }}
            </div>
        </div>

        <!-- 建筑选项卡 -->
        <div v-if="currentTab === 0">
            <div class="bulk-selector">
                {{ t('t0_1') }}
                <select v-model="bulkAmount">
                    <option value="1">×1</option>
                    <option value="10">×10</option>
                    <option value="100">×100</option>
                    <option value="1000">×1000</option>
                    <option value="10000">×10000</option>
                    <option value="100000">×100000</option>
                    <option value="1000000">×1000000</option>
                </select>
                <button @click="buyAllBuilding" v-show="ascensionCount.gte(1)">{{ t('t0_2') }}</button>
            </div>
            <div class="building-grid">
                <div class="divider">----------------------------------------------------------------</div>
                <div v-for="(building, index) in buildings" :key="index" class="building">
                    &nbsp;&nbsp;{{ t('t0_3') }}{{ building.id + 1 }}&nbsp;&nbsp;<br />
                    &nbsp;&nbsp;{{ t('t0_4') }}{{ formatInt(building.quantity) }}&nbsp;&nbsp;<br />
                    &nbsp;&nbsp;{{ t('t0_5') }}{{ format(building.baseProd) }}&nbsp;&nbsp;<br />
                    &nbsp;&nbsp;{{ t('t0_6') }}{{ format(building.production) }}&nbsp;&nbsp;
                    <button @click="buyBuilding(index)"
                            :disabled="peiCount.lt(calcBulkCost(index))">
                        {{ t('t0_7') }}{{ bulkAmount }}<br />
                        {{ t('t0_8') }} {{ format(calcBulkCost(index)) }} {{ t('t0_9') }}
                    </button>
                </div>
            </div>
        </div>

        <!-- 升级选项卡 -->
        <div v-if="currentTab === 1">
            <div style="font-size:24px">{{ t('t1_1') }} ({{ unlockedUpgradesCount }}/{{ upgrades.length }})</div>
            <div class="bulk-selector">
                <button @click="upgShowType = 1">{{ t('t1_2') }}</button>
                <button @click="upgShowType = 2">{{ t('t1_3') }}</button>
                <button @click="buyAllUpgrades" v-show="ascensionCount.gte(1)">{{ t('t1_4') }}</button>
            </div>
            <div class="upgrade-grid">
                <div class="divider">----------------------------------------------------------------</div>
                <div v-for="upgrade in upgrades"
                     :key="upgrade.buildingId*100+upgrade.id"
                     v-if="showUpgrade(upgrade)"
                     class="upgrade">
                    <div>
                        {{ t('t1_5') }}{{ upgrade.buildingId }}-{{ upgrade.id }}
                        <span v-if="upgrade.buildingId==1 & upgrade.id<4">{{ t('t1_6') }}</span>
                        <span v-if="upgrade.buildingId==1 & upgrade.id==4">{{ t('t1_7') }}</span>
                        <span v-if="upgrade.buildingId==1 & upgrade.id>4 & upgrade.id<=20">{{ t('t1_8') }}</span>
                        <span v-if="upgrade.buildingId<100 & upgrade.buildingId>1 & upgrade.id<=20">{{ t('t1_9') }}{{upgrade.buildingId}}{{ t('t1_10') }}</span>
                        <span v-if="upgrade.buildingId<100 & upgrade.id>20">{{ t('t1_9') }}{{upgrade.buildingId}}{{ t('t1_11') }}{{format(Decimal.pow(buildings[upgrade.buildingId-1].baseCost,0.1).mul(upgrade.buildingId==1?1:1e3))}}{{ t('t1_12') }}{{(upgrade.id-20)*(upgrade.id-19)*1000}}{{ t('t1_13') }}{{upgrade.buildingId}}{{ t('t1_14') }}{{upgrade.buildingId}}{{ t('t1_15') }}</span>   
                        <span v-if="upgrade.buildingId==101">{{ t('t1_16') }}</span>
                        <span v-if="upgrade.buildingId==102">{{ t('t1_17') }}{{milkUpgradeBase[upgrade.id-1]*0.001.toFixed(3)}}{{ t('t1_18') }}</span>
                        <span v-if="upgrade.buildingId==103">{{ t('t1_19') }}{{upgrade.id+2}}{{ t('t1_20') }}{{upgrade.id}}{{ t('t1_21') }}</span>
                        <span v-if="upgrade.buildingId==104 & upgrade.id<6">{{ t('t1_22') }}{{Math.max(5,upgrade.id*25-25)}}{{ t('t1_23') }}</span>
                        <span v-if="upgrade.buildingId==104 & upgrade.id>=6">{{ t('t1_24') }}{{Math.pow(10,upgrade.id-6)}}{{ t('t1_25') }}</span>
                        <span v-if="upgrade.buildingId==105">{{ t('t1_26') }}{{Math.floor((upgrade.id-1)/10)+1}}{{ t('t1_23') }}</span>
                        <span v-if="upgrade.buildingId==106">{{ t('t1_26') }}10{{ t('t1_27') }}{{upgrade.required}}{{ t('t1_28') }}</span>
                        <span v-if="upgrade.buildingId==107 & upgrade.id==1">{{ t('t1_29') }}</span>
                        <span v-if="upgrade.buildingId==107 & upgrade.id==2">{{ t('t1_30') }}</span>
                        <span v-if="upgrade.buildingId==107 & upgrade.id==3">{{ t('t1_31') }}</span>
                        <span v-if="upgrade.buildingId==107 & upgrade.id==4">{{ t('t1_32') }}</span>
                        <span v-if="upgrade.buildingId==108">{{ t('t1_33') }}{{upgrade.id+1}}{{ t('t1_34') }}{{upgrade.id+2}}{{ t('t1_35') }}{{upgrade.id+2}}{{ t('t1_36') }}{{(upgrade.id)%40+3}}{{ t('t1_37') }}</span>
                        <span v-if="upgrade.buildingId==109">{{ t('t1_38') }}{{upgrade.id}}{{ t('t1_39') }}{{upgrade.id+2}}{{ t('t1_40') }}{{upgrade.id+2}}{{ t('t1_41') }}{{(upgrade.id+1)%40+3}}{{ t('t1_42') }}</span>
                        <span v-if="upgrade.buildingId==110">{{ t('t1_43') }}{{milkUpgradeBase[upgrade.id-1]*0.001.toFixed(3)}}{{ t('t1_44') }}</span>
                    </div>
                    <button @click="buyUpgrade(upgrade.id, upgrade.buildingId)"
                            :disabled="!canBuyUpgrade(upgrade)">
                        {{ format(upgrade.cost.mul(upgradeCostMult)) }} {{ t('t1_45') }}
                    </button>
                </div>
            </div>
        </div>

        <!-- 成就选项卡 -->
        <div v-if="currentTab === 2">
            <div style="font-size:24px">{{ t('t2_1') }} ({{ unlockedAchievementsCount }}/{{ achievements.length }})</div>
            <div class="bulk-selector">
                <button @click="achShowType = 1">{{ t('t2_2') }}</button>
                <button @click="achShowType = 2">{{ t('t2_3') }}</button>
                <button @click="achShowType = 3">{{ t('t2_4') }}</button>
            </div>
            <div class="achievement-grid">
                <div class="divider">----------------------------------------------------------------</div>
                <div v-for="achievement in achievements" 
                :key="achievement.buildingId*100+achievement.id" 
                class="achievement" :class="{ 'unlocked': achievement.unlocked }"
                v-if="achShowType==1 || (achShowType==2 && achievement.unlocked) || (achShowType==3 && !achievement.unlocked)">
                    <div class="achievement-info">
                        {{ achievement.unlocked ? '√' : '×' }} {{ t('t2_5') }}{{ achievement.buildingId }}-{{ achievement.id }}
                        <span v-if="achievement.buildingId<100">{{ t('t2_6') }}{{formatInt(achievement.required)}}{{ t('t2_7') }}{{achievement.buildingId}}</span>
                        <span v-if="achievement.buildingId==101">{{ t('t2_8') }}{{format(achievement.required)}}{{ t('t2_9') }}</span>
                        <span v-if="achievement.buildingId==102">{{ t('t2_10') }}{{format(achievement.required)}}{{ t('t2_11') }}</span>
                        <span v-if="achievement.buildingId==103">{{ t('t2_12') }}{{format(achievement.required)}}{{ t('t2_13') }}</span>
                        <span v-if="achievement.buildingId==104">{{ t('t2_14') }}{{format(achievement.required)}}{{ t('t2_15') }}</span>
                        <span v-if="achievement.buildingId==105">{{ t('t2_16') }}{{format(achievement.required)}}{{ t('t2_17') }}</span>
                        <span v-if="achievement.buildingId==106">{{ t('t2_18') }}{{format(achievement.required)}}{{ t('t2_19') }}</span>
                    </div>
                </div>
            </div>
        </div>

        <!--传送门选项卡-->
        <div v-if="currentTab === 3">
            <div class="divider">----------------------------------------------------------------</div>
            <div>{{ t('t3_1') }}</div>
            <div class="upgrade-item">
                {{ t('t3_2') }} - {{format(peiCount)}} {{ t('t3_3') }} {{currentArea==1?t('t3_4'):""}}
                <button @click="currentArea = 1" :disabled="currentArea==1">
                    {{ t('t3_5') }}
                </button>
            </div>
            <div class="upgrade-item">
                {{ t('t3_6') }} - {{format(fosskie)}} {{ t('t3_7') }} {{currentArea==2?t('t3_4'):""}}
                <button @click="currentArea = 2" :disabled="currentArea==2" v-if="this.hypercendU[2].level.gte(1)">
                    {{ t('t3_5') }}
                </button>
                <span v-else>{{t('t3_8')}}</span>
            </div>
            <div class="upgrade-item">
                {{ t('t3_9') }} - {{format(starkie)}} {{ t('t3_10') }} {{currentArea==4?t('t3_4'):""}}
                <button @click="currentArea = 4" :disabled="currentArea==4" v-if="this.refineryU[2].level.gte(1)">
                    {{ t('t3_5') }}
                </button>
                <span v-else>{{t('t3_11')}}</span>
            </div>
            <div class="upgrade-item">
                {{ t('t3_12') }}

            </div>
            <div class="upgrade-item">
                {{ t('t3_13') }} {{currentArea==3?t('t3_4'):""}}
                <button @click="currentArea = 3" :disabled="currentArea==3" v-if="this.hypercendU[5].level.gte(1) || this.spaceResetCount.gte(1)">
                    {{ t('t3_5') }}
                </button>
                <span v-else>{{t('t3_14')}}</span>
            </div>
            <div class="upgrade-item">
                {{ t('t3_15') }}
            </div>
        </div>

        <!-- 飞升选项卡 -->
        <div v-if="currentTab === 4">
            <div class="divider">----------------------------------------------------------------</div>
            <div v-if="canAscend">
                <p>{{ t('t4_1') }}{{ format(this.totalShards.sub(this.totalRealityShards).max(0)) }}{{ t('t4_2') }}{{format(nextShards)}}{{ t('t4_3') }}</p>
                <button @click="ascend" style="padding:5px 20px" :disabled="this.totalShards.sub(this.totalRealityShards).lte(0)">{{ t('t4_4') }}</button>
            </div>
            <div v-else>
                <p>{{ t('t4_5') }}{{ format(totalLifetimePei) }}{{ t('t4_6') }}</p>
            </div>
            <div v-if="this.ascensionCount.gte(1)" class="shop">
                <h4>{{ t('t4_7') }}{{ format(realityShards) }}{{ t('t4_8') }}{{format(totalRealityShards)}}{{ t('t4_9') }}</h4>
                <div class="bulk-selector">
                    <button @click="buyAllAscendU" v-show="ascensionCount.gte(1)">{{ t('t4_10') }}</button>
                    <button @click="refundAscendU">{{ t('t4_11') }}</button>
                </div>
                <div v-for="upgrade in ascendU" :key="upgrade.id" class="upgrade-item">
                    {{auDescription[upgrade.id-1]}}<br />
                    {{ t('t4_12') }}{{ formatInt(upgrade.level) }}{{ t('t4_13') }}{{ formatInt(upgrade.maxLevel) }}
                    <button @click="buyAscendU(upgrade.id-1)"
                            :disabled="realityShards.lt(upgrade.cost) || upgrade.level.gte(upgrade.maxLevel)">
                        {{ format(upgrade.cost) }}{{ t('t4_14') }}
                    </button>
                    <button v-show="ascendU[8].level.gte(1) & upgrade.id==9" @click="switchGolden">
                        {{ t('t4_15') }}{{enableGolden?t('t4_16'):t('t4_17')}}
                    </button>
                    <button v-show="ascendU[16].level.gte(1) & upgrade.id==17" @click="switchClick">
                        {{ t('t4_18') }}{{enableClick?t('t4_16'):t('t4_17')}}
                    </button>
                </div>
            </div>
            <div v-else class="shop">
                <p>{{ t('t4_19') }}</p>
            </div>
        </div>

        <!-- 轮回选项卡 -->
        <div v-if="currentTab === 5">
            <div class="divider">----------------------------------------------------------------</div>
            <div v-if="canTranscend">
                <p>{{ t('t5_1') }}{{ format(this.totalTP.sub(this.totalTranscendPoints).max(0)) }}{{ t('t5_2') }}{{format(nextTP)}}{{ t('t5_3') }}</p>
                <button @click="transcend" style="padding:5px 20px" :disabled="this.totalTP.sub(this.totalTranscendPoints).lte(0)">{{ t('t5_4') }}</button>
            </div>
            <div v-else>
                <p>{{ t('t5_5') }}{{ format(totalRealityShards) }}{{ t('t5_6') }}</p>
            </div>
            <div v-if="this.transcensionCount.gte(1)" class="shop">
                <div>{{ t('t5_7') }}{{format(transcendBonus)}}</div>
                <h4>{{ t('t5_8') }}{{ format(transcendPoints) }}{{ t('t5_9') }}{{ format(totalTranscendPoints) }}{{ t('t5_10') }}</h4>
                <div class="bulk-selector">
                    <button @click="buyAllTranscendU" v-show="breakCount.gte(1)">{{ t('t5_11') }}</button>
                    <button @click="refundTranscendU">{{ t('t5_12') }}</button>
                </div>
                <div v-for="upgrade in transcendU" :key="upgrade.id" class="upgrade-item" v-if="upgrade.id<=12">
                    {{tuDescription[upgrade.id-1]}}<br />
                    {{ t('t5_13') }}{{ formatInt(upgrade.level) }}{{ t('t5_14') }}
                    <button @click="buyTranscendU(upgrade.id-1)" 
                            :disabled="transcendPoints.lt(upgrade.cost)">
                        {{ format(upgrade.cost) }}{{ t('t5_15') }}
                    </button>
                </div>
                <p>{{ t('t5_16') }}</p>
                <div v-for="upgrade in transcendU" :key="upgrade.id" class="upgrade-item" v-if="upgrade.id>=13">
                    {{tuDescription[upgrade.id-1]}}<br />
                    {{ t('t5_13') }}{{ formatInt(upgrade.level) }}{{ t('t5_17') }}{{upgrade.maxLevel}}
                    <button @click="buyTranscendU(upgrade.id-1)" 
                            :disabled="transcendPoints.lt(upgrade.cost) | upgrade.level.gte(upgrade.maxLevel)">
                        {{ format(upgrade.cost) }}{{ t('t5_15') }}
                    </button>
                </div>
            </div>
            <div v-else class="shop">
                <p>{{ t('t5_18') }}</p>
            </div>
        </div>

        <!-- 破碎选项卡 -->
        <div v-if="currentTab === 6">
            <div class="divider">----------------------------------------------------------------</div>
            <div v-if=canBreak>
                <p>{{ t('t6_1') }}</p>
                <button @click="doBreak" style="padding:5px 20px">{{ t('t6_2') }}</button>
            </div>
            <div v-else>
                <p>{{ t('t6_3') }}{{format(nextBreak)}}{{ t('t6_4') }}{{ format(totalTranscendPoints) }}{{ t('t6_5') }}{{format(nextBreak)}}{{ t('t6_6') }}</p>
            </div>
            <div v-if="this.breakCount.gte(1)" class="shop">
                <h4>{{ t('t6_7') }}{{ formatInt(this.breakCount) }}{{ t('t6_8') }}</h4>
                <div v-for="i in 16" class="upgrade-item" :class="{ 'unlocked': breakCount.gte(i<=8?i:i<=12?i*8-56:i*250-3000) }">
                    {{ t('t6_9') }}{{i<=8?i:i<=12?i*8-56:i*250-3000}}{{ t('t6_10') }}<br />
                    {{bmDescription[i-1]}}
                </div>
            </div>
            <div v-else class="shop">
                <p>{{ t('t6_11') }}</p>
            </div>
        </div>

        <!-- 觉醒选项卡 -->
        <div v-if="currentTab === 7">
            <div class="divider">----------------------------------------------------------------</div>
            <div v-if="canHypercend">
                <p>{{ t('t7_1') }}{{format(this.HPGain)}}{{ t('t7_2') }}</p>
                <button @click="hypercend" style="padding:5px 20px">{{ t('t7_3') }}</button>
            </div>
            <div v-else>
                <p>{{ t('t7_4') }}{{ formatInt(breakCount) }}{{ t('t7_5') }}{{ format(totalLifetimePei) }}{{ t('t7_6') }}</p>
            </div>
            <div v-if="this.hypercendCount.gte(1)" class="shop">
                <div>
                    {{ t('t7_7') }}{{format(this.hypercendPoints)}}{{ t('t7_8') }}{{format(this.totalHypercendPoints)}}{{ t('t7_9') }}{{format(this.maxHypercendPoints)}}{{ t('t7_10') }}
                </div>
                <h4>{{ t('t7_11') }}</h4> 
                <div v-for="upgrade in hypercendU" :key="upgrade.id" class="upgrade-item">
                    {{huDescription[upgrade.id-1]}}<br />
                    {{ t('t7_12') }}{{ formatInt(upgrade.level) }}{{ t('t7_13') }}{{ upgrade.maxLevel }}
                    <button @click="buyHypercendU(upgrade.id-1)"
                            :disabled="hypercendPoints.lt(upgrade.cost) | upgrade.level.gte(upgrade.maxLevel)">
                        {{ format(upgrade.cost) }}{{ t('t7_14') }}
                    </button>
                    <button @click="buyMaxHypercendU(upgrade.id-1)">
                        {{ t('t7_15') }}
                    </button>
                </div>
            </div>
            <div v-else class="shop">
                <p>{{ t('t7_16') }}</p>
            </div>
        </div>

        <!-- 自动化选项卡 -->
        <div v-if="currentTab === 8">
            <div class="divider">----------------------------------------------------------------</div>
            <h4>{{ t('t8_1') }}</h4>
            <div v-for="upgrade in automation" :key="upgrade.id" class="upgrade-item" v-if="upgrade.id<=(nobreakRecord.gte('1e25000')?24:sweetenCount.gte(1)?18:hypercendU[4].level.gte(1)?14:9)">
                {{autoDescription[upgrade.id-1]}}<br />
                <button @click="buyAuto(upgrade.id-1)" :disabled="upgrade.unlocked">
                    {{ t('t8_2') }}{{format(upgrade.cost)}}{{ t('t8_3') }}
                </button>
                <button @click="toggleAuto(upgrade.id-1)" :disabled="!upgrade.unlocked">
                    {{upgrade.activate?t('t8_4'):t('t8_5')}}
                </button>
            </div>
        </div>

        <!-- 充能选项卡 -->
        <div v-if="currentTab === 9">
            <div class="divider">----------------------------------------------------------------</div>
            <div v-if="hypercendU[0].level.gte(1)">
                {{ t('t9_1') }}{{format(hyperCharge)}}{{ t('t9_2') }}{{format(HCProduction)}}{{ t('t9_3') }}{{format(hyperEffect(0))}}{{ t('t9_4') }}<br />
                <h4>{{ t('t9_5') }}</h4>
                <div v-for="upgrade in hyperChargeU" :key="upgrade.id" class="upgrade-item" v-if="upgrade.id<=(condenseryU[1].gte1?24:refineryU[1].level.gte(1)?20:16)">
                    {{ t('t9_6') }}{{upgrade.id}}{{ t('t9_7') }}{{hcDescription[upgrade.id-1]}}<br />
                    {{ t('t9_8') }}{{format(hyperEffect(upgrade.id))}}<br />
                    <button @click="buyHyperChargeU(upgrade.id-1)" 
                            :disabled="hypercendPoints.lt(upgrade.cost)">
                        {{upgrade.unlocked?t('t9_9'):t('t9_10')+format(upgrade.cost)+t('t9_11')}}<br />
                    </button>
                </div>
            </div>
            <div v-else>
                {{ t('t9_12') }}
            </div>
        </div>

        <!-- 统计选项卡 -->
        <div v-if="currentTab === 10">
            <h3>{{ t('t10_1') }}</h3>
            <div>{{ t('t10_2') }} {{format(peiCount)}}</div>
            <div>{{ t('t10_3') }} {{format(thisAscendPei)}}</div>
            <div>{{ t('t10_4') }} {{format(totalLifetimePei)}}</div>
            <div>{{ t('t10_5') }} {{format(peiPerSecond)}}</div>
            <div>{{ t('t10_6') }} {{format(totalClickPei)}}</div>
            <div>{{ t('t10_7') }} {{format(peiPerClick)}}</div>
            <div>{{ t('t10_8') }} {{goldenPeiClick}}</div>
            <div>{{ t('t10_9') }} {{format(ascensionCount)}}</div>
            <div>{{ t('t10_10') }} {{format(realityShards)}}</div>
            <div>{{ t('t10_11') }} {{format(totalRealityShards)}}</div>
            <div>{{ t('t10_12') }} {{format(transcensionCount)}}</div>
            <div>{{ t('t10_13') }} {{format(transcendPoints)}}</div>
            <div>{{ t('t10_14') }} {{format(totalTranscendPoints)}}</div>
            <div>{{ t('t10_15') }} {{format(hypercendCount)}}</div>
            <div>{{ t('t10_16') }} {{format(hypercendPoints)}}</div>
            <div>{{ t('t10_17') }} {{format(totalHypercendPoints)}}</div>
            <div>{{ t('t10_18') }} {{Math.floor(this.goldenPeiTimer)}}{{ t('t10_19') }}{{this.goldenPeiTimeCap.toFixed(0)}}</div>
            <div>{{ t('t10_20') }} {{ Math.floor(playTime) }}{{ t('t10_19') }}{{this.sugarTimeCap.toFixed(0)}}</div>
            <div>{{ t('t10_21') }} {{ format(milkBonus) }}</div>
            <div>{{ t('t10_22') }} {{ format(sugarBonus) }}</div>
            <div>{{ t('t10_23') }} {{ format(upgradeBonus) }}</div>
            <div>{{ t('t10_24') }} {{ format(ascendBonus) }}</div>
            <div>{{ t('t10_25') }} {{ format(transcendBonus) }}</div>
            <div>{{ t('t10_26') }} {{ format(breakBonus) }}</div>
            <div>{{ t('t10_27') }} {{ format(hypercendBonus) }}</div>
            <!-- 原有统计信息... -->
        </div>

        <!-- 杂项选项卡 -->
        <div v-if="currentTab === 11">
            <button @click="saveGame()">{{ t('t11_0') }}</button>
            <button @click="loadGame()">{{ t('t11_1') }}</button>
            <button @click="hardReset()" style="color:red">{{ t('t11_2') }}</button>
            <button @click="toggleLanguage()">{{ t('t11_35') }}</button>
            <div>
                {{ t('t11_3') }}<br />
                {{ t('t11_4') }}<br />
                {{ t('t11_5') }}<br />
                {{ t('t11_6') }}
                {{ t('t11_7') }}
                {{ t('t11_8') }}
                {{ t('t11_9') }}<br /><br />
                {{ t('t11_10') }}<br />
                {{ t('t11_11') }}<br />
                {{ t('t11_12') }}<br />
                {{ t('t11_13') }}<br /><br />
                {{ t('t11_14') }}<br />
                {{ t('t11_15') }}<br />
                {{ t('t11_16') }}<br />
                {{ t('t11_17') }}<br />
                {{ t('t11_18') }}<br />
                {{ t('t11_19') }}<br />
                {{ t('t11_20') }}<br />
                {{ t('t11_21') }}<br />
                {{ t('t11_22') }}<br />
                {{ t('t11_23') }}<br />
                {{ t('t11_24') }}<br />
                {{ t('t11_25') }}<br />
                {{ t('t11_26') }}<br />
                {{ t('t11_27') }}<br />
                {{ t('t11_28') }}<br />
                {{ t('t11_29') }}<br />
                {{ t('t11_30') }}<br />
                {{ t('t11_31') }}<br />
                {{ t('t11_32') }}<br />
                {{ t('t11_33') }}<br />
                {{ t('t11_34') }}<br />
            </div>
        </div>

        <div v-if="currentTab === 12">
            <div>
                {{ t('t12_1') }} 
                {{ t('t12_2') }}<br />
                {{ t('t12_3') }}
                {{ t('t12_4') }}<br />
                {{ t('t12_5') }}<br />
                <br />
                {{ t('t12_6') }}<br />
                {{ t('t12_7') }}<br />
                {{ t('t12_8') }}<br />
                {{ t('t12_9') }}<br />
                <br />
                {{ t('t12_10') }} {{format(fosskie)}}<br />
                {{ t('t12_11') }} {{format(totalFosskie)}}<br />
                {{ t('t12_12') }} {{format(resetFosskie)}}<br />
                {{ t('t12_13') }} {{format(icing)}}<br />
                {{ t('t12_14') }} {{format(totalIcing)}}<br />
                {{ t('t12_15') }} {{format(honey)}}<br />
                {{ t('t12_16') }} {{format(totalHoney)}}<br />
                {{ t('t12_17') }} {{format(caramel)}}<br />
                {{ t('t12_18') }} {{format(totalCaramel)}}<br />
            </div>
        </div>

        <!--中生代山谷选项卡-->
        <div v-if="currentTab === 13" class="building-grid">
            <div class="divider">----------------------------------------------------------------</div>
            <div>{{ t('t13_1') }}</div>
            <div>{{ t('t13_2') }}</div>
            <div>{{ t('t13_3') }}{{format(totalFosskie)}}</div>
            <div>{{ t('t13_4') }}{{format(this.totalFosskie.div(65536).add(1).pow(0.25))}}</div>
            <div class="bulk-selector">
                {{ t('t13_5') }}:
                <select v-model="bulkLifeAmount">
                    <option value="1">×1</option>
                    <option value="10">×10</option>
                    <option value="100">×100</option>
                    <option value="1000">×1000</option>
                </select>
            </div>
            <div v-for="(p, index) in peiLives" :key="index" class="pei-life" v-if="index<27">
                佩干生命{{ p.id }} - {{index%3==0?"草食":index%3==1?"肉食":"杂食"}}，{{index/3%3<1?"水生":index/3%3<2?"陆生":"两栖"}}，{{index/9%3<1?"小型":index/9%3<2?"中型":"大型"}} - {{p.progress.toFixed(1)}}/{{p.duration.toFixed(1)}}s<br />
                数量：{{p.level}} 基础产量：{{format(p.baseProd)}} 产量：{{format(calcLifeProd(index))}}<br />
                产量×{{format(calcLifeMult(index))}} 速度×{{format(calcSpeedMult(index))}} 价格÷{{format(calcCostMult(index))}}<br />
            <button @click="buyPeiLife(index, bulkLifeAmount)" :disabled="fosskie.lt(calcLifeBulkCost(index, bulkLifeAmount))">
                购买×{{bulkLifeAmount}}花费<br /> {{ format(calcLifeBulkCost(index, bulkLifeAmount)) }}
            </button>
            <button @click="unlockLifeAuto(index)" :disabled="p.level.lte(0) | fosskie.lt(p.baseCost.mul(10))">
                <div v-if="!p.auto">解锁自动生产<br />{{ format(p.baseCost.mul(10)) }}</div>
                <div v-else>已解锁<br />自动生产</div>
            </button>
            <button @click="startLifeProd(index)" :disabled="p.level.lte(0)">
                开始<br />生产
            </button>
            <div class="progress-bar">
                <div :style="{ width: p.progress/p.duration*100 + '%' }"></div>
            </div>
            </div>
            <div class="pei-life" v-if="refineryU[4].level.gte(1)">
                佩干生命28 - 进化的终极形态 - {{peiLives[27].progress.toFixed(1)}}/9e15s<br />
                数量：{{peiLives[27].level}} 基础产量：{{format(peiLives[27].baseProd)}} 产量：{{format(calcLifeProd(27))}}<br />
                产量×{{format(calcLifeMult(27))}} 速度×{{format(calcSpeedMult(27))}} 价格÷{{format(calcCostMult(27))}}<br />
            <button @click="buyPeiLife(27, bulkLifeAmount)" :disabled="fosskie.lt(calcLifeBulkCost(27, bulkLifeAmount))">
                购买×{{bulkLifeAmount}}花费<br /> {{ format(calcLifeBulkCost(27, bulkLifeAmount)) }}
            </button>
            <button @click="unlockLifeAuto(27)" :disabled="peiLives[27].level.lte(0) | fosskie.lt(peiLives[27].baseCost.mul(10))">
                <div v-if="!peiLives[27].auto">解锁自动生产<br />{{ format(peiLives[27].baseCost.mul(10)) }}</div>
                <div v-else>已解锁<br />自动生产</div>
            </button>
            <button @click="startLifeProd(27)" :disabled="peiLives[27].level.lte(0)">
                开始<br />生产
            </button>
            <div class="progress-bar">
                <div :style="{ width: peiLives[27].progress/peiLives[27].duration*100 + '%' }"></div>
            </div>
            </div>
        </div>

        <!--中生代山谷重置-->
        <div v-if="currentTab === 14">
            <div class="divider">----------------------------------------------------------------</div>
                <div v-if="resetFosskie.gte(1e12)">
                <p>{{ t('t14_1') }} {{format(icingGain)}} {{ t('t14_3') }}</p>
                <button @click="icingReset" style="padding:5px 20px">{{ t('t14_4') }}</button>
                </div>
                <div v-else>
                {{ t('t14_5') }}<br />
                {{format(resetFosskie)}}/1e12
                </div>
                <div v-if="resetFosskie.gte(1e48)" class="shop">
                <p>{{ t('t14_6') }} {{format(honeyGain)}} {{ t('t14_8') }}</p>
                <button @click="honeyReset" style="padding:5px 20px">{{ t('t14_9') }}</button>
                </div>
                <div v-else class="shop">
                {{ t('t14_10') }}<br />
                {{format(resetFosskie)}}/1e48
                </div>
                <div v-if="spaceResetCount.gte(1)">
                <div v-if="resetFosskie.gte(nextSweeten)" class="shop">
                <p>{{ t('t14_11') }}</p>
                <button @click="sweetenReset" style="padding:5px 20px">{{ t('t14_13') }}</button>
                </div>
                <div v-else class="shop">
                {{ t('t14_14') }}{{format(nextSweeten)}}{{ t('t14_15') }}<br />
                {{format(resetFosskie)}}/{{format(nextSweeten)}}
                </div>
                <div v-if="resetFosskie.gte(1e308) & sweetenCount.gte(8)" class="shop">
                <p>{{ t('t14_16') }} {{format(caramelGain)}} {{ t('t14_18') }}</p>
                <button @click="caramelReset" style="padding:5px 20px">{{ t('t14_19') }}</button>
                </div>
                <div v-else class="shop">
                {{ t('t14_20') }}<br />
                {{formatInt(sweetenCount)}}/8 {{format(resetFosskie)}}/1e308
                </div>
            </div>
        </div>


        <div v-if="currentTab === 15">
            <div class="divider">----------------------------------------------------------------</div>
            <div>
                {{ t('t12_13') }} {{format(icing)}}<br />
                {{ t('t12_15') }} {{format(honey)}}<br />
                {{ t('t12_17') }} {{format(caramel)}}<br />
                <p>{{ t('t15_1') }}</p>
                <div v-for="(tr, index) in traits" :key="index" class="pei-life" v-if="index<27">
                    {{ t('t15_2') }}{{index+1}}: {{ t('t15_3') }}{{index+1}}{{ t('t15_4') }}<br />
                    {{ t('t15_5') }}：{{tr.level}}，{{ t('t15_6') }}：×{{format(Decimal.pow(2,tr.level))}}<br />
                    <button @click="buyTrait(index)" :disabled="totalIcing.lte(0)">{{ t('t15_7') }}{{format(tr.cost)}}{{ t('t15_8') }}</button>
                </div>
                <p>{{ t('t15_9') }}</p>
                <div v-for="(tr, index) in traits" :key="index" class="pei-life" v-if="index>=27 & index<39">
                    {{ t('t15_10') }}{{index+1}}: {{ t('t15_11') }}{{traitDescription[index-27]}}<br />
                    {{ t('t15_5') }}：{{tr.level}}，{{ t('t15_6') }}：×{{index<36?format(Decimal.pow(2,tr.level)):format(tr.level.mul(0.2).add(1))}}<br />
                    <button @click="buyTrait(index)" :disabled="totalHoney.lte(0)">{{ t('t15_7') }}{{format(tr.cost)}}{{ t('t15_12') }}</button>
                </div>
                <p>{{ t('t15_13') }}</p>
                <div v-for="(tr, index) in traits" :key="index" class="pei-life" v-if="index>=39 & index<42">
                    {{ t('t15_14') }}{{index+1}}: {{ t('t15_15') }}{{index==39?"所有佩干生命产量×2":index==40?"所有佩干生命速度×2":"所有佩干生命价格÷2"}}<br />
                    {{ t('t15_5') }}：{{tr.level}}，{{ t('t15_6') }}：×{{format(Decimal.pow(2,tr.level))}}<br />
                    <button @click="buyTrait(index)" :disabled="totalCaramel.lte(0)">{{ t('t15_7') }}{{format(tr.cost)}}{{ t('t15_16') }}</button>
                </div>
            </div>
        </div>

        <div v-if="currentTab === 16">
            <div class="divider">----------------------------------------------------------------</div>
            <div v-if="this.sweetenCount.gte(1)">
                <h4>{{ t('t16_1') }} ({{ t('t16_2') }}{{ formatInt(this.sweetenCount) }}{{ t('t16_3') }})</h4>
                <div v-for="i in 12" class="upgrade-item" :class="{ 'unlocked': sweetenCount.gte(i<=8?i:i*4-24) }">
                    {{ t('t16_4') }}{{i<=8?i:i*4-24}}{{ t('t16_3') }}<br />
                    {{sweetDescription[i-1]}}
                </div>
            </div>
            <div v-else>
                <p>{{ t('t16_5') }}</p>
            </div>
        </div>

        <div v-if="currentTab === 17">
            <div class="divider">----------------------------------------------------------------</div>
            <div v-if="this.totalCaramel.gte(1)">
                <h4>{{ t('t17_1') }}</h4> 
                <div v-if="refineryU[0].level.gte(1)">
                    {{ t('t17_2') }}{{format(sugarCharge)}}{{ t('t17_3') }}(+{{format(SCproduction)}}/s){{ t('t17_4') }}{{format(sugarCharge.add(1))}}<br /><br />
                </div>
                <div v-for="upgrade in refineryU" :key="upgrade.id" class="upgrade-item">
                    {{reDescription[upgrade.id-1]}}<br />
                    {{ t('t17_5') }} {{ formatInt(upgrade.level) }}/{{ upgrade.maxLevel }}
                    <button @click="buyRefineryU(upgrade.id-1)"
                            :disabled="caramel.lt(upgrade.cost) | upgrade.level.gte(upgrade.maxLevel)">
                        {{ format(upgrade.cost) }} {{ t('t17_6') }}
                    </button>
                    <button @click="buyMaxRefineryU(upgrade.id-1)">
                        {{ t('t17_7') }}
                    </button>
                </div>
            </div>
            <div v-else>
                <p>{{ t('t17_8') }}</p>
            </div>
        </div>

        <div v-if="currentTab === 18" class="space">
            <div class="divider" style="color:#000080">----------------------------------------------------------------</div>
            您不满足于寻常世界的万物法则，将目光投向银河中未解的存在，并期待那些遥远的神秘能够满足自己的好奇心。<br />
            佩勒：无数维度、幽灵以及对量子世界的操控，将所有理想简化为无穷多的点，在无数领域进行实验，以及利用物质与反物质的湮灭。
            在这里？你把自己变成了八维生物，然后你在那里停得太久，以至于你周围形成了一片星云。<br />
            太空重置将重置几乎所有的之前内容（佩干、建筑、升级、飞升、轮回、破碎、觉醒、糖块、化石饼干、佩干生命、糖霜、蜂蜜、一星和二星性状），
            获得坚果，数量基于佩干总数和化石饼干总数:10^(sqrt(log10佩干*log10化石饼干)/1600)
            <div class="space-reset-section">
                <h4>太空重置</h4>
                <p v-if="!canSpaceReset" class="reset-locked">需要 {{format(this.totalLifetimePei)}}/1e20,000 佩干<br /> {{format(this.totalFosskie)}}/1e60 化石饼干</p>
                <div v-else class="reset-ready">
                    <p>当前可获得坚果: {{ format(nutGain) }}</p>
                    <button @click="spaceReset" class="space-reset-button">执行太空重置</button>
                </div>
            </div>
            <div class="upgrade-item" :class="{ 'unlocked': spaceResetCount.gte(1) }">
                 在1e20,000或更多佩干进行太空重置<br />
                 每次太空重置保留1飞升点、1轮回点、1次破碎、1觉醒点，在所有重置中保留1e4建筑1和建筑2，在中生代山谷中解锁变甜重置
            </div>
            <div class="upgrade-item" :class="{ 'unlocked': spaceRecord.gte('1e40000') }">
                 在1e40,000或更多佩干进行太空重置<br />
                 太空重置不再重置糖块
            </div>
            <div class="upgrade-item" :class="{ 'unlocked': spaceRecord.gte('1e60000') }">
                 在1e60,000或更多佩干进行太空重置<br />
                 太空重置不再重置自动化
            </div>
            <div class="upgrade-item" :class="{ 'unlocked': spaceRecord.gte('1e80000') }">
                 在1e80,000或更多佩干进行太空重置<br />
                 盐块的生产速度翻倍
            </div>
            <div class="upgrade-item" :class="{ 'unlocked': nobreakRecord.gte('1e30000') }">
                 在1e30,000或更多佩干且破碎次数不超过1次时进行太空重置<br />
                 解锁更多自动化
            </div>
            <div class="upgrade-item" :class="{ 'unlocked': nobreakRecord.gte('1e50000') }">
                 在1e50,000或更多佩干且破碎次数不超过1次时进行太空重置<br />
                 基于觉醒神器12效果加成焦糖产量(×{{format(N(this.totalLifetimePei.add(10).log(10)).pow(1/6))}})
            </div>
            <div class="upgrade-item" :class="{ 'unlocked': nobreakRecord.gte('1e100000') }">
                 在1e100,000或更多佩干且破碎次数不超过1次时进行太空重置<br />
                 未花费的坚果增加佩干产量(×{{format(this.nutCount.add(1).pow(4))}})
            </div>
            <div class="upgrade-item" :class="{ 'unlocked': nobreakRecord.gte('1e300000') }">
                 在1e300,000或更多佩干且破碎次数不超过1次时进行太空重置<br />
                 解锁下一层重置
            </div>
        </div>

        <div v-if="currentTab === 19" class="space">
            <div class="divider" style="color:#000080">----------------------------------------------------------------</div>
            <div class="space-upgrades-tree">
                <h3>太空升级树 ({{ format(nutCount) }} 坚果)</h3>
                <div class="upgrade-node">
                    <div class="upgrade-info">
                        <div>升级1 等级{{ spaceU[0].level }}/10</div>
                        <div>每级使化石饼干的产量×2(当前效果×{{format(Decimal.pow(2,spaceU[0].level))}})</div>
                        <button @click="buySpaceU(1)">{{ format(getSpaceUC(1)) }}坚果</button>
                    </div>
                    <div class="upgrade-info">
                        <div>升级2 等级{{ spaceU[1].level }}/10</div>
                        <div>每级使佩干的产量×65536(当前效果×{{format(Decimal.pow(65536,spaceU[1].level))}})</div>
                        <button @click="buySpaceU(2)">{{ format(getSpaceUC(2)) }}坚果</button>
                    </div>
                    <div class="children-container">
                        <div class="upgrade-node" :class="{unlocked: spaceU[0].level.gte(1) || spaceU[1].level.gte(1)}">
                            <div class="upgrade-info">
                                <div>升级3 等级{{ spaceU[2].level }}/10</div>
                                <div>每级使糖霜获取×2(当前效果×{{format(Decimal.pow(2,spaceU[2].level))}})</div>
                                <button @click="buySpaceU(3)" :disabled="spaceU[0].level.lt(1)">{{ format(getSpaceUC(3)) }}坚果</button>
                            </div>
                            <div class="upgrade-info">
                                <div>升级4 等级{{ spaceU[3].level }}/10</div>
                                <div>每级使飞升点数获取×256(当前效果×{{format(Decimal.pow(256,spaceU[3].level))}})</div>
                                <button @click="buySpaceU(4)" :disabled="spaceU[1].level.lt(1)">{{ format(getSpaceUC(4)) }}坚果</button>
                            </div>
                            <div class="children-container">
                                <div class="upgrade-node" :class="{unlocked: spaceU[2].level.gte(1) || spaceU[3].level.gte(1)}">
                                    <div class="upgrade-info">
                                    <div>升级5 等级{{ spaceU[4].level }}/10</div>
                                    <div>每级使蜂蜜获取×2(当前效果×{{format(Decimal.pow(2,spaceU[4].level))}})</div>
                                    <button @click="buySpaceU(5)" :disabled="spaceU[2].level.lt(1)">{{ format(getSpaceUC(5)) }}坚果</button>
                                    </div>
                                    <div class="upgrade-info">
                                    <div>升级6 等级{{ spaceU[5].level }}/10</div>
                                    <div>每级使轮回点数获取×16(当前效果×{{format(Decimal.pow(16,spaceU[5].level))}})</div>
                                    <button @click="buySpaceU(6)" :disabled="spaceU[3].level.lt(1)">{{ format(getSpaceUC(6)) }}坚果</button>
                                    </div>
                                    <div class="children-container">
                                        <div class="upgrade-node" :class="{unlocked: spaceU[4].level.gte(1) || spaceU[5].level.gte(1)}">
                                            <div class="upgrade-info">
                                            <div>升级7 等级{{ spaceU[6].level }}/10</div>
                                            <div>每级使焦糖获取×2(当前效果×{{format(Decimal.pow(2,spaceU[6].level))}})</div>
                                            <button @click="buySpaceU(7)" :disabled="spaceU[4].level.lt(1)">{{ format(getSpaceUC(7)) }}坚果</button>
                                            </div>
                                            <div class="upgrade-info">
                                            <div>升级8 等级{{ spaceU[7].level }}/10</div>
                                            <div>每级使觉醒点数获取×2(当前效果×{{format(Decimal.pow(2,spaceU[7].level))}})</div>
                                            <button @click="buySpaceU(8)" :disabled="spaceU[5].level.lt(1)">{{ format(getSpaceUC(8)) }}坚果</button>
                                            </div>
                                        <div class="children-container">
                                            <div class="upgrade-node" :class="{unlocked: spaceU[4].level.gte(1) || spaceU[5].level.gte(1)}">
                                            <div class="upgrade-info">
                                            <div>升级9 等级{{ spaceU[8].level }}/10</div>
                                            <div>每级使糖分充能获取×2(当前效果×{{format(Decimal.pow(2,spaceU[8].level))}})</div>
                                            <button @click="buySpaceU(9)" :disabled="spaceU[6].level.lt(1)">{{ format(getSpaceUC(9)) }}坚果</button>
                                            </div>
                                            <div class="upgrade-info">
                                            <div>升级10 等级{{ spaceU[9].level }}/10</div>
                                            <div>每级使觉醒充能获取×4(当前效果×{{format(Decimal.pow(4,spaceU[9].level))}})</div>
                                            <button @click="buySpaceU(10)" :disabled="spaceU[7].level.lt(1)">{{ format(getSpaceUC(10)) }}坚果</button>
                                            </div>
                                            </div>
                                        </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                                            <div class="upgrade-node">
                                            <div class="upgrade-info">
                                            <div>升级11 等级{{ spaceU[10].level }}/10</div>
                                            <div>每级使每个成就提供的牛奶+10%(当前效果×{{format(spaceU[10].level.mul(0.1).add(1))}})</div>
                                            <button @click="buySpaceU(11)">{{ format(getSpaceUC(11)) }}坚果</button>
                                            </div>
                                            <div class="upgrade-info">
                                            <div>升级12 等级{{ spaceU[11].level }}/10</div>
                                            <div>每级使糖块获取数量+10%(当前效果×{{format(spaceU[11].level.mul(0.1).add(1))}})</div>
                                            <button @click="buySpaceU(12)">{{ format(getSpaceUC(12)) }}坚果</button>
                                            </div>
                                            </div>
                
            </div>
        </div>

        <div v-if="currentTab === 20" class="space">
            <div class="divider" style="color:#000080">----------------------------------------------------------------</div>
            你有{{format(salt)}}盐块（进度{{format(N(playTime2))}}/{{format(N(saltTimeCap))}}）<br />
            将化石饼干产量乘以{{format(salt.div(1000).add(1))}}<br />
            （基于糖块数量，每秒获得{{format(sugar)}}盐块进度）<br />
            <h4>盐块升级</h4>
            <div v-for="upgrade in saltU" :key="upgrade.id" class="upgrade-item">
                <div>盐块升级{{ upgrade.id }} 等级{{ upgrade.level }}/9</div>
                <div>{{ upgrade.id==1?"每级将化石饼干产量+100%":upgrade.id==2?"每级将糖霜获取数量+100%":upgrade.id==3?"每级将蜂蜜获取数量+100%":upgrade.id==4?"每级将焦糖获取数量+100%":""}}(当前×{{ format(upgrade.level.add(1)) }})</div>
                <button @click="buySaltU(upgrade.id)">花费{{ format(upgrade.basecost) }}盐块</button>
            </div>
        </div>

        <div v-if="currentTab === 21" class="space">
            <div class="divider" style="color:#000080">----------------------------------------------------------------</div>
            <h4>高级成就</h4>
            <div>基于完成高级成就数量增加牛奶数量，每个增加1点牛奶</div><br />
            <div class="achievement-grid">
                <div v-for="achievement in advancedAchievements" :key="achievement.id">
                    <div class="upgrade-item" v-if="achievement.id==1 || achievement.id==2 || (achievement.id==3 && refineryU[2].level.gte(1)) || (achievement.id==4 && condenseryU[2].level.gte(1))">
                        <div>{{ achievement.description }}</div><br />
                        <div>完成次数: {{ formatInt(achievement.completedTimes) }}</div><br />
                        <div>下一个目标: {{ format(advancedAchievementsTarget(achievement.id))}}</div>
                    </div>
                </div>
            </div>
        </div>

        <div v-if="currentTab === 22" class="space">
            <div class="divider" style="color:#000080">----------------------------------------------------------------</div>
            <div v-if="nobreakRecord.gte('1e300000') || cinnamonResetCount.gte(1) || vanillaResetCount.gte(1)">
                <div>第五层重置：香料重置(需要 1e1000000 佩干)</div>
                    <div>你有 {{format(cinnamon)}} 肉桂，{{format(vanilla)}} 香草</div>
                    <div>香料加成：佩干、化石饼干、星尘饼干获取数量 ×{{format(calculateSpiceBonus())}}</div>
                <div class="space-reset-section">
                <h4>肉桂重置</h4>
                <p>重置后获得：{{format(calculateSpiceGain())}} 肉桂</p>
                <p>第一次重置解锁蚁丘</p>
                <button @click="cinnamonReset" class="space-reset-button" :disabled="peiCount.lt(Decimal.pow(10, 1000000))">
                    肉桂重置
                </button>
                </div>
                <div class="space-reset-section">
                <h4>香草重置</h4>
                <p>重置后获得：{{format(calculateSpiceGain())}} 香草</p>
                <p>第一次重置解锁挑战</p>
                <button @click="vanillaReset" class="space-reset-button" :disabled="peiCount.lt(Decimal.pow(10, 1000000))">
                    香草重置
                </button>
                </div>
                <div class="shop">
                    <h4>香料重置说明</h4>
                    <div>两个重置都会重置之前的所有内容，获得佩干数量^(1/1000000)-9肉桂或香草，基于肉桂和香草总数增加佩干、化石饼干、星尘饼干的乘数</div>
                </div>
            </div>
            <div v-else>需要获得太空里程碑8</div>
        </div>

        <div v-if="currentTab === 23" class="space">
            <div class="divider" style="color:#000080">----------------------------------------------------------------</div>
            <template v-if="cinnamonResetCount < 1">
                <div style="font-size: 16px; font-weight: bold; color: #ff0000;">需要进行1次肉桂重置</div>
            </template>
            <template v-else>
                <h3>蚁丘</h3>
            <div>蚁丘等级: {{formatInt(antHillLevel)}}</div>
            <div>蚂蚁释放速度: {{format(antReleaseSpeed)}}</div>
            <div>未被驱赶的蚂蚁: {{format(antsNotDriven)}}</div>
            <div>被驱赶的蚂蚁: {{format(antsDriven)}}</div>
            <div>肉桂效果: {{format(calculateCinnamonEffect())}}</div>
            <div>蚂蚁加成: ×{{format(calculateAntBonus())}}</div>
            <div class="shop">
                <h4>蚁丘说明</h4>
                <div>你可以设定放出蚂蚁的速度(=2^蚁丘等级-1)</div>
                <div>未被驱赶的蚂蚁会变成被驱赶的蚂蚁(速度为肉桂数量)</div>
                <div>超过100以后，肉桂的效果将开始下降，在超过40000、1.6e7、6.4e9时下降得更厉害</div>
                <div>被驱赶的蚂蚁可以增加第五层重置增加佩干、化石饼干、星尘饼干的获取数量的效果</div>
                <div>但未被驱赶的蚂蚁会使上述效果降低</div>
            </div>
            <div class="upgrade-item">
                <h4>蚁丘升级</h4>
                <div>当前等级: {{formatInt(antHillLevel)}}</div>
                <div>下一级蚂蚁释放速度: {{format(Decimal.pow(2, antHillLevel.add(1)).sub(1))}}</div>
                <!-- 这里可以添加蚁丘升级的按钮和成本，具体成本可以根据游戏平衡调整 -->
                <button @click="updateAntHillLevel(antHillLevel.add(1))">升级蚁丘</button>
                <button @click="updateAntHillLevel(antHillLevel.sub(1))">降级蚁丘</button>
            </div>
            </template>
        </div>

        <div v-if="currentTab === 24" class="space">
            <div class="divider" style="color:#000080">----------------------------------------------------------------</div>
            <template v-if="vanillaResetCount < 1">
                <div style="font-size: 16px; font-weight: bold; color: #ff0000;">需要进行1次香草重置</div>
            </template>
            <template v-else>
                <h3>挑战</h3>
            <div>你有 {{format(totalChallengeCompletions)}} 挑战完成次数</div>
            <div>香草数量：{{format(vanilla)}}</div>
            <div>挑战加成：×{{format(calculateChallengeBonus())}}</div>
            <div class="achievement-grid">
                <div v-for="challenge in challenges" :key="challenge.id">
                    <div class="upgrade-item">
                        <p>{{ challenge.name }} : {{ challenge.description }}</p>
                        <p>完成次数: {{formatInt(challenge.completedTimes)}}</p>
                        <p>挑战要求：{{ format(Decimal.pow(10, challenge.completedTimes.add(1).mul(100000))) }}</p>
                        <p v-if="challenge.active">当前活动中</p>
                        <div v-if="canCompleteChallenge(challenge.id) && challenge.active">
                            <button @click="completeChallenge(challenge.id)">完成挑战</button>
                        </div>
                        <div class="bulk-selector">
                            <button @click="startChallenge(challenge.id)" :disabled="isChallengeActive()">
                                开始挑战
                            </button>
                            <button @click="endChallenge(challenge.id)" :disabled="!challenge.active">
                                结束挑战
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="shop">
                <h4>挑战说明</h4>
                <div>有5个挑战，进入挑战会强制进行太空重置</div>
                <div>每个挑战完成第n次需要10^(100000×n)佩干</div>
                <div>基于完成次数和香草数量增加第五层重置增加佩干、化石饼干、星尘饼干的获取数量的效果</div>
            </div>
            </template>
        </div>

        <div v-if="currentTab === 25" class="space">
            <div class="divider" style="color:#000080">----------------------------------------------------------------</div>
            <!--
                巫师塔
                魔法升级：
                <div>魔法升级1：每秒生产1魔法
                    <button @click="upgradeMagic(1)">升级魔法1，花费糖块</button>
                </div>
                <div>魔法升级2：魔法上限乘以2
                    <button @click="upgradeMagic(2)">升级魔法2，花费糖块</button>
                </div>
                魔法技能
                <div>魔法技能1：佩干的产量基于佩干增加
                    <button @click="magicSkill(1)">启用技能（花费100魔法，持续1分钟）</button>
                </div>
                <div>魔法技能2：化石饼干的产量基于化石饼干增加
                    <button @click="magicSkill(2)">启用技能（花费200魔法，持续1分钟）</button>
                </div>
                <div>魔法技能3：星尘饼干的产量基于星尘饼干增加
                    <button @click="magicSkill(3)">启用技能（花费300魔法，持续1分钟）</button>
                </div>
                <div>魔法技能4：数据饼干的产量基于数据饼干增加
                    <button @click="magicSkill(4)">启用技能（花费400魔法，持续1分钟）</button>
                </div>
                <div>魔法技能5：增加之前魔法的效果
                    <button @click="magicSkill(5)">启用技能（花费500魔法，持续1分钟）</button>
                </div>
            -->
            
        </div>

        <div v-if="currentTab === 26">
            <div class="divider">----------------------------------------------------------------</div>
            <div>
                你解锁了超越……<br />
                佩勒：你慢慢地探索了一切的界限，你并没有偏离既定的道路太远，除了在永恒中形成的[单星/星云/恒星]。
                生命就像火花，由偶然的闪电点燃。在适当的条件下，它可能会发光并传播，或闷烧并熄灭。也许这种情况在其他地方发生过无数次，也许只有一次。
                总有一天，太阳会熄灭，我们的火焰也必须熄灭吗？或者我们可以把余烬送到宇宙，送到陆地生命可以重新燃烧的地方？我想，我们可以。我们可以把余烬送到一个叫做[永恒]的地方。<br />
                基于星尘饼干总数，获得对所有牛奶升级的加成（×(1+星尘饼干/65536)^0.25），
                你可以提升牛奶层级，增加对佩干和化石饼干的加成。<br />
                <br />
                到达1e12星尘饼干后解锁“奶酪”重置，重置星尘饼干和佩干天体，获得奶酪。<br />
                到达1e48星尘饼干后解锁“奶油”重置，重置星尘饼干、佩干天体、奶酪、一星增强，获得奶油。<br />
                第5层重置一次且到达1e192星尘饼干后解锁“梦游”重置，重置星尘饼干、佩干天体、奶酪、奶油、一星和二星增强，使梦游次数增加1。<br />
                梦游8次并到达1e308星尘饼干后解锁“黄油”重置，重置梦游重置的内容获得黄油。<br />
                <br />
                <div>当前牛奶层级: {{milkLevel}}</div>
                <div>牛奶经验值: {{format(milkExp)}}/{{format(milkExpReq)}}</div>
                <div>当前牛奶种类：{{milkName[milkLevel.toNumber()]}}</div>
                <div>使每个牛奶增加佩干产量×{{format(milkLevel.mul(0.01).add(1))}}(总计×{{format(Decimal.pow(milkLevel.mul(0.01).add(1),milk))}})</div>
                <div>使每个牛奶增加化石饼干产量×{{format(milkLevel.mul(0.005).add(1))}}(总计×{{format(Decimal.pow(milkLevel.mul(0.005).add(1),milk))}})</div>
                <br />
                星尘饼干：{{format(starkie)}}<br />
                累计星尘饼干：{{format(totalStarkie)}}<br />
                本次重置中的星尘饼干：{{format(resetStarkie)}}<br />
                奶酪数量：{{format(cheese)}}<br />
                总计奶酪数量：{{format(totalCheese)}}<br />
                奶油数量：{{format(cream)}}<br />
                总计奶油数量：{{format(totalCream)}}<br />
                黄油数量：{{format(butter)}}<br />
                总计黄油数量：{{format(totalButter)}}<br />
            </div>
        </div>

        <div v-if="currentTab === 27">
            <div class="divider">----------------------------------------------------------------</div>
            <div>在超越中点击大佩干将获得星尘饼干</div>
            <div>佩干天体200级前每25级产量乘以3，之后每50级产量乘以3</div>
            <div>总计星尘饼干数量：{{format(totalStarkie)}}</div>
            <div>它们将牛奶升级效果乘以{{format(this.totalStarkie.div(65536).add(1).pow(0.25))}}</div>
            <div class="bulk-selector">
                购买数量: 
                <select v-model="bulkCeleAmount">
                    <option value="1">×1</option>
                    <option value="10">×10</option>
                    <option value="100">×100</option>
                    <option value="1000">×1000</option>
                </select>
            </div>
            <div v-for="(p, index) in peiCeles" :key="index" class="pei-cele">
                佩干天体{{ p.id }} - {{p.id<=32?"天体":"星际"}}，{{typename[celetype[p.id-1]]}} - {{p.progress.toFixed(1)}}/{{p.duration.toFixed(1)}}s<br />
                数量：{{p.level}} 基础产量：{{format(p.baseProd)}} 产量：{{format(calcCeleProd(index))}}<br />
                产量×{{format(calcCeleMult(index))}} 速度×{{format(calcCeleSpeedMult(index))}} 价格÷{{format(calcCeleCostMult(index))}}<br />
            <button @click="buyPeiCele(index, bulkCeleAmount)" :disabled="starkie.lt(calcCeleBulkCost(index, bulkCeleAmount))">
                购买×{{bulkCeleAmount}} 花费 {{ format(calcCeleBulkCost(index, bulkCeleAmount)) }}
            </button>
            <div class="progress-bar">
                <div :style="{ width: p.progress/p.duration*100 + '%' }"></div>
            </div>
            </div>
        </div>

        <div v-if="currentTab === 28">
            <div class="divider">----------------------------------------------------------------</div>
            <div v-if="resetStarkie.gte(1e12)">
                <p>奶酪重置将重置星尘饼干和佩干天体<br />获取 {{format(cheeseGain)}} 奶酪</p>
                <button @click="cheeseReset" style="padding:5px 20px">奶酪重置</button>
            </div>
            <div v-else>
                需要1e12本次重置中的星尘饼干才能进行奶酪重置<br />
                {{format(resetStarkie)}}/1e12
            </div>
            <div v-if="resetStarkie.gte(1e48)" class="shop">
                <p>奶油重置将重置星尘饼干、佩干天体、奶酪、一星增强<br />获取 {{format(creamGain)}} 奶油</p>
                <button @click="creamReset" style="padding:5px 20px">奶油重置</button>
            </div>
            <div v-else class="shop">
                需要1e48本次重置中的星尘饼干才能进行奶油重置<br />
                {{format(resetStarkie)}}/1e48
            </div>
            <div v-if="cinnamonResetCount.gte(1) || vanillaResetCount.gte(1)">
                <div v-if="resetStarkie.gte(nextDream)" class="shop">
                    <p>梦游重置将重置牛奶层级、星尘饼干、佩干天体、奶酪、一星增强、奶油、二星增强<br />将梦游次数增加1</p>
                    <button @click="dreamReset" style="padding:5px 20px">梦游重置</button>
                </div>
                <div v-else class="shop">
                    需要{{format(nextDream)}}本次重置中的星尘饼干才能进行梦游重置<br />
                    {{format(resetStarkie)}}/{{format(nextDream)}}
                </div>
                <div v-if="resetStarkie.gte(1e308) & dreamCount.gte(8)" class="shop">
                    <p>黄油重置将重置梦游重置的内容（但保留梦游次数）<br />获取 {{format(butterGain)}} 黄油</p>
                    <button @click="butterReset" style="padding:5px 20px">黄油重置</button>
                </div>
                <div v-else class="shop">
                    需梦游8次和1e308本次重置中的星尘饼干才能进行黄油重置<br />
                    {{formatInt(dreamCount)}}/8 {{format(resetStarkie)}}/1e308
                </div>
            </div>
        </div>
        
        <div v-if="currentTab === 29">
            <div class="divider">----------------------------------------------------------------</div>
            <div>
                奶酪数量：{{format(cheese)}}<br />
                奶油数量：{{format(cream)}}<br />
                黄油数量：{{format(butter)}}<br />
                <p>一星增强  奶酪重置一次后可购买</p>
                <div v-for="(e, index) in enhans" :key="index" class="pei-cele" v-if="index<14">
                    一星增强{{index+1}}: 每级将编号为14n+{{index+1}}的佩干天体产量×2<br />
                    等级：{{e.level}}，效果：×{{format(Decimal.pow(2,e.level))}}<br />
                    <button @click="buyEnhan(index)" :disabled="totalCheese.lte(0)">升级需要{{format(e.cost)}}奶酪</button>
                </div>
                <p>二星增强  奶油重置一次后可购买</p>
                <div v-for="(e, index) in enhans" :key="index" class="pei-cele" v-if="index>=15 & index<29">
                    二星增强{{index-14}}: 每级将{{typename[index-15]}}的速度×2<br />
                    等级：{{e.level}}，效果：×{{format(Decimal.pow(2,e.level))}}<br />
                    <button @click="buyEnhan(index)" :disabled="totalCream.lte(0)">升级需要{{format(e.cost)}}奶油</button>
                </div>
                <p>三星增强  黄油重置一次后可购买</p>
                <div v-for="(e, index) in enhans" :key="index" class="pei-cele" v-if="index>=30 & index<33">
                    三星增强{{index+1}}: 每级将{{index==39?"所有佩干天体产量×2":index==40?"所有佩干天体速度×2":"所有佩干天体价格÷2"}}<br />
                    等级：{{e.level}}，效果：{{format(Decimal.pow(2,e.level))}}<br />
                    <button @click="buyEnhan(index)" :disabled="totalButter.lte(0)">升级需要{{format(e.cost)}}黄油</button>
                </div>
            </div>
        </div>

        <div v-if="currentTab === 30">
            <div class="divider">----------------------------------------------------------------</div>
            <div v-if="this.dreamCount.gte(1)">
                <h4>梦游里程碑 (你梦游了{{ formatInt(this.dreamCount) }}次)</h4>
                <div v-for="i in 12" class="upgrade-item" :class="{ 'unlocked': dreamCount.gte(i<=8?i:i*4-24) }">
                    梦游{{i<=8?i:i*4-24}}次<br />
                    {{dreamDescription[i-1]}}
                </div>
            </div>
            <div v-else>
                <p>梦游重置1次以解锁</p>
            </div>
        </div>

        <div v-if="currentTab === 31">
            <div class="divider">----------------------------------------------------------------</div>
            <div v-if="dreamCount.gte(1)">
                <div>研究速度：×{{format(calcResearchSpeedMult())}}</div>
                <div v-for="(r, index) in astroResearch" :key="index" class="pei-cele" v-if="index < 14">
                天文研究{{ r.id }} - 等级：{{r.level}} - {{format(N(r.progress))}}/{{format(N(calcResearchDuration(index)))}}s<br />
                <div v-if="index < 14">
                    每级将佩干天体{{index*4+1}}至{{index*4+4}}的价格除以2（当前÷{{format(Decimal.pow(2, r.level))}}）
                </div>
                <div v-else>
                    研究奖励待定
                </div>
                <button @click="startAstroResearch(index)" :disabled="r.active" style="padding:5px 20px">
                    {{r.active ? '研究中' : '开始研究'}}
                </button>
                <button @click="cancelAstroResearch(index)" :disabled="!r.active" style="padding:5px 20px">
                    取消研究
                </button>
                <div class="progress-bar">
                    <div :style="{ width: r.progress/calcResearchDuration(index)*100 + '%' }"></div>
                </div>
                </div>
            </div>
            <div v-else>梦游重置1次以解锁</div>
        </div>
        <div v-if="currentTab === 32">
            <div class="divider">----------------------------------------------------------------</div>
        </div>
        <div v-if="currentTab === 33">
            <div class="divider">----------------------------------------------------------------</div>
        </div>

    </div>

    <script>
        var formatsave = {
            encoder: new TextEncoder(),
            decoder: new TextDecoder(),
            startString: 'PelkieClickerSaveFormat',
            endString: 'EndOfSaveFile',
            steps: [{
                encode: JSON.stringify,
                decode: JSON.parse
            },
            {
                encode: x => formatsave.encoder.encode(x),
                decode: x => formatsave.decoder.decode(x)
            },
            {
                encode: x => pako.deflate(x),
                decode: x => pako.inflate(x)
            },
            {
                encode: x => Array.from(x).map(i => String.fromCharCode(i)).join(""),
                decode: x => Uint8Array.from(Array.from(x).map(i => i.charCodeAt(0)))
            },
            {
                encode: x => btoa(x),
                decode: x => atob(x)
            },
            {
                encode: x => x.replace(/=+$/g, "").replace(/0/g, "0a").replace(/\+/g, "0b").replace(/\//g, "0c"),
                decode: x => x.replace(/0b/g, "+").replace(/0c/g, "/").replace(/0a/g, "0")
            },
            {
                encode: x => formatsave.startString + x + formatsave.endString,
                decode: x => x.slice(formatsave.startString.length, -formatsave.endString.length),
            }
            ],
            encode(s) {
                return this.steps.reduce((x, f) => f.encode(x), s);
            },
            decode(s) {
                return this.steps.reduceRight((x, f) => f.decode(x), s);
            },
        }

        function transformToDecimal(object) {
            for (i in object) {
                if (typeof (object[i]) == 'string' && !isNaN(N(object[i]).m)) object[i] = N(object[i]);
                if (typeof (object[i]) == 'object') transformToDecimal(object[i]);
            }
        }

        function data_print() {
            localStorage.PelkieClickerSave = formatsave.encode(JSON.stringify(data));
        }

        function data_input() {
            if (!localStorage.PelkieClickerSave) return;
            if (localStorage.PelkieClickerSave[0] == 'e') data = JSON.parse(atob(localStorage.PelkieClickerSave));
            else data = JSON.parse(formatsave.decode(localStorage.PelkieClickerSave));
            transformToDecimal(data);
        }

        async function jtb(text) {
            try {
                await navigator.clipboard.writeText(text);
                console.log('Text copied to clipboard');
            } catch (err) {
                console.error('Failed to copy text: ', err);
            }
        }

        function export_save() {
            jtb(formatsave.encode(JSON.stringify(data)));
        }

        function import_save() {
            let userInput = prompt("导入：", "输入存档");
            if (userInput != null && userInput !== "") {
                if (userInput[0] == 'e') data = JSON.parse(atob(userInput));
                else data = JSON.parse(formatsave.decode(userInput));
                transformToDecimal(data);
                data_print();
                location.reload();
            } else {
            }
        }

        function N(num) {
            return new Decimal(num);
        }

        const UPGRADES = (() => {
            const upgrades = [];
            upgrades.push({
                id: 0,
                buildingId: 1,
                required: N(0),
                cost: N(40),
            })
            //升级1~1050:建筑乘数升级
            for (let i = 1; i <= 1050; i++) {
                let index = (i-1) % 25 + 1;
                let bIndex = Math.floor((i-1) / 25);
                let costMult = [10,50,500,50000,5e6,5e9,5e12,5e15,5e18,5e21,5e24,5e27,5e30,5e33,5e36,5e39,5e42,5e48,5e54,5e60,5e120,'5e360','5e720','5e1200','5e1800'];
                let requirement = [1,5,25,50,100,150,200,250,300,350,400,450,500,550,600,650,700,800,900,1000,2000,6000,12000,20000,30000];
                upgrades.push({
                    id: index,
                    buildingId: bIndex+1,
                    required: N(requirement[index-1]),
                    cost: N(costMult[index-1]).mul(Math.pow(10, bIndex * (bIndex - 1) / 40 + bIndex + 1)),
                })
            }
            //升级1051~1070:点击乘数
            for (let i = 1; i <= 20; i++) {
                upgrades.push({
                    id: i,
                    buildingId: 101,
                    required: N(100).pow(i),
                    cost: N(100).pow(i).mul(5),
                })
            }
            //升级1071~1110:牛奶乘数
            for (let i = 1; i <= 40; i++) {
                upgrades.push({
                    id: i,
                    buildingId: 102,
                    required: i==1?N(10):N(25).mul(i-1),
                    cost: N(1000).pow(i).mul(9000),
                })
            }
            //升级1111~1150:建筑2协同
            for (let i = 1; i <= 40; i++) {
                upgrades.push({
                    id: i,
                    buildingId: 103,
                    required: N(15),
                    cost: N(Math.pow(10, i * (i - 1) / 40 + i + 1)).mul(150),
                })
            }
            //升级1151~1160:飞升效果
            for (let i = 1; i <= 10; i++) {
                let costs = [11, 1111, 111111, 11111111, 1111111111, 100, 1e12, 1e72, "1e432", "1e2592"];
                upgrades.push({
                    id: i,
                    buildingId: 104,
                    required: i,
                    cost: N(costs[i-1]),
                })
            }
            //升级1161~1250:飞升风味佩干
            for (let i = 1; i <= 90; i++) {
                let costs = [];
                upgrades.push({
                    id: i,
                    buildingId: 105,
                    required: N(Math.floor((i-1)/10)+1),
                    cost: i<=50?N(1e10).mul(N(10).pow(i/5)):N(100).pow(i),
                })
            }
            //升级1251~1290:建筑产量风味佩干
            for (let i = 1; i <= 40; i++) {
                upgrades.push({
                    id: i,
                    buildingId: 106,
                    required: i<=16?i*50+50:i*1000-16000,
                    cost: i<=16?N(1000).pow(i).mul(1e87):N(1e60).pow(i-16).mul(1e87),
                })
            }
            //升级1291~1299:金佩勒升级
            for (let i = 1; i <= 9; i++) {
                let requires = [7,27,77,0,9e15,9e15,9e15,9e15,9e15,]
                let costs = [777777777, 77777777777, 77777777777777, "1e6", "7e2777", "7e3777", "7e4777", "7e5777", "7e6777",];
                upgrades.push({
                    id: i,
                    buildingId: 107,
                    required: N(requires[i-1]),
                    cost: N(costs[i-1]),
                })
            }
            //升级1300~1339:飞升团结I升级,需要15个建筑
            for (let i = 1; i <= 40; i++) {
                upgrades.push({
                    id: i,
                    buildingId: 108,
                    required: N(15),
                    cost: N(Math.pow(10, (i + 1) * i / 40 + i + 2)).mul(150),
                })
            }
            //升级1340~1379:飞升团结II升级,需要75个建筑
            for (let i = 1; i <= 40; i++) {
                upgrades.push({
                    id: i,
                    buildingId: 109,
                    required: N(75),
                    cost: N(Math.pow(10, (i + 1) * i / 40 + i + 2)).mul(5e5),
                })
            }
            //升级1380~1419:释放糖块力量升级
            for (let i = 1; i <= 40; i++) {
                upgrades.push({
                    id: i,
                    buildingId: 110,
                    required: N(Math.floor((i-1)/10)+1),
                    cost: N(1e10).pow(i).mul(8e90),
                })
            }
            //其他升级……
            return upgrades;
        })();
        const ACHIEVEMENTS = (() => {
            const achievements = [];
            //成就 :累计获得的佩干数量
            for (let i = 1; i <= 25; i++) {
                let targetT = i <= 16 ? N(100).pow(i) : N(10).pow(N(2).pow(i - 15).mul(25));
                achievements.push({
                    id: i,
                    buildingId: 101,
                    required: targetT,
                })
            }
            //成就 :每秒获得的佩干数量
            for (let i = 1; i <= 25; i++) {
                let targetS = i <= 16 ? N(10).pow(i) : N(10).pow(N(2).pow(i - 15).mul(25));
                achievements.push({
                    id: i,
                    buildingId: 102,
                    required: targetS,
                })
            }
            //成就 :点击获得的佩干数量
            for (let i = 1; i <= 25; i++) {
                let targetC = i <= 16 ? N(100).pow(i) : N(10).pow(N(2).pow(i - 15).mul(25));
                achievements.push({
                    id: i,
                    buildingId: 103,
                    required: targetC,
                })
            }
            //成就 :拥有的建筑数量
            for (let i = 1; i <= 1050; i++) {
                let target = [1,50,100,150,200,250,300,350,400,450,500,600,700,800,900,1000,2000,3000,4000,5000,6000,7000,8000,9000,10000];
                achievements.push({
                    id: (i  -1) % 25 + 1,
                    buildingId: Math.floor((i-1)/25) + 1,
                    required: N(target[(i - 1) % 25]),
                })
            }
            //成就 :飞升层级成就
            for (let i = 1; i <= 25; i++) {
                let target = i <= 10 ? N(10).pow(i-1) : N(1e10).pow(i-10);
                achievements.push({
                    id: i,
                    buildingId: 104,
                    required: target,
                })
            }
            //成就 :超越层级成就
            for (let i = 1; i <= 25; i++) {
                let target = i <= 10 ? N(10).pow(i-1) : N(1e10).pow(i-10);
                achievements.push({
                    id: i,
                    buildingId: 105,
                    required: target,
                })
            }
            //成就 :觉醒层级成就
            for (let i = 1; i <= 25; i++) {
                let target = i <= 10 ? N(10).pow(i-1) : N(1e10).pow(i-10);
                achievements.push({
                    id: i,
                    buildingId: 106,
                    required: target,
                })
            }
            //成就 :其他……
            return achievements;
        })();
        const ASCENDU = (() => {
            const ascendU = [];
            ascendU.push({ id: 1, cost: N(1), maxLevel: N(1) });//解锁飞升系统
            ascendU.push({ id: 2, cost: N(3), maxLevel: N(3) });//佩干产量乘数+10% 3,3e3,3e6
            ascendU.push({ id: 3, cost: N(5), maxLevel: N(5) });//解锁风味佩干 5+n*10
            ascendU.push({ id: 4, cost: N(7), maxLevel: N(7) });//离线时长 7^(n+1)
            ascendU.push({ id: 5, cost: N(50), maxLevel: N(2) });//初始拥有10建筑1或2 50*10^2n
            ascendU.push({ id: 6, cost: N(77), maxLevel: N(10) });//金佩干出现频率提升10% 77*10^2n
            ascendU.push({ id: 7, cost: N(100), maxLevel: N(5) });//背包 n*10^2n
            ascendU.push({ id: 8, cost: N(777), maxLevel: N(10) });//金佩干技能时间提升10% 777*10^2n
            ascendU.push({ id: 9, cost: N(999), maxLevel: N(6) });//禁用金佩干，pps+40+10等级% 999*10^3n
            ascendU.push({ id: 10, cost: N(9000), maxLevel: N(10) });//牛奶效果加成
            ascendU.push({ id: 11, cost: N(99999), maxLevel: N(10) });//建筑、升级价格降低2% 99999*10^5n
            ascendU.push({ id: 12, cost: N(222222), maxLevel: N(2) });//解锁协同升级，当拥有15和75个建筑时出现
            ascendU.push({ id: 13, cost: N(399999), maxLevel: N(1) });//升级价格除以5
            ascendU.push({ id: 14, cost: N(1.5e7), maxLevel: N(1) });//1-6到1-20的乘数变为1000
            ascendU.push({ id: 15, cost: N(1e8), maxLevel: N(10) });//糖块生长10%更快
            ascendU.push({ id: 16, cost: N(2e8), maxLevel: N(10) });//释放糖块力量
            ascendU.push({ id: 17, cost: N(1e9), maxLevel: N(6) });//禁用点击，pps+40+10等级% 10^(2n+9)
            ascendU.push({ id: 18, cost: N(2e9), maxLevel: N(1) });//建筑2升级变为x3.2
            ascendU.push({ id: 19, cost: N(9e9), maxLevel: N(5) });//每级每个牛奶升级增加建筑29%
            ascendU.push({ id: 20, cost: N(3.2e10), maxLevel: N(40) });//解锁不受束缚的升级
            return ascendU;
        })();
        const TRANSCENDU = (() =>{
            const transcendU = [];
            for(let i=1;i<=12;i++) transcendU.push({ id: i, cost: N(1), maxLevel: N(9990)});
            transcendU.push({ id: 13, cost: N(10), maxLevel: N(1) });//轮回和飞升保留建筑
            transcendU.push({ id: 14, cost: N(100), maxLevel: N(1) });//禁用效果常时生效
            transcendU.push({ id: 15, cost: N(1000), maxLevel: N(1) });//金佩勒效果乘100
            transcendU.push({ id: 16, cost: N(10000), maxLevel: N(1) });//点击增加
            transcendU.push({ id: 17, cost: N(1e6), maxLevel: N(15) });//糖块生长增加20%
            transcendU.push({ id: 18, cost: N(1e6), maxLevel: N(15) });//金佩勒出现频率增加5%
            transcendU.push({ id: 19, cost: N(1e8), maxLevel: N(4) });//解锁更多风味佩干
            transcendU.push({ id: 20, cost: N(1e8), maxLevel: N(4) });//解锁糖块升级
            return transcendU;
        })();
        const HYPERCENDU = (() => {
            const hypercendU = [];
            hypercendU.push({ id: 1, cost: N(1), maxLevel: N(100) });//解锁觉醒充能，每级每秒获得1充能
            hypercendU.push({ id: 2, cost: N(1e6), maxLevel: N(100) });//解锁更多风味，充能率+49%每级
            hypercendU.push({ id: 3, cost: N(1e12), maxLevel: N(100) });//解锁更多风味，充能率+19%每级
            hypercendU.push({ id: 4, cost: N(1e18), maxLevel: N(100) });//解锁更多风味，充能率+9%每级
            hypercendU.push({ id: 5, cost: N(1e24), maxLevel: N(100) });//解锁更多风味，充能率+4%每级
            hypercendU.push({ id: 6, cost: N(1e100), maxLevel: N(100) });//解锁更多风味，充能率+1%每级
            return hypercendU;
        })();
        const HYPERCHARGEU = (() => {
            const hyperchargeU = [];
            const cost=[5,10,15,30,100,300,1500,6000,5e5,1e7,1e8,1e9,1e10,1e12,1e14,1e16,"1e500","1e700","1e850","1e1000", "1e5000", "1e7500", "1e10000", "1e15000"];
            for(let i=0;i<24;i++) hyperchargeU.push({ id: i+1, cost:N(cost[i]), unlocked:false });//根据你的觉醒点数提升佩干获取和觉醒充能速度
            return hyperchargeU;
        })();
        const AUTOMATION = (() => {
            const automation = [];
            const cost=[1e5,1e10,2.5e25,7.7e77,1e20,1e40,1e80,1e160,"1e640","1e5000","1e7500","1e10000","1e15000","1e22000","1e33000","1e50000","1e75000","1e100000","1e150000","1e220000","1e330000","1e500000","1e750000","1e1000000"]
            for(let i=0;i<24;i++){
                automation.push({id:i+1, cost: N(cost[i]), unlocked:false, activate: false});//自动购买
            }
            return automation;
        })();
        const SPACEU = (() => {
            const spaceU = [];
            spaceU.push({ id: 1, basecost:N(1), cost: N(1), maxLevel: N(10) });
            spaceU.push({ id: 2, basecost:N(1), cost: N(1), maxLevel: N(10) });
            spaceU.push({ id: 3, basecost:N(100), cost: N(1), maxLevel: N(10) });
            spaceU.push({ id: 4, basecost:N(100), cost: N(1), maxLevel: N(10) });
            spaceU.push({ id: 5, basecost:N(10000), cost: N(1), maxLevel: N(10) });
            spaceU.push({ id: 6, basecost:N(10000), cost: N(1), maxLevel: N(10) });
            spaceU.push({ id: 7, basecost:N(1e6), cost: N(1), maxLevel: N(10) });
            spaceU.push({ id: 8, basecost:N(1e6), cost: N(1), maxLevel: N(10) });
            spaceU.push({ id: 9, basecost:N(1e8), cost: N(1), maxLevel: N(10) });
            spaceU.push({ id: 10, basecost:N(1e8), cost: N(1), maxLevel: N(10) });
            spaceU.push({ id: 11, basecost:N(1e10), cost: N(1), maxLevel: N(10) });
            spaceU.push({ id: 12, basecost:N(1e10), cost: N(1), maxLevel: N(10) });
            return spaceU;
        })();
        const SALTU =(() => {
            const saltU = [];
            saltU.push({ id: 1, basecost:N(1), cost: N(1), maxLevel: N(9) });
            saltU.push({ id: 2, basecost:N(10), cost: N(1), maxLevel: N(9) });
            saltU.push({ id: 3, basecost:N(100), cost: N(1), maxLevel: N(9) });
            saltU.push({ id: 4, basecost:N(1000), cost: N(1), maxLevel: N(9) });
            return saltU;
        })();

        const REFINERYU = (() => {
            const refineryU = [];
            refineryU.push({ id: 1, basecost:N(1), cost: N(1), maxLevel: N(100) });
            refineryU.push({ id: 2, basecost:N(1), cost: N(1e6), maxLevel: N(100) });
            refineryU.push({ id: 3, basecost:N(1), cost: N(1e12), maxLevel: N(100) });
            refineryU.push({ id: 4, basecost:N(1), cost: N(1e18), maxLevel: N(100) });
            refineryU.push({ id: 5, basecost:N(1), cost: N(1e24), maxLevel: N(100) });
            return refineryU;
        })();
        const CONDENSERYU = (() => {
            const condenseryU = [];
            condenseryU.push({ id: 1, basecost:N(1), cost: N(1), maxLevel: N(100) });
            condenseryU.push({ id: 2, basecost:N(1), cost: N(1e6), maxLevel: N(100) });
            condenseryU.push({ id: 3, basecost:N(1), cost: N(1e12), maxLevel: N(100) });
            condenseryU.push({ id: 4, basecost:N(1), cost: N(1e18), maxLevel: N(100) });
            condenseryU.push({ id: 5, basecost:N(1), cost: N(1e24), maxLevel: N(100) });
            return condenseryU;
        })();
        const milkUpgradeBase=[
        4,5,6,7,8,8,8,8,8,7,
        6,5,4,4,4,4,1,1,1,1,
        1,2,2,2,2,2,3,3,3,3,
        3,5,5,5,6,6,6,7,7,7,
        ];
        const milkUpgradeBase2=[
        9,9,9,9,9,10,10,10,10,10,
        1,2,3,4,5,6,7,8,9,10,
        1,2,3,4,5,6,7,8,9,10,
        1,2,3,4,5,6,7,8,9,10,
        ]
        new Vue({
            el: '#app',
            data: {
                lastUpdate: 0,
                backgroundDelta: 0,
                currentTab: 0,
                currentArea: 1,
                
                tabs: ['建筑', '升级', '成就', '传送', '飞升', '轮回', '破碎', '觉醒', '自动', '充能', '统计', '杂项', 
                '简介', '生命', '声望', '性状', '变甜', '炼糖厂', 
                '太空重置', '太空升级', '盐块', '高级成就', '香料', '蚁丘', '挑战', '巫师塔',
                '简介', '天体', '声望', '增强', '梦游', '天文研究', '炼乳厂', '星座',
                '简介', '探索区域', '终末', '高级自动', '声望', '高级升级', '探索层级', '？？？'],
                
                currentLanguage: 'zh',
                texts: {
                    zh: {
                        t0_0: '建筑',
                        t0_1: '购买数量:',
                        t0_2: '一键购买',
                        t0_3: '建筑',
                        t0_4: '数量:',
                        t0_5: '基础佩干/秒:',
                        t0_6: '佩干/秒:',
                        t0_7: '购买 ×',
                        t0_8: '花费',
                        t0_9: '佩干',
                        t1_0: '升级',
                        t1_1: '升级',
                        t1_2: '显示未购买',
                        t1_3: '显示已购买',
                        t1_4: '一键购买',
                        t1_5: '升级',
                        t1_6: '点击和建筑 1 生产的佩干×2 ',
                        t1_7: '每个建筑使点击和建筑 1 生产的佩干 +1 ',
                        t1_8: '升级 1-4 的效果 ×20 ',
                        t1_9: '建筑 ',
                        t1_10: ' 的产量 ×2 ',
                        t1_11: ' 的产量 ×',
                        t1_12: '，从 ',
                        t1_13: ' 个建筑 ',
                        t1_14: ' 开始，每100个建筑 ',
                        t1_15: ' 使它的产量 ×2 ',
                        t1_16: '点击获得的佩干 +1% <del>每秒生产的佩干</del>',
                        t1_17: '释放牛奶力量(叠乘)，佩干产量 ×(1+牛奶*',
                        t1_18: ')',
                        t1_19: '建筑 2 的产量 ×2, 建筑 ',
                        t1_20: ' 的产量 +1% 每拥有 ',
                        t1_21: ' 个建筑 2 ',
                        t1_22: '每个累计的飞升点使佩干产量 +',
                        t1_23: '%',
                        t1_24: '佩干产量乘数 +',
                        t1_25: '%',
                        t1_26: '佩干产量乘数 +',
                        t1_27: '% (需要每个建筑数量',
                        t1_28: ')',
                        t1_29: '金佩勒出现频率翻倍，在屏幕上的持续时间翻倍',
                        t1_30: '<del>金佩勒出现频率翻倍，在屏幕上的持续时间翻倍</del>(被佩勒删除)',
                        t1_31: '<del>金佩勒效果的持续时间翻倍</del>(被佩勒删除)',
                        t1_32: '（这个升级是为了降低时间墙而添加的）佩干产量×1.01^max(50-飞升点/20, 0)（即佩干产量乘以约1.64，随飞升点获取增多，乘数逐渐减少到1）',
                        t1_33: '每个建筑 ',
                        t1_34: ' 增加 1% 建筑 ',
                        t1_35: ' 的产量，每个建筑 ',
                        t1_36: ' 增加 0.1% 建筑 ',
                        t1_37: ' 的产量',
                        t1_38: '每个建筑 ',
                        t1_39: ' 增加 1% 建筑 ',
                        t1_40: ' 的产量，每个建筑 ',
                        t1_41: ' 增加 0.1% 建筑 ',
                        t1_42: ' 的产量',
                        t1_43: '释放糖块力量(叠乘)，佩干产量 ×(1+糖块*',
                        t1_44: ')',
                        t1_45: '佩干',
                        t2_0: '成就',
                        t2_1: '成就',
                        t2_2: '显示全部',
                        t2_3: '显示已完成',
                        t2_4: '显示未完成',
                        t2_5: '成就',
                        t2_6: '拥有 ',
                        t2_7: ' 个建筑 ',
                        t2_8: '累计获得 ',
                        t2_9: ' 个佩干',
                        t2_10: '每秒生产 ',
                        t2_11: ' 个佩干',
                        t2_12: '点击获得 ',
                        t2_13: ' 个佩干',
                        t2_14: '累计获得 ',
                        t2_15: ' 个飞升点',
                        t2_16: '累计获得 ',
                        t2_17: ' 个轮回点',
                        t2_18: '累计获得 ',
                        t2_19: ' 个觉醒点',
                        t3_0: '传送',
                        t3_1: '点击传送进入其他区域，区域中的选项卡将发生变化，但不会重置任何资源',
                        t3_2: '佩干宇宙',
                        t3_3: '佩干',
                        t3_4: '（当前区域）',
                        t3_5: '传送',
                        t3_6: '中生代山谷',
                        t3_7: '化石饼干',
                        t3_8: '（需要觉醒升级3，1e12觉醒点）',
                        t3_9: '超越',
                        t3_10: '星尘饼干',
                        t3_11: '（需要炼糖厂升级3，1e12焦糖）',
                        t3_12: '探索中心（敬请期待）',
                        t3_13: '太空',
                        t3_14: '（需要觉醒升级6，1e100觉醒点）',
                        t3_15: '恒星（敬请期待）',
                        t4_0: '飞升',
                        t4_1: '飞升将重置佩干、建筑和升级，获取 ',
                        t4_2: ' 飞升点 (下一个在 ',
                        t4_3: ' 佩干)',
                        t4_4: '飞升!',
                        t4_5: '飞升(ascend)需要 1.000e12 累计佩干 (',
                        t4_6: '/1.000e12)',
                        t4_7: '飞升升级 (你有 ',
                        t4_8: '/',
                        t4_9: ' 飞升点)',
                        t4_10: '一键购买',
                        t4_11: '回退',
                        t4_12: '等级 ',
                        t4_13: '/',
                        t4_14: ' 飞升点',
                        t4_15: '金佩勒：',
                        t4_16: '启用',
                        t4_17: '禁用',
                        t4_18: '点击：',
                        t4_19: '飞升一次以解锁',
                        t5_0: '轮回',
                        t5_1: '轮回将重置佩干、建筑、升级、飞升点和飞升升级，获取 ',
                        t5_2: ' 轮回点(下一个在 ',
                        t5_3: ' 飞升点)',
                        t5_4: '轮回!',
                        t5_5: '轮回(transcend)需要 1.000e12 累计飞升点 (',
                        t5_6: '/1.000e12)',
                        t5_7: '你的总计轮回点数使佩干产量乘以',
                        t5_8: '轮回神器 (你有 ',
                        t5_9: '/',
                        t5_10: ' 轮回点)',
                        t5_11: '一键购买',
                        t5_12: '回退',
                        t5_13: '等级 ',
                        t5_14: '/9,990',
                        t5_15: ' 轮回点',
                        t5_16: '普通轮回升级',
                        t5_17: '/',
                        t5_18: '轮回一次以解锁',
                        t6_0: '破碎',
                        t6_1: '破碎将重置佩干、建筑、升级、飞升点、飞升升级、轮回点、轮回神器和升级，增加1次破碎次数',
                        t6_2: '破碎!',
                        t6_3: '破碎(break)需要 ',
                        t6_4: ' 累计轮回点 (',
                        t6_5: '/',
                        t6_6: ')',
                        t6_7: '破碎里程碑 (你破碎了',
                        t6_8: '次)',
                        t6_9: '破碎',
                        t6_10: '次',
                        t6_11: '破碎一次以解锁',
                        t7_0: '觉醒',
                        t7_1: '觉醒将重置破碎重置的内容（但保留破碎次数），获取 ',
                        t7_2: ' 觉醒点',
                        t7_3: '觉醒!',
                        t7_4: '觉醒(hypercend)需要 8 次破碎 (',
                        t7_5: '/8) 和 1.000e308 佩干 (',
                        t7_6: '/1.000e308)',
                        t7_7: '你有',
                        t7_8: '觉醒点，',
                        t7_9: '累计觉醒点，',
                        t7_10: '最高觉醒点',
                        t7_11: '觉醒升级',
                        t7_12: '等级 ',
                        t7_13: '/',
                        t7_14: ' 觉醒点',
                        t7_15: '购买最大',
                        t7_16: '觉醒一次以解锁',
                        t8_0: '自动',
                        t8_1: '自动化升级',
                        t8_2: '解锁需要 ',
                        t8_3: ' 佩干',
                        t8_4: '开启',
                        t8_5: '关闭',
                        t9_0: '充能',
                        t9_1: '你有 ',
                        t9_2: ' 觉醒充能 (+',
                        t9_3: '/s)，它将你的佩干产量提高 ',
                        t9_4: ' 倍。',
                        t9_5: '觉醒神器',
                        t9_6: '觉醒神器',
                        t9_7: '：',
                        t9_8: '当前效果：×',
                        t9_9: '已解锁',
                        t9_10: '解锁需要',
                        t9_11: '觉醒点',
                        t9_12: '需要购买觉醒升级1',
                        t10_0: '统计',
                        t10_1: '统计:',
                        t10_2: '当前佩干:',
                        t10_3: '本次飞升中的佩干:',
                        t10_4: '累计佩干:',
                        t10_5: '佩干每秒:',
                        t10_6: '点击获得的佩干:',
                        t10_7: '佩干每次点击:',
                        t10_8: '金佩勒点击数:',
                        t10_9: '飞升次数:',
                        t10_10: '当前飞升点:',
                        t10_11: '累计飞升点:',
                        t10_12: '轮回次数:',
                        t10_13: '当前轮回点:',
                        t10_14: '累计轮回点:',
                        t10_15: '觉醒次数:',
                        t10_16: '当前觉醒点:',
                        t10_17: '累计觉醒点:',
                        t10_18: '金佩勒计时：',
                        t10_19: '/',
                        t10_20: '糖块计时:',
                        t10_21: '牛奶乘数: x',
                        t10_22: '糖块乘数: x',
                        t10_23: '升级乘数: x',
                        t10_24: '飞升乘数: x',
                        t10_25: '轮回乘数: x',
                        t10_26: '破碎乘数: x',
                        t10_27: '觉醒乘数: x',
                        t11_0: '导出',
                        t11_1: '导入',
                        t11_2: '硬重置',
                        t11_3: '佩乐点点勒（pelkie clicker）-v0.5.0-作者：6左爷6',
                        t11_4: '（又叫做cookie clicker NG+3）',
                        t11_5: '本游戏参考了《饼干点点乐》、《王朝之系谱》、《从细胞到奇点》、《真实割草增量》，<del>你可以点击链接游玩它们</del>',
                        t11_6: '后续可能的更新：香料（第5层重置）、恒星（第6层重置）、',
                        t11_7: '副本2（超越，它的进度增加牛奶加成）、炼乳重置（2-1）、奶油重置（2-2）、梦游/黄油重置（2-3）、',
                        t11_8: '副本3（探索中心）、？？重置（3-1）、？？重置（3-2）、？？/？？重置（3-3）等等',
                        t11_9: '最终目标：到达1e9,000,000,000,000,000佩干并打败佩勒',
                        t11_10: '游戏说明：',
                        t11_11: '糖块：每3600秒产生1(基础值)糖块，糖块有被动加成（相当于用糖块轮流给每个建筑升级但升级价格总为1），购买对应升级后，基于糖块数量提高佩干产量乘数',
                        t11_12: '牛奶：每获得1个成就，获得1(基础值)牛奶，购买对应升级后，基于牛奶数量提高佩干产量乘数，部分升级、里程碑或其他机制会增加每个成就提供的牛奶数量',
                        t11_13: '金佩勒：每420秒上方的♅区域会变成金色，点击♅后会随机获得一个效果：获得15佩干产量(25%)，佩干产量×6持续66秒(16.7%)，点击产量×666持续13秒(16.7%)，随机建筑产量+10%(11.1%)，佩干产量×15持续630秒(8.3%)，点击产量×1111持续8秒(8.3%)，建筑价格-50%持续5秒(5.6%)，升级价格-50%持续5秒(5.6%)，获得1个糖块(2.7%)',
                        t11_14: 'Pelle毁灭了你的饼干宇宙，把你的饼干变成了佩勒饼干，你无法逃离被毁灭的饼干宇宙，你在整个游戏中都会受到重大削弱。',
                        t11_15: '削弱:',
                        t11_16: '风味饼干升级被删除（天堂升级和建筑数量相关的除外）',
                        t11_17: '删除研究中心',
                        t11_18: '删除老奶奶末世',
                        t11_19: '删除季节',
                        t11_20: '删除小游戏',
                        t11_21: '协同升级效果被削弱',
                        t11_22: '无法用糖块升级建筑',
                        t11_23: '移除了一些飞升升级',
                        t11_24: '移除了一些成就',
                        t11_25: '金饼干效果中的"7"变成"6"',
                        t11_26: '升级和效果中的一些文字被删除',
                        t11_27: '天堂碎片在1e12后公式变为饼干^1/4',
                        t11_28: '增强:',
                        t11_29: '声望等级效果x100',
                        t11_30: '糖块生长速度×24',
                        t11_31: '新增22个建筑',
                        t11_32: '一开始就有6小时80%的离线收益',
                        t11_33: '糖块对建筑有被动加成',
                        t11_34: '新的声望层级和游戏内容',
                        t11_35: '切换到英文',
                        t12_0: '简介',
                        t12_1: '解锁了中生代山谷……',
                        t12_2: '佩勒：为了实现你的 [命运/使命/目标]，我们为什么不回忆一下呢？毕竟，你一定喜欢 [错误/上帝/毁灭者] 荣耀的故事。',
                        t12_3: '你发现了一个奇怪的骨骼化石，现在我需要您模拟一个活体标本进行研究，这些生物曾经是地球上的主要生命形式，也许可以了解它们是如何走向灭亡的。',
                        t12_4: '您可以通过传送随时返回到主界面（佩干宇宙）。',
                        t12_5: '基于化石饼干总数，获得对所有糖块升级的加成（×(1+化石饼干)^0.25）',
                        t12_6: '到达1e12化石饼干后解锁"糖霜"重置，重置所有佩干生命，用糖霜升级一星特征',
                        t12_7: '到达1e48化石饼干后解锁"蜂蜜"重置，重置所有佩干生命和一星特征，用蜂蜜升级二星特征',
                        t12_8: '太空重置一次并到达1e192化石饼干后解锁变甜重置，重置所有佩干生命、一星、二星特征，基于变甜次数获得奖励',
                        t12_9: '变甜8次且到达1e308化石饼干后，解锁"焦糖"重置，重置变甜重置的内容，用焦糖升级三星特征',
                        t12_10: '化石饼干：',
                        t12_11: '化石饼干总数：',
                        t12_12: '本次重置中的化石饼干：',
                        t12_13: '糖霜数量：',
                        t12_14: '总计糖霜数量：',
                        t12_15: '蜂蜜数量：',
                        t12_16: '总计蜂蜜数量：',
                        t12_17: '焦糖数量：',
                        t12_18: '总计焦糖数量：',
                        t13_0: '生命',
                        t13_1: '在中生代山谷中点击大佩干将获得化石饼干',
                        t13_2: '佩干生命每500级产量乘以1e20',
                        t13_3: '总计化石饼干数量：',
                        t13_4: '它们将糖块升级效果乘以',
                        t13_5: '购买数量',
                        t13_6: '佩干生命',
                        t13_7: '草食',
                        t13_8: '肉食',
                        t13_9: '杂食',
                        t13_10: '水生',
                        t13_11: '陆生',
                        t13_12: '两栖',
                        t13_13: '小型',
                        t13_14: '中型',
                        t13_15: '大型',
                        t13_16: '数量',
                        t13_17: '基础产量',
                        t13_18: '产量',
                        t13_19: '产量',
                        t13_20: '速度',
                        t13_21: '价格',
                        t13_22: '购买',
                        t13_23: '花费',
                        t13_24: '解锁自动生产',
                        t13_25: '已解锁',
                        t13_26: '自动生产',
                        t13_27: '开始',
                        t13_28: '生产',
                        t13_29: '进化的终极形态',
                        t14_0: '声望',
                        t14_1: '糖霜重置将重置化石饼干和佩干生命（但保留自动生产）',
                        t14_2: '获取',
                        t14_3: '糖霜',
                        t14_4: '糖霜重置',
                        t14_5: '需要1e12本次重置中的化石饼干才能进行糖霜重置',
                        t14_6: '蜂蜜重置将重置化石饼干、佩干生命、糖霜、一星性状',
                        t14_7: '获取',
                        t14_8: '蜂蜜',
                        t14_9: '蜂蜜重置',
                        t14_10: '需要1e48本次重置中的化石饼干才能进行蜂蜜重置',
                        t14_11: '变甜重置将重置化石饼干、佩干生命、糖霜、一星性状、蜂蜜、二星性状',
                        t14_12: '将变甜次数增加1',
                        t14_13: '变甜重置',
                        t14_14: '需要',
                        t14_15: '本次重置中的化石饼干才能进行变甜重置',
                        t14_16: '焦糖重置将重置变甜重置的内容（但保留变甜次数）',
                        t14_17: '获取',
                        t14_18: '焦糖',
                        t14_19: '焦糖重置',
                        t14_20: '需变甜8次和1e308本次重置中的化石饼干才能进行焦糖重置',
                        t15_0: '性状',
                        t15_1: '一星性状（共27种） 糖霜重置一次后可购买',
                        t15_2: '一星性状',
                        t15_3: '每级将佩干生命',
                        t15_4: '产量×2',
                        t15_5: '等级',
                        t15_6: '效果',
                        t15_7: '升级需要',
                        t15_8: '糖霜',
                        t15_9: '二星性状（共12种） 蜂蜜重置一次后可购买',
                        t15_10: '二星性状',
                        t15_11: '每级',
                        t15_12: '蜂蜜',
                        t15_13: '三星性状（共3种） 焦糖重置一次后可购买',
                        t15_14: '三星性状',
                        t15_15: '每级将',
                        t15_16: '焦糖',
                        t16_0: '变甜',
                        t16_1: '变甜里程碑',
                        t16_2: '你变甜了',
                        t16_3: '次',
                        t16_4: '变甜',
                        t16_5: '变甜一次以解锁',
                        t17_0: '炼糖厂',
                        t17_1: '炼糖厂升级',
                        t17_2: '你有',
                        t17_3: '糖分充能',
                        t17_4: '，将化石饼干产量乘以',
                        t17_5: '等级',
                        t17_6: '焦糖',
                        t17_7: '购买最大',
                        t17_8: '焦糖重置一次以解锁',
                        t18_0: '太空重置',
                        t19_0: '太空升级',
                        t20_0: '盐块',
                        t21_0: '高级成就',
                        t22_0: '香料',
                        t23_0: '蚁丘',
                        t24_0: '挑战',
                        t25_0: '巫师塔',
                        t26_0: '简介',
                        t27_0: '天体',
                        t28_0: '声望',
                        t29_0: '增强',
                        t30_0: '梦游',
                        t31_0: '天文研究',
                        t32_0: '星座',
                        t33_0: '炼乳厂',
                    },
                    en: {
                        t0_0: 'Buildings',
                        t0_1: 'Buy Amount:',
                        t0_2: 'Buy All',
                        t0_3: 'Building',
                        t0_4: 'Quantity:',
                        t0_5: 'Base Pelkie/sec:',
                        t0_6: 'Pelkie/sec:',
                        t0_7: 'Buy ×',
                        t0_8: 'Cost',
                        t0_9: 'Pelkie',
                        t1_0: 'Upgrades',
                        t1_1: 'Upgrades',
                        t1_2: 'Show Unbought',
                        t1_3: 'Show Bought',
                        t1_4: 'Buy All',
                        t1_5: 'Upgrade',
                        t1_6: 'Click and Building 1 Pelkie production ×2 ',
                        t1_7: 'Each building increases click and Building 1 Pelkie production by +1 ',
                        t1_8: 'Effect of Upgrade 1-4 ×20 ',
                        t1_9: 'Building ',
                        t1_10: ' production ×2 ',
                        t1_11: ' production ×',
                        t1_12: ', starting from ',
                        t1_13: ' Building ',
                        t1_14: ', every 100 Buildings ',
                        t1_15: ' increases its production ×2 ',
                        t1_16: 'Click Pelkie +1% <del>Pelkie per second</del>',
                        t1_17: 'Release Milk Power (multiplicative), Pelkie production ×(1+Milk*',
                        t1_18: ')',
                        t1_19: 'Building 2 production ×2, Building ',
                        t1_20: ' production +1% per ',
                        t1_21: ' Building 2 ',
                        t1_22: 'Each cumulative ascension point increases Pelkie production by +',
                        t1_23: '%',
                        t1_24: 'Pelkie production multiplier +',
                        t1_25: '%',
                        t1_26: 'Pelkie production multiplier +',
                        t1_27: '% (requires each building quantity ',
                        t1_28: ')',
                        t1_29: 'Golden Pelle appearance frequency doubled, duration on screen doubled',
                        t1_30: '<del>Golden Pelle appearance frequency doubled, duration on screen doubled</del>(removed by Pelle)',
                        t1_31: '<del>Golden Pelle effect duration doubled</del>(removed by Pelle)',
                        t1_32: '(This upgrade is added to reduce time walls) Pelkie production ×1.01^max(50-ascension points/20, 0) (i.e., Pelkie production multiplied by approximately 1.64, multiplier gradually decreases to 1 as ascension points increase)',
                        t1_33: 'Each Building ',
                        t1_34: ' increases Building ',
                        t1_35: ' production by 1%, each Building ',
                        t1_36: ' increases Building ',
                        t1_37: ' production by 0.1%',
                        t1_38: 'Each Building ',
                        t1_39: ' increases Building ',
                        t1_40: ' production by 1%, each Building ',
                        t1_41: ' increases Building ',
                        t1_42: ' production by 0.1%',
                        t1_43: 'Release Sugar Lump Power (multiplicative), Pelkie production ×(1+Sugar*',
                        t1_44: ')',
                        t1_45: 'Pelkie',
                        t2_0: 'Achievements',
                        t2_1: 'Achievements',
                        t2_2: 'Show All',
                        t2_3: 'Show Completed',
                        t2_4: 'Show Incomplete',
                        t2_5: 'Achievement',
                        t2_6: 'Have ',
                        t2_7: ' Building ',
                        t2_8: 'Accumulate ',
                        t2_9: ' Pelkies',
                        t2_10: 'Produce ',
                        t2_11: ' Pelkies per second',
                        t2_12: 'Earn ',
                        t2_13: ' Pelkies per click',
                        t2_14: 'Accumulate ',
                        t2_15: ' Ascension Points',
                        t2_16: 'Accumulate ',
                        t2_17: ' Transcension Points',
                        t2_18: 'Accumulate ',
                        t2_19: ' Hypercension Points',
                        t3_0: 'Teleport',
                        t3_1: 'Click to teleport to other areas, the tabs in the area will change, but no resources will be reset',
                        t3_2: 'Pelkie Universe',
                        t3_3: 'Pelkie',
                        t3_4: '(Current Area)',
                        t3_5: 'Teleport',
                        t3_6: 'Mesozoic Valley',
                        t3_7: 'Fosskies',
                        t3_8: '(Requires Hypercend Upgrade 3, 1e12 Hypercension Points)',
                        t3_9: 'Beyond',
                        t3_10: 'Stardust Cookies',
                        t3_11: '(Requires Refinery Upgrade 3, 1e12 Caramel)',
                        t3_12: 'Exploration Center (Coming Soon)',
                        t3_13: 'Space',
                        t3_14: '(Requires Hypercend Upgrade 6, 1e100 Hypercension Points)',
                        t3_15: 'Stars (Coming Soon)',
                        t4_0: 'Ascend',
                        t4_1: 'Ascension will reset Pelkie, buildings, and upgrades, gaining ',
                        t4_2: ' Ascension Points (next at ',
                        t4_3: ' Pelkies)',
                        t4_4: 'Ascend!',
                        t4_5: 'Ascension requires 1.000e12 total Pelkies (',
                        t4_6: '/1e12)',
                        t4_7: 'Ascension Upgrades (You have ',
                        t4_8: '/',
                        t4_9: ' Ascension Points)',
                        t4_10: 'Buy All',
                        t4_11: 'Refund',
                        t4_12: 'Level ',
                        t4_13: '/',
                        t4_14: ' Ascension Points',
                        t4_15: 'Golden Pelle: ',
                        t4_16: 'Enabled',
                        t4_17: 'Disabled',
                        t4_18: 'Click: ',
                        t4_19: 'Ascend once to unlock',
                        t5_0: 'Transcend',
                        t5_1: 'Transcension will reset Pelkie, buildings, upgrades, ascension points, and ascension upgrades, gaining ',
                        t5_2: ' Transcension Points (next at ',
                        t5_3: ' Ascension Points)',
                        t5_4: 'Transcend!',
                        t5_5: 'Transcension requires 1.000e12 total ascension points (',
                        t5_6: '/1e12)',
                        t5_7: 'Your total transcension points multiply Pelkie production by',
                        t5_8: 'Transcension Artifacts (You have ',
                        t5_9: '/',
                        t5_10: ' Transcension Points)',
                        t5_11: 'Buy All',
                        t5_12: 'Refund',
                        t5_13: 'Level ',
                        t5_14: '/9,990',
                        t5_15: ' Transcension Points',
                        t5_16: 'Normal Transcension Upgrades',
                        t5_17: '/',
                        t5_18: 'Transcend once to unlock',
                        t6_0: 'Break',
                        t6_1: 'Breaking will reset Pelkie, buildings, upgrades, ascension points, ascension upgrades, transcension points, transcension artifacts and upgrades, increasing break count by 1',
                        t6_2: 'Break!',
                        t6_3: 'Breaking requires ',
                        t6_4: ' total transcension points (',
                        t6_5: '/',
                        t6_6: ')',
                        t6_7: 'Breaking Milestones (You have broken ',
                        t6_8: ' times)',
                        t6_9: 'Break ',
                        t6_10: ' times',
                        t6_11: 'Break once to unlock',
                        t7_0: 'Hypercend',
                        t7_1: 'Hypercend will reset break reset content (but keep break count), gain ',
                        t7_2: ' hypercension points',
                        t7_3: 'Hypercend!',
                        t7_4: 'Hypercend(hypercend) requires 8 breaks (',
                        t7_5: '/8) and 1e308 total Pelkie Biscuits (',
                        t7_6: '/1e308)',
                        t7_7: 'You have',
                        t7_8: ' hypercension points, ',
                        t7_9: 'total hypercension points, ',
                        t7_10: 'max hypercension points',
                        t7_11: 'Hypercension Upgrades',
                        t7_12: 'Level ',
                        t7_13: '/',
                        t7_14: ' hypercension points',
                        t7_15: 'Buy Max',
                        t7_16: 'Hypercend once to unlock',
                        t8_0: 'Automation',
                        t8_1: 'Automation Upgrades',
                        t8_2: 'Unlock requires ',
                        t8_3: ' Pelkies',
                        t8_4: 'Enable',
                        t8_5: 'Disable',
                        t9_0: 'Charge',
                        t9_1: 'You have ',
                        t9_2: ' hyper charge (+',
                        t9_3: '/s), it increases your Pelkie production by ',
                        t9_4: ' times.',
                        t9_5: 'Hypercension Artifacts',
                        t9_6: 'Hypercension Artifact',
                        t9_7: ': ',
                        t9_8: 'Current Effect: ×',
                        t9_9: 'Unlocked',
                        t9_10: 'Unlock requires',
                        t9_11: 'hypercension points',
                        t9_12: 'Need to buy Hypercension Upgrade 1',
                        t10_0: 'Stats',
                        t10_1: 'Stats:',
                        t10_2: 'Current Pelkies:',
                        t10_3: 'Pelkies in this ascension:',
                        t10_4: 'Total lifetime Pelkies:',
                        t10_5: 'Pelkies per second:',
                        t10_6: 'Pelkies from clicks:',
                        t10_7: 'Pelkies per click:',
                        t10_8: 'Golden Pelle clicks:',
                        t10_9: 'Ascension count:',
                        t10_10: 'Current ascension points:',
                        t10_11: 'Total ascension points:',
                        t10_12: 'Transcension count:',
                        t10_13: 'Current transcension points:',
                        t10_14: 'Total transcension points:',
                        t10_15: 'Hypercension count:',
                        t10_16: 'Current hypercension points:',
                        t10_17: 'Total hypercension points:',
                        t10_18: 'Golden Pelle timer:',
                        t10_19: '/',
                        t10_20: 'Sugar timer:',
                        t10_21: 'Milk multiplier: x',
                        t10_22: 'Sugar multiplier: x',
                        t10_23: 'Upgrade multiplier: x',
                        t10_24: 'Ascension multiplier: x',
                        t10_25: 'Transcension multiplier: x',
                        t10_26: 'Break multiplier: x',
                        t10_27: 'Hypercension multiplier: x',
                        t11_0: 'Export',
                        t11_1: 'Import',
                        t11_2: 'Hard Reset',
                        t11_3: 'Pelkie Clicker-v0.5.0-Author: 6左爷6',
                        t11_4: '(Also known as cookie clicker NG+3)',
                        t11_5: 'This game references Cookie Clicker, The Dynas Tree, Cell to Singularity, Real Grass Cutting Incremental, <del>You can click the links to play them</del>',
                        t11_6: 'Possible future updates: Spices (Layer 5 Reset), Stars (Layer 6 Reset),',
                        t11_7: 'Copy 2 (Transcendence, its progress increases milk bonus), Condensed Milk Reset (2-1), Cream Reset (2-2), Sleepwalking/Butter Reset (2-3),',
                        t11_8: 'Copy 3 (Exploration Center), ?? Reset (3-1), ?? Reset (3-2), ??/?? Reset (3-3), etc.',
                        t11_9: 'Final goal: Reach 1e9,000,000,000,000,000 Pelkie Biscuits and defeat Pelle',
                        t11_10: 'Game Instructions:',
                        t11_11: 'Sugar: Produces 1 (base value) sugar every 3600 seconds, sugar has passive bonuses (equivalent to using sugar to upgrade each building in turn but with upgrade cost always 1), after purchasing corresponding upgrades, increase Pelkie Biscuit production multiplier based on sugar quantity',
                        t11_12: 'Milk: Get 1 (base value) milk for each achievement, after purchasing corresponding upgrades, increase Pelkie Biscuit production multiplier based on milk quantity, some upgrades, milestones or other mechanisms will increase the milk provided by each achievement',
                        t11_13: 'Golden Pelle: Every 420 seconds, the ♅ area above turns golden, clicking ♅ will randomly get one effect: Gain 15 Pelkie Biscuit production (25%), Pelkie Biscuit production ×6 for 66 seconds (16.7%), Click production ×666 for 13 seconds (16.7%), Random building production +10% (11.1%), Pelkie Biscuit production ×15 for 630 seconds (8.3%), Click production ×1111 for 8 seconds (8.3%), Building price -50% for 5 seconds (5.6%), Upgrade price -50% for 5 seconds (5.6%), Gain 1 sugar (2.7%)',
                        t11_14: 'Pelle destroyed your cookie universe, turned your cookies into Pelle cookies, you cannot escape the destroyed cookie universe, you will suffer major nerfs throughout the game.',
                        t11_15: 'Nerfs:',
                        t11_16: 'Flavor cookie upgrades are removed (except for heaven upgrades and building quantity related ones)',
                        t11_17: 'Remove research center',
                        t11_18: 'Remove grandma apocalypse',
                        t11_19: 'Remove seasons',
                        t11_20: 'Remove mini-games',
                        t11_21: 'Synergy upgrade effects are weakened',
                        t11_22: 'Cannot upgrade buildings with sugar lumps',
                        t11_23: 'Removed some ascension upgrades',
                        t11_24: 'Removed some achievements',
                        t11_25: 'The "7" in golden cookie effects becomes "6"',
                        t11_26: 'Some texts in upgrades and effects are removed',
                        t11_27: 'Heavenly chips formula becomes cookies^1/4 after 1e12',
                        t11_28: 'Buffs:',
                        t11_29: 'Prestige level effect x100',
                        t11_30: 'Sugar lump growth rate ×24',
                        t11_31: 'Added 22 new buildings',
                        t11_32: 'Start with 6 hours of 80% offline production',
                        t11_33: 'Sugar has passive bonuses to buildings',
                        t11_34: 'New reputation levels and game content',
                        t11_35: 'Switch to Chinese',
                        t12_0: 'Introduction',
                        t12_1: 'Unlocked Mesozoic Valley...',
                        t12_2: 'Pelle: To fulfill your [destiny/mission/goal], why don\'t we take a trip down memory lane? After all, you must love the story of [error/god/destroyer]\'s glory.',
                        t12_3: 'You found a strange bone fossil, now I need you to simulate a living specimen for research. These creatures were once the dominant life forms on Earth, maybe we can understand how they went extinct.',
                        t12_4: 'You can teleport back to the main interface (Pelkie Universe) at any time.',
                        t12_5: 'Based on total fosskies, gain bonus to all sugar upgrades (×(1+fosskies)^0.25)',
                        t12_6: 'Reach 1e12 fosskies to unlock "Icing" reset, reset all pellives, use icing to upgrade 1-star traits',
                        t12_7: 'Reach 1e48 fosskies to unlock "Honey" reset, reset all pellives and 1-star traits, use honey to upgrade 2-star traits',
                        t12_8: 'Space reset once and reach 1e192 fosskies to unlock Sweeten reset, reset all pellives, 1-star traits, 2-star traits, gain bonuses based on sweeten count',
                        t12_9: 'Sweeten 8 times and reach 1e308 fosskies to unlock "Caramel" reset, reset sweeten reset content, use caramel to upgrade 3-star traits',
                        t12_10: 'Fosskies: ',
                        t12_11: 'Total Fosskies: ',
                        t12_12: 'Fosskies in this reset: ',
                        t12_13: 'Icing Quantity: ',
                        t12_14: 'Total Icing Quantity: ',
                        t12_15: 'Honey Quantity: ',
                        t12_16: 'Total Honey Quantity: ',
                        t12_17: 'Caramel Quantity: ',
                        t12_18: 'Total Caramel Quantity: ',
                        t13_0: 'Pellives',
                        t13_1: 'Clicking the big Pelkie in Mesozoic Valley will give you fosskies',
                        t13_2: 'Pellives production multiplied by 1e20 every 500 levels',
                        t13_3: 'Total Fosskies: ',
                        t13_4: 'They multiply sugar upgrade effects by',
                        t13_5: 'Buy Amount',
                        t13_6: 'Pellife',
                        t13_7: 'Herbivorous',
                        t13_8: 'Carnivorous',
                        t13_9: 'Omnivorous',
                        t13_10: 'Aquatic',
                        t13_11: 'Terrestrial',
                        t13_12: 'Amphibious',
                        t13_13: 'Small',
                        t13_14: 'Medium',
                        t13_15: 'Large',
                        t13_16: 'Quantity',
                        t13_17: 'Base Production',
                        t13_18: 'Production',
                        t13_19: 'Production',
                        t13_20: 'Speed',
                        t13_21: 'Price',
                        t13_22: 'Buy',
                        t13_23: 'Cost',
                        t13_24: 'Unlock Auto-Production',
                        t13_25: 'Unlocked',
                        t13_26: 'Auto-Production',
                        t13_27: 'Start',
                        t13_28: 'Production',
                        t13_29: 'Ultimate Evolutionary Form',
                        t14_0: 'Prestiges',
                        t14_1: 'Icing reset will reset fosskies and pellives (but keep auto-production)<br />Gain',
                        t14_2: 'Icing',
                        t14_3: 'Icing',
                        t14_4: 'Icing Reset',
                        t14_5: 'Need 1e12 fosskies in this reset for Icing reset',
                        t14_6: 'Honey reset will reset fosskies, pellives, icing, 1-star traits<br />Gain',
                        t14_7: 'Honey',
                        t14_8: 'Honey',
                        t14_9: 'Honey Reset',
                        t14_10: 'Need 1e48 fosskies in this reset for Honey reset',
                        t14_11: 'Sweeten reset will reset fosskies, pellives, icing, 1-star traits, honey, 2-star traits<br />Increase sweeten count by 1',
                        t14_12: '',
                        t14_13: 'Sweeten Reset',
                        t14_14: 'Need',
                        t14_15: 'fosskies in this reset for Sweeten reset',
                        t14_16: 'Caramel reset will reset sweeten reset content (but keep sweeten count)<br />Gain',
                        t14_17: 'Caramel',
                        t14_18: 'Caramel',
                        t14_19: 'Caramel Reset',
                        t14_20: 'Need 8 sweetens and 1e308 fosskies in this reset for Caramel reset',
                        t15_0: 'Traits',
                        t15_1: '1-star traits (27 total) Available after 1 icing reset',
                        t15_2: '1-star trait',
                        t15_3: 'Each level multiplies pellives',
                        t15_4: 'production ×2',
                        t15_5: 'Level',
                        t15_6: 'Effect',
                        t15_7: 'Upgrade requires',
                        t15_8: 'icing',
                        t15_9: '2-star traits (12 total) Available after 1 honey reset',
                        t15_10: '2-star trait',
                        t15_11: 'Each level',
                        t15_12: 'honey',
                        t15_13: '3-star traits (3 total) Available after 1 caramel reset',
                        t15_14: '3-star trait',
                        t15_15: 'Each level',
                        t15_16: 'caramel',
                        t16_0: 'Sweeten',
                        t16_1: 'Sweeten Milestones',
                        t16_2: 'You have sweetened',
                        t16_3: 'times',
                        t16_4: 'Sweeten',
                        t16_5: 'Sweeten once to unlock',
                        t17_0: 'Refinery',
                        t17_1: 'Refinery Upgrades',
                        t17_2: 'You have',
                        t17_3: ' sugar charge',
                        t17_4: ', multiply fosskie production by',
                        t17_5: 'Level',
                        t17_6: ' caramel',
                        t17_7: 'Buy Max',
                        t17_8: 'Caramel reset once to unlock',
                        t18_0: 'Space Reset',
                        t19_0: 'Space Upgrades',
                        t20_0: 'Salt',
                        t21_0: 'Advanced Ach',
                        t22_0: 'Spices',
                        t23_0: 'Anthill',
                        t24_0: 'Challenge',
                        t25_0: 'Wizard Tower',
                        t26_0: 'Introduction',
                        t27_0: 'Pelestials',
                        t28_0: 'Reputation',
                        t29_0: 'Enhancement',
                        t30_0: 'Sleepwalking',
                        t31_0: 'Astroresearch',
                        t32_0: 'Constellation',
                        t33_0: 'Condensery',

                    }
                },

                peiCount: N(0),
                thisAscendPei: N(0),
                totalLifetimePei: N(0),
                totalClickPei: N(0),
                peiPerSecond: N(0),
                peiPerClick: N(1),
                bulkAmount: 1,
                goldenPeiClick: 0,
                goldenPeiTimer: 0,
                goldenPeiVisible: false,
                goldenPeiEffects: {
                    clickMultiplier: N(1),
                    buildingMultiplier: N(1),
                    buildingCostReduction: N(1),
                    upgradeCostReduction: N(1),
                    randomBuildingBoost: null
                },
                effect: `无`,
                activeEffects: [],
                effectTimers: {},
                clickEffects: [],
                enableGolden: true,
                enableClick: true,
                upgShowType:1,
                achShowType:1,

                buildings: Array.from({ length: 42 }, (_, i) => ({
                    id: i,
                    quantity: N(0),
                    baseCost: N(10).pow(i * (i - 1) / 40 + i + 1),
                    cost: N(10).pow(i * (i - 1) / 40 + i + 1),
                    baseProd: N(8).pow(i - 1),
                    production: N(8).pow(i - 1),
                })),
                upgrades: UPGRADES.map(u => ({
                    ...u,
                    unlocked: false,
                })),
                achievements: ACHIEVEMENTS.map(a => ({
                    ...a,
                    unlocked: false,
                })),

                ascensionCount: N(0),
                realityShards: N(0),
                totalRealityShards: N(0),
                ascendU: ASCENDU.map(r => ({
                    ...r,
                    level: N(0),
                })),
                auDescription: [
                    "神啊！（解锁基于累计飞升点加成饼干产量的升级）",
                    "一个残余物（每级使佩干产量乘数+10%）",
                    "佩勒的5个裂隙（每级解锁10种佩干产量乘数+x%的升级）",
                    "6小时后更新（离线生产时间上限增加6小时）",
                    "飞升后保留10个前[该升级等级]种建筑",
                    "每级使金佩勒出现频率提升10%",
                    "飞升后保留前[该升级等级]个释放牛奶力量的升级",
                    "每级使金佩勒技能时间提升10%",
                    "可以选择禁用金佩勒，获得等级*10+40%佩干产量提升",
                    "释放牛奶力量(叠乘)，佩干产量×(1+0.001×等级×牛奶)",
                    "使建筑和升级的价格降低等级×2%",
                    "每级解锁40个协同升级，分别需要15和75个建筑3~42",
                    "升级的价格除以5",
                    "升级1-4的效果×25，点击产量×40",
                    "每级使糖块生长的速度增加20%",
                    "释放糖块力量(叠乘)，佩干产量×(1+0.001×等级×糖块)",
                    "可以选择禁用点击，获得等级*10+40%佩干产量提升",
                    "建筑2的×2升级效果变为×3.2",
                    "每级每个牛奶使建筑2产量增加0.2%",
                    "第n级该升级使建筑n+2的×2升级效果乘以1.05^(41-n)",
                ],
                
                transcensionCount: N(0),
                transcendPoints: N(0),
                totalTranscendPoints: N(0),
                transcendU: TRANSCENDU.map(r => ({
                    ...r,
                    level: N(0),
                })),
                tuDescription:[
                    "每级提升10%所有佩干获取（叠乘）",
                    "每级提升10%点击佩干获取（叠乘）",
                    "每级使建筑的价格减少1%（每级乘以0.99）",
                    "每级使升级的价格减少1%（每级乘以0.99）",
                    "每级使禁用金佩勒和点击的产量加成+10%",
                    "每级使金佩勒效果乘数+10%",
                    "每级使建筑1升级5~20的乘数+10%",
                    "每级使建筑2加成其他建筑的升级效果+10%",
                    "每级使释放糖块力量的效果+10%",
                    "每级使释放牛奶力量的效果+10%",
                    "每级使协同升级系列1(108-x)的效果+10%",
                    "每级使协同升级系列2(109-x)的效果+10%",
                    "每次轮回和飞升后保留100建筑1和建筑2",
                    "禁用金佩勒和点击的乘数变为常时生效",
                    "金佩勒获得饼干和随机建筑的效果乘以10",
                    "升级1-5至1-20的乘数乘以5",
                    "糖块的生长速度增加等级*20%，最高300%",
                    "金佩勒的出现频率增加等级*5%，最高75%",
                    "每级解锁10个新的“佩干产量乘数+x%”的升级(在1e100~1e180佩干)",
                    "每级解锁10个释放糖块力量的普通升级（糖块升级效果上限为1000糖块）",
                ],

                breakCount: N(0),
                breakTimer: N(0),
                bmDescription:[
                    "每次破碎使佩干产量×4，永久解锁自动化，每次飞升/轮回/破碎后保留1000建筑1和建筑2",
                    "糖块获取数量乘以破碎次数，最高乘以10(爆炸)",
                    "每个成就提供的牛奶翻倍(太爆炸了)",
                    "每破碎使建筑×2升级的基数加0.4，从4破碎开始8破碎结束",
                    "每破碎使轮回神器1和2的基数+2.23%，从5破碎开始8破碎结束",
                    "飞升升级18的效果变为×6",
                    "飞升升级20的效果变为×1.109569^(41-n)",
                    "解锁觉醒重置，每次破碎的饼干产量乘数变为10",
                    "佩干产量乘以(累计觉醒点+4)",
                    "每次破碎使觉醒点的获取数量+25%",
                    "每次破碎使觉醒充能翻倍，从27破碎开始90破碎结束",
                    "每次破碎使糖块生长速度+5%，从31破碎开始110破碎结束",
                    "100破碎之后的每次破碎增加化石饼干产量1%",
                    "100破碎之后的每次破碎增加佩干生命速度1%",
                    "100破碎之后的每次破碎增加佩干生命价格除数1%",
                    "每次破碎使糖块基础获取数量+0.001",
                ],

                hypercendCount: N(0),
                hypercendPoints: N(0),
                totalHypercendPoints: N(0),
                maxHypercendPoints:N(0),
                hyperCharge: N(0),
                hypercendU: HYPERCENDU.map(r => ({
                    ...r,
                    level: N(0),
                })),
                huDescription:[
                    "解锁觉醒充能和觉醒神器（在充能选项卡中），每秒产生等级^2觉醒充能",
                    "购买建筑不再消耗佩干，觉醒充能速度×(1+等级×0.49)^2",
                    "解锁中生代山谷（在传送选项卡），觉醒充能速度×(1+等级×0.19)^2",
                    "使金佩勒效果持续时间变为永久，觉醒充能速度×(1+等级×0.09)^2",
                    "解锁更多自动化升级，觉醒充能速度×(1+等级×0.04)^2",
                    "解锁太空，下一阶的重置，觉醒充能速度×(1+等级×0.01)^2"
                ],

                hyperChargeU: HYPERCHARGEU.map(r => ({
                    ...r,
                    level: N(0),
                })),
                hcDescription:[
                    "基于累计觉醒点数增加觉醒充能速度",//5HP(hypercension point,觉醒点)
                    "基于最高觉醒点数增加神器1效果",//10
                    "基于当前觉醒点数增加神器2效果",//15
                    "基于当前轮回点数增加神器1/2/3效果",//30
                    "基于判定中的觉醒点数增加神器4效果",//100
                    "神器1/2/3效果再次乘以神器4的效果",//300
                    "基于最高觉醒点和觉醒时间(最大900秒)增加觉醒点乘数",//1500
                    "基于糖块数量增加神器1~6的效果",//6000
                    "基于累计轮回点数增加觉醒充能速度",//5e5
                    "神器4和神器8的效果再生效一次",//1e7
                    "基于神器8的效果提升神器7的效果",//1e8
                    "基于累计佩干的对数提升神器1~8的效果",//1e9
                    "使神器12的效果对它自己生效",//1e10
                    "使神器12的效果乘以它的的1/3次方",//1e12
                    "使神器14的效果再生效一次，即变为乘以它的2/3次方",//1e14
                    "使神器14的效果再生效一次，即变为乘以它的1次方",//1e16
                    "根据盐块数量提升神器1/2/3/4/5/8/9/11/12的效果",
                    "基于觉醒点数提升神器17的效果",
                    "基于坚果数量提升神器18的效果",
                    "神器17/18/19的效果^4/3",
                    "基于牛奶层级提升神器17/18/19的效果",
                    "基于驱散的蚂蚁数量提升神器17/18/19的效果",
                    "基于完成的挑战数量提升神器17/18/19的效果",
                    "觉醒充能的产量^1.01",
                ],

                automation: AUTOMATION.map(a=>({
                    ...a,
                })),
                autoDescription:[
                    "自动购买建筑",
                    "自动购买升级",
                    "每0.1秒获得一次点击佩干收益",
                    "金佩勒出现时自动点击金佩勒",
                    "自动购买飞升升级",
                    "自动获得飞升点",
                    "自动购买轮回升级",
                    "自动获得轮回点",
                    "自动进行破碎，破碎不再重置任何东西",
                    "每秒自动生产100%判定中的觉醒点",//1~10:觉醒之前
                    "自动购买佩干生命，它们不消耗化石饼干",
                    "自动购买一星性状，它们不消耗糖霜",
                    "每0.1秒获得一次点击化石饼干收益",
                    "自动购买二星性状，它们不消耗蜂蜜",
                    "自动购买觉醒升级",
                    "每秒自动获得100%判定中的糖霜",
                    "自动购买觉醒神器",
                    "每秒自动获得100%判定中的蜂蜜",
                    "自动进行变甜，变甜不再重置任何东西",
                    "自动购买三星性状，它们不消耗焦糖",
                    "每秒自动获得100%判定中的焦糖",
                    "自动购买炼糖厂升级",
                    "自动购买坚果升级",
                    "每秒自动获得100%判定中的坚果",
                    "自动购买佩干天体，它们不消耗星尘饼干",
                    "每0.1秒获得一次点击星尘饼干收益",
                    "自动购买一星特征，它们不消耗奶酪",
                    "每秒自动获得100%判定中的奶酪",
                    "自动购买二星特征，它们不消耗奶油",
                    "每秒自动获得100%判定中的奶油",
                ],

                nutCount: N(0),
                spaceResetCount: N(0),
                spaceRecord: N(0),
                nobreakRecord: N(0),
                spaceU: SPACEU.map(u=>({
                    ...u,
                    level: N(0),
                })),
                saltU: SALTU.map(u=>({
                    ...u,
                    level: N(0),
                })),

                unlockedMesval: false,
                fosskie: N(0),
                totalFosskie: N(0),
                resetFosskie: N(0),
                icing: N(0),
                totalIcing: N(0),
                honey:N(0),
                totalHoney:N(0),
                sweetenCount: N(0),
                caramel:N(0),
                totalCaramel:N(0),
                sugarCharge:N(0),

                bulkLifeAmount: 1,
                peiLives: Array(28).fill().map((_,i) => ({
                    id: i+1,
                    level: N(0),       // 当前等级
                    progress: 0,       // 生产进度(秒)
                    auto: false,       // 自动生产
                    timer: null,
                    duration: i==27?9e15:Math.pow(10, i/10+0.4),//生产所需时间(秒)
                    baseCost: N(12).pow(i+1),//基础成本
                    baseProd: N(8).pow(i+1)//基础产量
                })),
                traits: Array(42).fill().map((_,i) => ({
                    id: i+1,
                    tier: i<27?1:i<39?2:i<42?3:0,
                    level: N(0),
                    cost: N(1)
                })),
                refineryU: REFINERYU.map(r => ({
                    ...r,
                    level: N(0),
                })),
                traitDescription:[
                    "将草食生命产量×2",
                    "将肉食生命产量×2",
                    "将杂食生命产量×2",
                    "将水生生命速度×2",
                    "将陆生生命速度×2",
                    "将两栖生命速度×2",
                    "将小型生命价格÷2",
                    "将中型生命价格÷2",
                    "将大型生命价格÷2",
                    "将点击获得的化石饼干+20%",
                    "将糖块获得的数量+20%",
                    "将糖块升级的效果+20%",
                ],
                sweetDescription:[
                    "佩干生命的速度乘以100，每次变甜增加5%坚果获取，解锁更多自动化",
                    "每次变甜+10%糖块获取数量",
                    "糖霜的获取数量乘以10000",
                    "糖块的获取数量翻倍",
                    "佩干生命的价格除以100",
                    "盐块的生产速度翻倍",
                    "蜂蜜的获取数量乘以10",
                    "解锁焦糖重置和炼糖厂升级",
                    "每次变甜增加25%焦糖获取",
                    "每次变甜增加250%觉醒点获取",
                    "每次变甜使盐块获取数量+10%",
                    "使变甜里程碑9和10的效果×4"
                ],
                reDescription:[
                    "解锁糖分充能，每级每秒生成总计焦糖数量的糖分充能",
                    "解锁觉醒神器17~20，糖分充能×1.096每级",
                    "解锁超越（在传送选项卡），糖分充能×1.072每级",
                    "星尘饼干产量×(变甜次数+1)，糖分充能×1.047每级",
                    "解锁佩干生命28(它的每500级乘数变为1e18，不被一星性状加成，但被所有二星性状加成)，糖分充能×1.023每级",
                ],
                
                // 佩干天体相关数据
                unlockedBeyond: false,
                starkie: N(0),
                totalStarkie: N(0),
                resetStarkie: N(0),
                cheese: N(0),
                totalCheese: N(0),
                cream: N(0),
                totalCream: N(0),
                dreamCount: N(0),
                butter: N(0),
                totalButter: N(0),
                milkCharge:N(0),
                      
                milkLevel: N(0),
                milkExp: N(0),
                milkName:["纯牛奶","巧克力奶","树莓奶","橙奶","焦糖奶","香蕉奶","酸橙奶","蓝莓牛奶","草莓奶","香草奶",
                "蜂蜜牛奶","咖啡牛奶","茶奶","椰奶","樱桃牛奶","五香牛奶","枫糖牛奶","薄荷奶","甘草奶","玫瑰牛奶",
                "火龙果奶","瓜奶","黑加仑奶","桃奶","榛子奶","柠檬奶","柚子奶","芒果奶","菠萝奶","荔枝奶",
                "葡萄奶","梨奶","猕猴桃奶","木瓜奶","杨桃奶","无花果奶","蔓越莓奶","百香果奶","山竹奶","杏仁奶",
                "核桃奶","腰果奶","栗子奶","开心果奶","茉莉奶","桂花奶","薰衣草奶","迷迭香奶","海盐奶","肉桂奶",
                "条纹牛奶","圆点牛奶","棋盘牛奶","三角牛奶","六边形奶","分形牛奶","箭头牛奶","拼图牛奶","星辰牛奶","宇宙牛奶",
                "终极牛奶"],
                celetype:[0,1,1,2,1,1,3,3,3,4,
                          2,4,2,4,2,4,5,6,6,6,
                          6,3,5,5,5,0,7,7,7,7,
                          0,0,8,8,8,8,9,9,9,9,
                          10,10,10,10,11,11,11,11,12,12,
                          12,12,13,13,13,13],
                typename:["恒星", "类地行星", "卫星", "小行星", "气态行星", "矮行星", "彗星", "奥尔特云", 
                "主序星", "后期恒星", "系外行星", "星云", "银河系", "超星系团"],
                bulkCeleAmount:1,
                peiCeles: Array(56).fill().map((_,i) => ({
                    id: i+1,
                    level: N(0),       // 当前等级
                    progress: 0,       // 生产进度(秒)
                    timer: null,
                    duration: Math.pow(10, (i+5)/10),//生产所需时间(秒)
                    baseCost: Decimal.pow(10,1+i+i*(i+1)/20),//基础成本
                    baseProd: Decimal.pow(8,1+i+i*(i+1)/20).div(4),//基础产量
                })),
                enhans: Array(40).fill().map((_,i) => ({
                    id: i+1,
                    tier: i<15?1:i<30?2:i<40?3:0,
                    level: N(0),
                    cost: N(1),
                })),
                astroResearch:Array(20).fill().map((_,i) => ({
                    id: i+1,
                    level: N(0),
                    duration: N(100),
                    progress: 0,
                    timer: null,
                    active: false,
                })),
                condenseryU: CONDENSERYU.map(c => ({
                    ...c,
                    level: N(0),
                })),
                dreamDescription:[
                    "解锁天文研究，并将研究速度乘以梦游次数",
                    "每次梦游将肉桂获取数量+5%",
                    "奶酪获取数量乘以10",
                    "每次梦游将香草获取数量+5%",
                    "佩干天体速度乘以10",
                    "奶油获取数量乘以10",
                    "佩干天体价格除以10",
                    "解锁黄油重置和炼奶厂升级",
                    "每次梦游将黄油获取数量+25%",
                    "每次梦游将焦糖获取数量+250%",
                    "每次梦游将觉醒点获取数量+2500%",
                    "从40梦游开始每次梦游将研究速度×1.25",
                ],
                condenseryDescription:[
                    "解锁牛奶充能，每级每秒生成总计黄油数量的牛奶充能",
                    "解锁觉醒神器21~24，牛奶充能×1.096每级",
                    "解锁探索中心（在传送选项卡），牛奶充能×1.072每级",
                    "数据饼干获取数量乘以（梦游次数+1），牛奶充能×1.047每级",
                    "解锁星座和星座碎片（还没出），牛奶充能×1.023每级",
                ],

                unlockedExplor: false,
                datakie: N(0),

                // 高级成就相关
                advancedAchievements: [
                    { id: 1, description: '获得大量佩干', completedTimes: N(0), type: 'pelkie' },
                    { id: 2, description: '获得大量化石饼干', completedTimes: N(0), type: 'fosskie' },
                    { id: 3, description: '获得大量星尘饼干', completedTimes: N(0), type: 'starkie' },
                    { id: 4, description: '获得大量数据饼干', completedTimes: N(0), type: 'datakie' },
                ],
                
                // 香料重置相关
                cinnamon: N(0),
                vanilla: N(0),
                cinnamonResetCount: N(0),
                vanillaResetCount: N(0),
                
                // 蚁丘相关
                antHillLevel: N(0),
                antReleaseSpeed: N(0),
                antsNotDriven: N(0),
                antsDriven: N(0),
                
                // 挑战相关
                challenges: [
                    { id: 1, name: '无飞升挑战', description: '不能获得飞升点', completedTimes: N(0), active: false },
                    { id: 2, name: '无轮回挑战', description: '不能获得飞升点和轮回点', completedTimes: N(0), active: false },
                    { id: 3, name: '无破碎挑战', description: '不能获得飞升点、轮回点和破碎次数', completedTimes: N(0), active: false },
                    { id: 4, name: '无觉醒挑战', description: '不能获得飞升点、轮回点、破碎次数和觉醒点', completedTimes: N(0), active: false },
                    { id: 5, name: '困难挑战', description: '不能获得飞升点、轮回点、破碎次数和觉醒点，佩干产量变为原来的平方根', completedTimes: N(0), active: false }
                ],
                totalChallengeCompletions: N(0),
                
                milk: N(0),
                sugar: N(0),
                salt: N(0),
                playTime: 0,
                playTime2: 0,
                totalPlayTime: 0,
                lastUpdateTime: Date.now(),
                // 其他数据...
            },
            methods: {
                t(textKey) {
                    return this.texts[this.currentLanguage][textKey] || textKey;
                },
                toggleLanguage() {
                    this.currentLanguage = this.currentLanguage === 'zh' ? 'en' : 'zh';
                },
                showTab(i) {
                    if(this.currentArea == 1){
                        if(this.breakCount.lt(1)) return [0,1,2,4,5,6,10,11].includes(i);
                        else return [0,1,2,3,4,5,6,7,8,9,10,11].includes(i);
                    }
                    if(this.currentArea == 2) return[3,11,12,13,14,15,16,17].includes(i);
                    if(this.currentArea == 3) return[3,11,18,19,20,21,22,23,24].includes(i);
                    if(this.currentArea == 4) return[3,11,26,27,28,29,30,31,32,33].includes(i);
                    //if(this.currentArea == 5) return[3,11,34,35,36,37,38,39].includes(i);
                    //if(this.currentArea == 6) return[3,11,40,41,42,43,44,45,46,47,48,49].includes(i);
                },
                clickPei() {
                    if(this.currentArea==1){
                        if(!this.enableClick) return;
                        this.peiCount = this.peiCount.add(this.peiPerClick);
                        this.totalClickPei = this.totalClickPei.add(this.peiPerClick);
                        this.thisAscendPei = this.thisAscendPei.add(this.peiPerClick);
                        this.totalLifetimePei = this.totalLifetimePei.add(this.peiPerClick);
                        this.addClickEffect(this.peiPerClick);
                    }
                    else if(this.currentArea==2){
                        this.fosskie = this.fosskie.add(this.fosskiePerClick);
                        this.totalFosskie = this.totalFosskie.add(this.fosskiePerClick);
                        this.resetFosskie = this.resetFosskie.add(this.fosskiePerClick);
                        this.addClickEffect(this.fosskiePerClick);
                    }
                    else if(this.currentArea==4){
                        this.starkie = this.starkie.add(this.starkiePerClick);
                        this.totalStarkie = this.totalStarkie.add(this.starkiePerClick);
                        this.resetStarkie = this.resetStarkie.add(this.starkiePerClick);
                        this.addClickEffect(this.starkiePerClick);
                    }
                },
                addClickEffect(amount) {
                    const effect = {
                        amount: amount,
                        style: {
                            animationDuration: `2s`
                        }
                    };
                    this.clickEffects.push(effect);
                    // 2秒后移除效果
                    setTimeout(() => {
                        this.clickEffects = this.clickEffects.filter(e => e !== effect);
                    }, 2000);
                },
                switchClick() {
                    this.enableClick = !this.enableClick;
                },
                switchGolden(){
                    this.enableGolden = !this.enableGolden;
                },
                clickGoldenPei() {
                    if (!this.goldenPeiVisible || !this.enableGolden) return;
                    this.goldenPeiClick++;
                    const durationMult = this.ascendU[5].level.mul(0.1).add(1).toNumber();
                    const effectMult = this.transcendU[5].level.mul(0.1).add(1).toNumber();
                    const effectmult2 = this.transcendU[14].level.gte(1)?10:1;
                    let effects=[];
                    if(this.hypercendU[3].level.gte(1)){
                        effects = [
                        {
                            name: '获得'+(15*effectMult*effectmult2).toFixed(1)+'<del>分钟</del>产量的佩干',
                            chance: 9,
                            apply: () => this.gainProduction(15*effectMult*effectmult2)
                        },
                        {
                            name: '获得'+this.sugarGain.toNumber().toFixed(0)+'个糖块',
                            chance: 1,
                            apply: () => this.gainCandy(this.sugarGain)
                        },
                        ]
                    }
                    else {
                        effects = [
                        {
                            name: '获得'+(15*effectMult*effectmult2).toFixed(1)+'<del>分钟</del>产量的佩干',
                            chance: 9,
                            apply: () => this.gainProduction(15*effectMult*effectmult2)
                        },
                        {
                            name: '获得的佩干×'+ (6*effectMult).toFixed(1) +'，持续'+ (66*durationMult).toFixed(1) +'秒',
                            chance: 6,
                            apply: () => this.applyBuildingMultiplier(6*effectMult, 66*durationMult)
                        },
                        {
                            name: '点击获得的佩干×'+(666*effectMult).toFixed(1)+'，持续'+(13*durationMult).toFixed(1)+'秒',
                            chance: 6,
                            apply: () => this.applyClickMultiplier(666*effectMult, 13*durationMult)
                        },
                        {
                            name: '随机建筑提升<del>佩干产量，基于该建筑数量×</del>'+(10*effectMult*effectmult2).toFixed(1)+'%，持续'+(30*durationMult).toFixed(1)+'秒',
                            chance: 4,
                            apply: () => this.boostRandomBuilding(1+0.1*effectMult*effectmult2, 30*durationMult)
                        },
                        {
                            name: '获得的佩干×'+(15*effectMult).toFixed(1)+'，持续'+(30*durationMult).toFixed(1)+'秒',
                            chance: 3,
                            apply: () => this.applyBuildingMultiplier(15*effectMult, 30*durationMult)
                        },
                        {
                            name: '点击获得的佩干×'+(1111*effectMult).toFixed(1)+'，持续'+(8*durationMult).toFixed(1)+'秒',
                            chance: 3,
                            apply: () => this.applyClickMultiplier(1111*effectMult, 8*durationMult)
                        },
                        {
                            name: '建筑价格-'+(100-50/effectMult).toFixed(1)+'%，持续'+(5*durationMult).toFixed(1)+'秒',
                            chance: 2,
                            apply: () => this.applyBuildingCostReduction(0.5/effectMult, 5*durationMult)
                        },
                        {
                            name: '升级价格-'+(100-50/effectMult).toFixed(1)+'%，持续'+(5*durationMult).toFixed(1)+'秒',
                            chance: 2,
                            apply: () => this.applyUpgradeCostReduction(0.5/effectMult, 5*durationMult)
                        },
                        {
                            name: '获得'+this.sugarGain.toNumber().toFixed(0)+'个糖块',
                            chance: 1,
                            apply: () => this.gainCandy(this.sugarGain)
                        },
                        ];
                    }
                    const allEffects = [...effects];
                    const selectedEffect = this.selectRandomEffect(allEffects);
                    selectedEffect.apply();
                    this.goldenPeiVisible = false;
                    this.showEffectNotification(selectedEffect.name);
                },
                applyClickMultiplier(multiplier, duration) {
                    this.goldenPeiEffects.clickMultiplier = N(multiplier);
                    this.startEffectTimer('clickMultiplier', () => {
                        this.goldenPeiEffects.clickMultiplier = N(1);
                    }, duration * 1000);
                },
                applyBuildingMultiplier(multiplier, duration) {
                    this.goldenPeiEffects.buildingMultiplier = N(multiplier);
                    this.startEffectTimer('buildingMultiplier', () => {
                        this.goldenPeiEffects.buildingMultiplier = N(1);
                    }, duration * 1000);
                },
                applyBuildingCostReduction(factor, duration) {
                    this.goldenPeiEffects.buildingCostReduction = N(factor);
                    this.startEffectTimer('buildingCostReduction', () => {
                        this.goldenPeiEffects.buildingCostReduction = N(1);
                    }, duration * 1000);
                },
                applyUpgradeCostReduction(factor, duration) {
                    this.goldenPeiEffects.upgradeCostReduction = N(factor);
                    this.startEffectTimer('upgradeCostReduction', () => {
                        this.goldenPeiEffects.upgradeCostReduction = N(1);
                    }, duration * 1000);
                },
                boostRandomBuilding(multiplier, duration) {
                    const buildingsWithQuantity = this.buildings.filter(b => b.quantity.gt(0));
                    if (buildingsWithQuantity.length === 0) return;
                    const randomBuilding = buildingsWithQuantity[
                        Math.floor(Math.random() * buildingsWithQuantity.length)
                    ];
                    this.goldenPeiEffects.randomBuildingBoost = randomBuilding.id;
                    this.startEffectTimer('randomBuildingBoost', () => {
                        this.goldenPeiEffects.randomBuildingBoost = null;
                    }, duration * 1000);
                },
                gainProduction(seconds) {
                    const production = this.peiPerSecond.mul(seconds);
                    this.peiCount = this.peiCount.add(production);
                    this.thisAscendPei = this.thisAscendPei.add(production);
                    this.totalLifetimePei = this.totalLifetimePei.add(production);
                },
                gainClicks(count) {
                    const total = this.peiPerClick.mul(count);
                    this.peiCount = this.peiCount.add(total);
                },
                gainCandy(count) {
                    this.sugar = this.sugar.add(count);
                },
                selectRandomEffect(effects) {
                    const totalWeight = effects.reduce((sum, e) => sum + e.chance, 0);
                    let random = Math.random() * totalWeight;
                    for (const effect of effects) {
                        if (random < effect.chance) return effect;
                        random -= effect.chance;
                    }
                    return effects[0];
                },
                startEffectTimer(name, callback, duration) {
                    if (this.effectTimers[name]) {
                        clearTimeout(this.effectTimers[name]);
                    }
                    this.effectTimers[name] = setTimeout(() => {
                        callback();
                        delete this.effectTimers[name];
                    }, duration);
                },
                showEffectNotification(effectName) {
                    this.effect = effectName;
                    document.getElementById('effectSpan').innerHTML = effectName;
                    const toast = document.createElement('div');
                    toast.className = 'effect-toast';
                    toast.innerHTML = `
                        <span>获得金佩勒效果:${effectName}</span>
            `       ;
                    document.body.appendChild(toast);
                    setTimeout(() => toast.remove(), 5000);
                },
                buyBuilding(index) {
                    let building = this.buildings[index];
                    let amount = parseInt(this.bulkAmount);
                    let totalCost = this.calcBulkCost(index);
                    if (this.peiCount.lt(totalCost)) return;
                    // 执行购买
                    if(this.hypercendU[1].level.lt(1)) this.peiCount = this.peiCount.sub(totalCost);
                    building.quantity = building.quantity.add(amount);
                    // 更新下次购买价格（使用公式代替循环）
                    building.cost = building.baseCost.mul(Decimal.pow(1.148698354997035, building.quantity));
                    // 检查成就
                    this.checkAchievements(index + 1);
                },
                buyMaxBuilding(index) {
                    let building = this.buildings[index];
                    let r = 1.148698354997035;
                    let maxAmount = this.peiCount.div(this.buildingCostMult).div(building.cost).mul(r-1).add(1).log(r);
                    let a = Decimal.max(Decimal.floor(maxAmount),0);
                    let totalCost = Decimal.pow(r,a).sub(1).mul(building.cost).div(r-1).mul(this.buildingCostMult);
                    if (this.peiCount.lt(totalCost)) return;
                    this.peiCount = this.peiCount.sub(totalCost);
                    building.quantity = building.quantity.add(a);
                    building.cost = building.baseCost.mul(Decimal.pow(r, building.quantity));
                    this.checkAchievements(index + 1);
                },
                buyAllBuilding() {
                    if (this.hypercendU[1].level.lt(1)) {for(let i=41;i>=0;i--) this.buyMaxBuilding(i);}
                    else {
                        for(let i=41;i>=0;i--) {
                            let building = this.buildings[i];
                            if (this.peiCount.lt(building.cost.mul(this.buildingCostMult))) return;
                            let r = 1.148698354997035;
                            building.quantity = N(Math.floor(this.peiCount.div(this.buildingCostMult).div(building.baseCost).mul(r).max(1).log(r)));
                            building.cost = building.baseCost.mul(Decimal.pow(r, building.quantity));
                        }
                    }
                },
                buildingMult(index){
                    if(index==0) {
                        return this.upgrades.filter(u => u.buildingId == 1 && u.id < 4).reduce((prod, upgrade) => {
                                return upgrade.unlocked ? prod.mul(2) : prod;
                            }, N(1))
                            .add(this.upgrades.filter(u => u.buildingId == 1 && u.id == 4)[0].unlocked?
                                this.upgrades.filter(u => u.buildingId == 1 && u.id > 4 && u.id <= 20).reduce((prod, upgrade) => {
                                    return upgrade.unlocked ? prod.mul(this.transcendU[6].level.mul(0.1).add(1).mul(this.transcendU[15].level.gte(1)?100:20).mul(this.breakCount.max(4).min(8).sub(3).mul(0.2).add(1))) : prod;
                                }, N(1))
                                .mul(this.upgrades.filter(u => u.buildingId == 1 & u.id>20).reduce((prod, upgrade, i) => {
                                    return upgrade.unlocked ? prod.mul(Decimal.pow(4,this.buildings[index].quantity/100 - 10*(i+1)*(i+2))).mul(Decimal.pow(this.buildings[index].baseCost, 0.1)) : prod;
                                }, N(1)))
                                .mul(this.ascendU[13].level.gte(1)?25: 1).mul(this.buildingCount):N(0))
                            .mul(this.hypercendU[3].level.gte(1)?this.transcendU[5].level.toNumber()*0.1+2:this.goldenPeiEffects.randomBuildingBoost == index ? 1.1 : 1);
                    }
                    else if(index==1) {
                        return this.upgrades.filter(u => u.buildingId == 2).reduce((prod, upgrade) => {
                                return upgrade.unlocked ? prod.mul(this.ascendU[17].level.gte(1)?this.breakCount.gte(6)?6:3.2:2).mul(this.breakCount.max(3).min(8).sub(3).mul(0.2).add(1)) : prod;
                            }, N(1))
                            .mul(this.upgrades.filter(u => u.buildingId == 103).reduce((prod, upgrade) => {
                                return upgrade.unlocked ? prod.mul(this.ascendU[17].level.gte(1)?this.breakCount.gte(6)?6:3.2:2) : prod;
                            }, N(1)))
                            .mul(this.upgrades.filter(u => u.buildingId == 2 & u.id>20).reduce((prod, upgrade, i) => {
                                return upgrade.unlocked ? prod.mul(Decimal.pow(4,this.buildings[index].quantity/100 - 10*(i+1)*(i+2))).mul(Decimal.pow(this.buildings[index].baseCost, 0.1).mul(1e3)) : prod;
                            }, N(1)))
                            .mul(this.ascendU[18].level.mul(this.milk).mul(0.002).add(1))
                            .mul(this.hypercendU[3].level.gte(1)?this.transcendU[5].level.toNumber()*0.1+2:this.goldenPeiEffects.randomBuildingBoost == index ? 1.1:1);
                    }
                    else{
                        return this.upgrades.filter(u => u.buildingId == (index + 1) & u.id<=20).reduce((prod, upgrade) => {
                                return upgrade.unlocked ? prod.mul(this.ascendU[19].level.gte(index-1)?Math.pow(this.breakCount.gte(7)?1.109569472067845:1.05,42-index)*2:2).mul(this.breakCount.max(3).min(8).sub(3).mul(0.2).add(1)) : prod;
                            }, N(1))
                            .mul(this.upgrades.filter(u => u.buildingId == (index + 1) & u.id>20).reduce((prod, upgrade, i) => {
                                return upgrade.unlocked ? prod.mul(Decimal.pow(4,this.buildings[index].quantity/100 - 10*(i+1)*(i+2))).mul(Decimal.pow(this.buildings[index].baseCost, 0.1).mul(1e3)) : prod;
                            }, N(1)))
                            .mul(this.upgrades.filter(u => u.buildingId == 103 && u.id == index - 1)[0].unlocked ? this.buildings[1].quantity.div(index - 1).div(100).mul(this.transcendU[7].level.mul(0.1).add(1)).add(1) : 1)
                            .mul(this.upgrades.filter(u => u.buildingId == 108 && u.id == index - 1      )[0].unlocked? this.buildings[index - 1      ].quantity.mul(0.01) .mul(this.transcendU[10].level.mul(0.1).add(1)).add(1):1)
                            .mul(this.upgrades.filter(u => u.buildingId == 108 && u.id == (index+37)%40+1)[0].unlocked? this.buildings[(index+37)%40+2].quantity.mul(0.001).mul(this.transcendU[10].level.mul(0.1).add(1)).add(1):1)
                            .mul(this.upgrades.filter(u => u.buildingId == 109 && u.id == index - 1      )[0].unlocked? this.buildings[index-2        ].quantity.mul(0.01) .mul(this.transcendU[11].level.mul(0.1).add(1)).add(1):1)
                            .mul(this.upgrades.filter(u => u.buildingId == 109 && u.id == (index+36)%40+1)[0].unlocked? this.buildings[(index+36)%40+2].quantity.mul(0.001).mul(this.transcendU[11].level.mul(0.1).add(1)).add(1):1)
                            .mul(this.hypercendU[3].level.gte(1)?this.transcendU[5].level.toNumber()*0.1+2:this.goldenPeiEffects.randomBuildingBoost == index ? 1.1 : 1);
                    }
                },
                calcBulkCost(index) {
                    let building = this.buildings[index];
                    let r = 1.148698354997035; // 价格增长系数
                    let n = parseInt(this.bulkAmount);
                    let a1 = building.cost;
                    if (n == 1) return a1.mul(this.buildingCostMult);
                    // 使用等比数列求和公式：S = a1*(r^n - 1)/(r - 1)
                    return Decimal.pow(r,n).sub(1).mul(a1).div(r-1).mul(this.buildingCostMult);
                },
                canBulkBuy(index) {
                    return this.peiCount.gte(this.calcBulkCost(index));
                },
                buyUpgrade(i, b) {
                    let upgrade = this.upgrades.filter(u => u.id == i && u.buildingId == b)
                    let c = upgrade[0].cost.mul(this.upgradeCostMult);
                    if (this.peiCount.gte(c)) {
                        this.peiCount = this.peiCount.sub(c);
                        this.upgrades.filter(u => u.id == i && u.buildingId == b).map(u => u.unlocked = true);
                    }
                },
                // 判断是否可以购买升级
                canBuyUpgrade(upgrade) {
                    let c = upgrade.cost.mul(this.upgradeCostMult);
                    return this.peiCount.gte(c) & !upgrade.unlocked
                },
                showUpgrade(u) {
                    if(this.upgShowType==1){
                        if (u.unlocked) return false;
                        else return ((u.buildingId < 100 && this.buildings[u.buildingId - 1].quantity.gte(u.required)) 
                    || (u.buildingId == 101 && this.totalClickPei.gte(u.required)) 
                    || (u.buildingId == 102 && N(this.unlockedAchievementsCount).gte(u.required)) 
                    || (u.buildingId == 103 && this.buildings[u.id + 1].quantity.gte(u.required)) 
                    || (u.buildingId == 104 && this.ascendU[0].level.gte(1)) 
                    || (u.buildingId == 105 && this.ascendU[2].level.add(this.transcendU[18].level).gte(u.required) && this.thisAscendPei.gte(u.cost)) 
                    || (u.buildingId == 106 && this.buildings[41].quantity.gte(u.required) && u.id<=16)
                    || (u.buildingId == 107 && this.goldenPeiClick >= u.required)
                    || (u.buildingId == 108 && this.ascendU[11].level.gte(1) && this.buildings[u.id + 1].quantity.gte(15))
                    || (u.buildingId == 109 && this.ascendU[11].level.gte(2) && this.buildings[u.id + 1].quantity.gte(75))
                    || (u.buildingId == 110 && this.transcendU[19].level.gte(u.required) && this.thisAscendPei.gte(u.cost))
                        );
                    }
                    else if(this.upgShowType==2){
                        return u.unlocked;
                    }
                },
                buyAllUpgrades() {
                    this.upgrades.forEach(u => {
                        if (this.showUpgrade(u)) {
                            this.buyUpgrade(u.id, u.buildingId);
                        }
                    });
                },
                checkAchievements(buildingIndex) {
                    const relatedAchievements = this.achievements.filter(
                        a => a.buildingId === buildingIndex
                    );
                    if (buildingIndex < 100) {
                        const building = this.buildings[buildingIndex-1];
                        relatedAchievements.forEach(achievement => {
                            if (!achievement.unlocked & building.quantity.gte(achievement.required)) {
                                achievement.unlocked = true;
                                this.showAchievementToast(achievement);
                            }
                        });
                    }
                    if (buildingIndex == 101) {
                        relatedAchievements.forEach(achievement => {
                            if (!achievement.unlocked & this.totalLifetimePei.gte(achievement.required)) {
                                achievement.unlocked = true;
                                this.showAchievementToast(achievement);
                            }
                        });
                    }
                    if (buildingIndex == 102) {
                        relatedAchievements.forEach(achievement => {
                            if (!achievement.unlocked & this.peiPerSecond.gte(achievement.required)) {
                                achievement.unlocked = true;
                                this.showAchievementToast(achievement);
                            }
                        });
                    }
                    if (buildingIndex == 103) {
                        relatedAchievements.forEach(achievement => {
                            if (!achievement.unlocked & this.totalClickPei.gte(achievement.required)) {
                                achievement.unlocked = true;
                                this.showAchievementToast(achievement);
                            }
                        });
                    }
                    if (buildingIndex == 104) {
                        relatedAchievements.forEach(achievement => {
                            if (!achievement.unlocked & this.totalRealityShards.gte(achievement.required)) {
                                achievement.unlocked = true;
                                this.showAchievementToast(achievement);
                            }
                        });
                    }
                    if (buildingIndex == 105) {
                        relatedAchievements.forEach(achievement => {
                            if (!achievement.unlocked & this.totalTranscendPoints.gte(achievement.required)) {
                                achievement.unlocked = true;
                                this.showAchievementToast(achievement);
                            }
                        });
                    }
                    if (buildingIndex == 106) {
                        relatedAchievements.forEach(achievement => {
                            if (!achievement.unlocked & this.totalHypercendPoints.gte(achievement.required)) {
                                achievement.unlocked = true;
                                this.showAchievementToast(achievement);
                            }
                        });
                    }
                },
                showAchievementToast(achievement) {
                    const toast = document.createElement('div');
                    toast.className = 'achievement-toast';
                    toast.innerHTML = `
                <span>成就 </span>
                <strong>${achievement.buildingId}-${achievement.id}</strong>
                <span> 已解锁</span>`
                    ;
                    document.body.appendChild(toast);
                    this.milk = this.milk.add(this.breakCount.gte(3)?2:1);
                    setTimeout(() => {
                        toast.remove();
                    }, 5000);
                },
                
                // 显示高级成就完成通知
                showAdvancedAchievementToast(achievement, times) {
                    const toast = document.createElement('div');
                    toast.className = 'achievement-toast';
                    toast.innerHTML = `
                <span>高级成就 </span>
                <strong>${achievement.name}</strong>
                <span> 已完成 ${times} 次</span>`
                    ;
                    document.body.appendChild(toast);
                    this.milk = this.milkCount; // 每个高级成就增加1点牛奶
                    setTimeout(() => {
                        toast.remove();
                    }, 5000);
                },
                
                // 检查高级成就
                checkAdvancedAchievements() {
                    // 高级成就1：佩干大师
                    const pelkieAchievement = this.advancedAchievements[0];
                    const nextPelkieTarget = this.advancedAchievementsTarget(1);
                    if (this.totalLifetimePei.gte(nextPelkieTarget)) {
                        pelkieAchievement.completedTimes = pelkieAchievement.completedTimes.add(1);
                        this.showAdvancedAchievementToast(pelkieAchievement, pelkieAchievement.completedTimes.toNumber());
                    }
                    // 高级成就2：化石收藏家
                    const fosskieAchievement = this.advancedAchievements[1];
                    const nextFosskieTarget = this.advancedAchievementsTarget(2);
                    if (this.totalFosskie.gte(nextFosskieTarget)) {
                        fosskieAchievement.completedTimes = fosskieAchievement.completedTimes.add(1);
                        this.showAdvancedAchievementToast(fosskieAchievement, fosskieAchievement.completedTimes.toNumber());
                    }
                    // 高级成就3：星尘收集者
                    const starkieAchievement = this.advancedAchievements[2];
                    const nextStarkieTarget = this.advancedAchievementsTarget(3);
                    if (this.totalStarkie.gte(nextStarkieTarget)) {
                        starkieAchievement.completedTimes = starkieAchievement.completedTimes.add(1);
                        this.showAdvancedAchievementToast(starkieAchievement, starkieAchievement.completedTimes.toNumber());
                    }
                    /* 高级成就4：数据收集者
                    const datakieAchievement = this.advancedAchievements[3];
                    const nextDatakieTarget = this.advancedAchievementsTarget(4);
                    if (this.totalDatakie.gte(nextDatakieTarget)) {
                        datakieAchievement.completedTimes = datakieAchievement.completedTimes.add(1);
                        this.showAdvancedAchievementToast(datakieAchievement, datakieAchievement.completedTimes.toNumber());
                    }*/
                },
                advancedAchievementsTarget(tier) {
                    if (tier == 1) {
                        return Decimal.pow(10, this.advancedAchievements[0].completedTimes.add(1).mul(27000).mul(Decimal.pow(1.0333,this.advancedAchievements[0].completedTimes)));
                    } else if (tier == 2) {
                        return Decimal.pow(10, this.advancedAchievements[1].completedTimes.add(1).mul(900).mul(Decimal.pow(1.0333,this.advancedAchievements[1].completedTimes)));
                    } else if (tier == 3) {
                        return Decimal.pow(10, this.advancedAchievements[2].completedTimes.add(1).mul(30).mul(Decimal.pow(1.0333,this.advancedAchievements[2].completedTimes)));
                    } else if (tier == 4) {
                        return Decimal.pow(10, this.advancedAchievements[3].completedTimes.add(1).mul(Decimal.pow(1.0333,this.advancedAchievements[3].completedTimes)));
                    }
                },
                ascend() {
                    // 计算获得的碎片
                    const gained = this.totalShards.sub(this.totalRealityShards).max(0);
                    this.realityShards = this.realityShards.add(gained);
                    this.totalRealityShards = this.totalShards.max(this.totalRealityShards);
                    this.ascensionCount = this.ascensionCount.add(1);
                    // 重置游戏状态
                    this.peiCount = N(0);
                    this.thisAscendPei = N(0);
                    this.buildings.forEach(b => {
                        b.quantity = N(0);
                        b.cost = b.baseCost;
                        b.production = b.baseProd;
                    });
                    this.upgrades.forEach(u => {
                        u.unlocked = false;
                    });
                    let b1=this.spaceResetCount.gte(1)?1e4:this.breakCount.gte(1)?1000:this.transcendU[12].level.gte(1)?100:this.ascendU[4].level.gte(1)?10:0;
                    let b2=this.spaceResetCount.gte(1)?1e4:this.breakCount.gte(1)?1000:this.transcendU[12].level.gte(1)?100:this.ascendU[4].level.gte(2)?10:0;
                    this.buildings[0].quantity=N(b1);
                    this.buildings[1].quantity=N(b2);
                    for(let i=1; i<=this.ascendU[6].level.toNumber(); i++) this.upgrades[1070+i].unlocked=true;
                },
                buyAscendU(index) {
                    const upgrade = this.ascendU[index];
                    if (upgrade.level.gte(upgrade.maxLevel)) return;

                    if (this.realityShards.gte(upgrade.cost)) {
                        this.realityShards = this.realityShards.sub(upgrade.cost);
                        this.ascendU[index].level = this.ascendU[index].level.add(1);
                    }
                    let a0=[1,3,5,7,50,77,100,777,999,9000,99999,222222,399999,1.5e7,1e8,2e8,1e9,1.92e9,9e9,1e10]
                    let p=[0,1334,10,0,0,0,100,0,0,0,0,2e6,0,0,0,2e8,0,0,0,0]
                    let q=[1,1,1,7,100,10,100,10,100,1e9,2,1,1,1,4,1000,10,1,1000,1]
                    this.ascendU[index].cost = index==19?this.ascendU[19].level.add(3).pow(7).mul(1.5e7):N(a0[index]).add(this.ascendU[index].level.mul(p[index])).mul(Decimal.pow(q[index],this.ascendU[index].level))
                },
                buyAllAscendU() {
                    this.ascendU.forEach(u => {
                        for(let i=0;i<u.maxLevel.toNumber();i++) this.buyAscendU(u.id-1);
                    });
                },
                refundAscendU() {
                    var confirm=window.confirm("确认回退所有飞升升级吗？这将进行一次无奖励的飞升重置！");
                    if(!confirm) return;
                    this.ascendU.forEach(u => {
                        u.level=N(0);
                    });
                    this.realityShards=this.totalRealityShards;
                    this.ascend();
                    this.updateCost();
                },
                transcend() {
                    const gain = this.totalTP.sub(this.totalTranscendPoints).max(0);
                    this.transcendPoints = this.transcendPoints.add(gain);
                    this.totalTranscendPoints = this.totalTP.max(this.totalTranscendPoints);
                    this.transcensionCount = this.transcensionCount.add(1);

                    this.peiCount = N(0);
                    this.thisAscendPei = N(0);
                    this.totalClickPei = N(0);
                    this.totalLifetimePei = N(0);
                    this.enableClick=true;
                    this.enableGolden=true;
                    this.buildings.forEach(b => {
                        b.quantity = N(0);
                        b.cost = b.baseCost;
                        b.production = b.baseProd;
                    });
                    this.upgrades.forEach(u => u.unlocked = false);
                    this.ascensionCount = N(1);
                    this.realityShards = N(1);
                    this.totalRealityShards=N(1);
                    this.ascendU.forEach(u => u.level = N(0));
                    let b=this.spaceResetCount.gte(1)?1e4:this.breakCount.gte(1)?1000:this.transcendU[12].level.gte(1)?100:0;
                    this.buildings[0].quantity=N(b);
                    this.buildings[1].quantity=N(b);
                    this.updateCost();
                },
                buyTranscendU(index) {
                    const upgrade=this.transcendU[index];
                    if (upgrade.level.gte(upgrade.maxLevel)) return;

                    if(this.transcendPoints.gte(upgrade.cost)){
                        this.transcendPoints = this.transcendPoints.sub(upgrade.cost);
                        upgrade.level = upgrade.level.add(1);
                    }
                    let r=[1,1,1,1,1,1,1,1,1,1,1,1,10,100,1000,10000,1e5,1e5,1e6,1e6];
                    let s=[2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,4,4,10,1e6]
                    this.transcendU[index].cost=Decimal.pow(s[index],this.transcendU[index].level).mul(r[index]);
                },
                buyAllTranscendU(){
                    this.transcendU.forEach(u => {
                        for(let i=0;i<u.maxLevel.min(100).toNumber();i++) this.buyTranscendU(u.id-1);
                    });
                },
                refundTranscendU() {
                    var confirm=window.confirm("确认回退所有轮回神器和升级吗？这将进行一次无奖励的轮回重置！");
                    if(!confirm) return;
                    this.transcendU.forEach(u => {
                        u.level=N(0);
                    });
                    this.transcendPoints=this.totalTranscendPoints;
                    this.transcend();
                    this.updateCost();
                },
                breakReset(){
                    this.peiCount = N(0);
                    this.thisAscendPei = N(0);
                    this.totalClickPei = N(0);
                    this.totalLifetimePei = N(0);
                    this.breakTimer = N(0);
                    this.enableClick=true;
                    this.enableGolden=true;
                    this.buildings.forEach(b => {
                        b.quantity = N(0);
                        b.cost = b.baseCost;
                        b.production = b.baseProd;
                    });
                    this.upgrades.forEach(u => u.unlocked = false);
                    this.ascensionCount = N(1);
                    this.realityShards = N(1);
                    this.totalRealityShards=N(1);
                    this.ascendU.forEach(u => u.level = N(0));
                    this.transcendCount = N(1);
                    this.transcendPoints = N(1);
                    this.totalTranscendPoints = N(1);
                    this.transcendU.forEach(u => u.level=N(0));
                    let b=this.spaceResetCount.gte(1)?1e4:this.breakCount.gte(1)?1000:0;
                    this.buildings[0].quantity=N(b);
                    this.buildings[1].quantity=N(b);
                    if(this.breakCount.lte(0)) alert('你破碎了这个佩干宇宙，因此出现了4个新的选项卡。  佩勒：这次你可能早些时候就明白了，飞升轮回直到破碎，都是你自己创造的。由你自身思绪的残余所构成的事物，暗示了这一点。但是，你从未想过那会是你，对吧？');
                },
                doBreak(){
                    this.breakReset();
                    this.breakCount=this.breakCount.add(1);
                    this.updateCost();
                },
                buyAuto(index){
                    const upgrade=this.automation[index];
                    if(this.peiCount.lt(upgrade.cost)) return;
                    this.peiCount=this.peiCount.sub(upgrade.cost);
                    upgrade.unlocked=true;
                },
                toggleAuto(index){
                    const upgrade=this.automation[index];
                    if(!upgrade.unlocked) return;
                    upgrade.activate=!upgrade.activate;
                },
                hypercend(){
                    this.hypercendPoints = this.hypercendPoints.add(this.HPGain);
                    this.totalHypercendPoints = this.totalHypercendPoints.add(this.HPGain);
                    this.maxHypercendPoints = this.maxHypercendPoints.max(this.HPGain);
                    this.hypercendCount =  this.hypercendCount.add(1);
                    this.breakReset();
                    this.updateCost();
                },
                buyHypercendU(index){
                    const upgrade=this.hypercendU[index];
                    if (this.hypercendPoints.lt(upgrade.cost) | upgrade.level.gte(upgrade.maxLevel)) return;
                    this.hypercendPoints = this.hypercendPoints.sub(upgrade.cost);
                    upgrade.level = upgrade.level.add(1);
                    let t=[1,1e6,1e12,1e18,1e24,1e100]
                    this.hypercendU[index].cost=Decimal.pow(1.148698354997035,upgrade.level).mul(t[index]);
                },
                buyMaxHypercendU(index){
                    for(let i=1;i<=100;i++) this.buyHypercendU(index);
                },
                buyAllHypercendU(){
                    for(let i=0;i<6;i++) this.buyHypercendU(i);
                },
                buyHyperChargeU(index){
                    const upgrade=this.hyperChargeU[index];
                    if (this.hypercendPoints.lt(upgrade.cost) | upgrade.unlocked) return;
                    this.hypercendPoints = this.hypercendPoints.sub(upgrade.cost);
                    upgrade.unlocked=true;
                },
                buyAllHyperChargeU(){
                    for(let i=0;i<20;i++) this.buyHyperChargeU(i);
                },
                hyperEffect(tier){
                    if(tier == 0) return this.hyperCharge.add(1);
                    else if(tier == 1) return this.totalHypercendPoints.add(1).pow(2);
                    else if(tier == 2) return this.maxHypercendPoints.add(1).pow(2);
                    else if(tier == 3) return this.hypercendPoints.add(1).pow(2);
                    else if(tier == 4) return this.transcendPoints.add(1).pow(1/24);
                    else if(tier == 5) return this.HPGain.pow(2/3);
                    else if(tier == 6) return this.transcendPoints.add(1).pow(1/24);
                    else if(tier == 7) return this.maxHypercendPoints.add(1).pow(0.2).mul(this.breakTimer.div(100).min(9).add(1).pow(2));
                    else if(tier == 8) return this.sugar.add(1).pow(1/6);
                    else if(tier == 9) return this.transcendPoints.add(1).pow(1/16);
                    else if(tier == 10) return N(1);
                    else if(tier == 11) return this.sugar.add(1).pow(1/6);
                    else if(tier == 12 | tier == 13) return N(this.totalLifetimePei.add(10).log(10)).pow(1/6);
                    else if(tier == 14 | tier == 15 | tier == 16) return N(this.totalLifetimePei.add(10).log(10)).pow(1/9);
                    else if(tier == 17) return this.salt.add(1).pow(1/12);
                    else if(tier == 18) return Decimal.pow(this.hypercendPoints.add(10).log(10),1/6);
                    else if(tier == 19) return this.nutCount.add(1).pow(1/24);
                    else if(tier == 20) return N(4/3);
                    else return N(1);
                },
                spaceReset() {
                    if (!this.canSpaceReset) return;
                    this.nutCount = this.nutCount.add(this.nutGain);
                    this.spaceRecord = this.spaceRecord.max(this.totalLifetimePei);
                    if(this.breakCount.lte(1)) this.nobreakRecord = this.nobreakRecord.max(this.totalLifetimePei);
                    this.peiCount = N(0);
                    this.totalLifetimePei=N(0);
                    this.thisAscendPei = N(0);
                    this.totalClickPei=N(0);
                    if(this.spaceRecord.lt("1e40000")) this.sugar=N(0);
                    this.realityShards = N(1);
                    this.totalRealityShards = N(1);
                    this.transcendPoints = N(1);
                    this.totalTranscendPoints = N(1);
                    this.breakCount=N(1);
                    this.hypercendPoints=N(1);
                    this.totalHypercendPoints=N(1);
                    this.maxHypercendPoints=N(1);
                    this.hyperCharge = N(0);
                    this.buildings.forEach(b => { b.quantity = N(0); });
                    this.upgrades.forEach(u => { u.unlocked=false; });
                    this.ascendU.forEach(au => { au.level = N(0); });
                    this.transcendU.forEach(tu => { tu.level = N(0); });
                    this.hypercendU.forEach(hu => { hu.level = N(0); });
                    this.hyperChargeU.forEach(hcu => { hcu.unlocked = false; })
                    if(this.spaceRecord.lt("1e60000")) this.automation.forEach(a => {a.unlocked=false; a.activate=false;});
                    this.fosskie=N(0);
                    this.totalFosskie=N(0);
                    this.resetFosskie=N(0);
                    this.icing=N(0);
                    this.totalIcing=N(0);
                    this.honey=N(0);
                    this.totalHoney=N(0);
                    this.peiLives.forEach(pei => {
                        pei.level = N(0);
                    });
                    for(let i=0;i<27;i++) {
                        if(!this.automation[10].activate) cancelAnimationFrame(this.peiLives[i].timer);
                        this.peiLives[i].progress = 0;
                    }
                    for(let i=0;i<39;i++) {
                        this.traits[i].level = N(0);
                        this.traits[i].cost = Decimal.pow(3, this.traits[i].level).sub(1);
                    }
                    this.spaceResetCount = this.spaceResetCount.add(1);
                    let b=this.spaceResetCount.gte(1)?1e4:0;
                    this.buildings[0].quantity=N(b);
                    this.buildings[1].quantity=N(b);
                    this.updateCost();
                },
                buySpaceU(id) {
                    const upgrade = this.spaceU.find(u => u.id === id);
                    if (upgrade.level.gte(upgrade.maxLevel) || this.nutCount.lt(this.getSpaceUC(id))) return;
                    this.nutCount = this.nutCount.sub(this.getSpaceUC(id));
                    upgrade.level = upgrade.level.add(1);
                    if(id==11) this.milk=this.milkCount;
                },
                buyAllSpaceU(){
                    for(let i=0;i<12;i++) this.buySpaceU(i+1);
                },
                getSpaceUC(id){
                    if(id<=10) return Decimal.pow(2,this.spaceU[id-1].level).mul(this.spaceU[id-1].basecost);
                    else return Decimal.pow(20,this.spaceU[id-1].level).mul(100);
                },
                buySaltU(id) {
                    const upgrade = this.saltU.find(u => u.id === id);
                    if (upgrade.level.gte(upgrade.maxLevel) || this.salt.lt(this.saltU[id-1].basecost)) return;
                    this.salt = this.salt.sub(this.saltU[id-1].basecost);
                    upgrade.level = upgrade.level.add(1);
                },
                
                // 计算香料收益，可放入calc中
                calculateSpiceGain() {
                    return this.peiCount.pow(1/1000000).sub(9).max(0);
                },
                // 计算香料加成
                calculateSpiceBonus() {
                    const totalSpice = (this.cinnamon.add(1)).mul(this.vanilla.add(1)).sub(1).mul(10).add(1);
                    return totalSpice.mul(this.calculateAntBonus()).mul(this.calculateChallengeBonus());
                },
                // 肉桂重置
                cinnamonReset() {
                    const requiredAmount = Decimal.pow(10, 1000000);
                    if (this.peiCount.lt(requiredAmount)) return;
                    
                    const gain = this.calculateSpiceGain();
                    this.cinnamon = this.cinnamon.add(gain);
                    
                    // 增加肉桂重置次数
                    this.cinnamonResetCount = this.cinnamonResetCount.add(1);
                    
                    // 执行重置
                    this.spiceReset();
                    
                    // 解锁蚁丘
                    // 蚁丘解锁逻辑将在后面实现
                },
                
                // 香草重置
                vanillaReset() {
                    const requiredAmount = Decimal.pow(10, 1000000);
                    if (this.peiCount.lt(requiredAmount)) return;
                    
                    const gain = this.calculateSpiceGain();
                    this.vanilla = this.vanilla.add(gain);
                    
                    // 增加香草重置次数
                    this.vanillaResetCount = this.vanillaResetCount.add(1);
                    
                    // 执行重置
                    this.spiceReset();
                    
                    // 解锁挑战
                    // 挑战解锁逻辑将在后面实现
                },
                
                // 香料重置的公共逻辑
                spiceReset() {
                    // 重置佩干的所有内容
                    this.peiCount = N(0);
                    this.thisAscendPei = N(0);
                    this.totalLifetimePei = N(0);
                    this.totalClickPei = N(0);
                    this.buildings.forEach(b => {
                        b.quantity = N(0);
                        b.cost = b.baseCost;
                        b.production = b.baseProd;
                    });
                    this.upgrades.forEach(u => {
                        u.unlocked = false;
                    });
                    
                    // 重置化石饼干的所有内容
                    this.fosskie = N(0);
                    this.totalFosskie = N(0);
                    this.resetFosskie = N(0);
                    this.icing = N(0);
                    this.totalIcing = N(0);
                    this.honey = N(0);
                    this.totalHoney = N(0);
                    this.sweetenCount = N(0);
                    this.caramel = N(0);
                    this.totalCaramel = N(0);
                    this.sugarCharge = N(0);
                    
                    // 重置坚果和坚果升级
                    this.nutCount = N(0);
                    this.spaceU.forEach(u => {
                        u.level = N(0);
                    });
                    
                    // 重置盐块
                    this.salt = N(0);
                    this.playTime2 = 0;
                    
                    // 重置成就和高级成就
                    this.advancedAchievements.forEach(aa => {
                        aa.completedTimes = N(0);
                    });
                    
                    // 重置佩干天体
                    this.starkie = N(0);
                    this.totalStarkie = N(0);
                    this.resetStarkie = N(0);
                    this.cheese = N(0);
                    this.totalCheese = N(0);
                    this.cream = N(0);
                    this.totalCream = N(0);
                    this.dreamCount = N(0);
                    this.butter = N(0);
                    this.totalButter = N(0);
                    
                    // 重置一星特征和二星特征
                    this.traits.forEach(t => {
                        t.level = N(0);
                        t.cost = N(1);
                    });
                    this.enhans.forEach(e => {
                        e.level = N(0);
                        e.cost = N(1);
                    });
                    
                    // 重置其他相关数据
                    this.milk = N(0);
                    this.sugar = N(0);
                    this.playTime = 0;
                    
                    // 更新香料重置计数
                    // 这里可以添加香料重置计数逻辑
                },
                
                // 蚁丘相关方法
                
                // 计算蚂蚁释放速度
                calculateAntReleaseSpeed() {
                    return Decimal.pow(2, this.antHillLevel).sub(1);
                },
                
                // 计算肉桂效果
                calculateCinnamonEffect() {
                    const cinnamonAmount = this.cinnamon;
                    if (cinnamonAmount.lte(100)) {
                        return cinnamonAmount;
                    } else if (cinnamonAmount.lte(40000)) {
                        return 100 + (cinnamonAmount.sub(100)).pow(0.5).mul(30);
                    } else if (cinnamonAmount.lte(1.6e7)) {
                        return 100 + 30 * Math.sqrt(39900) + (cinnamonAmount.sub(40000)).pow(0.25).mul(20);
                    } else if (cinnamonAmount.lte(6.4e9)) {
                        return 100 + 30 * Math.sqrt(39900) + 20 * Math.pow(1.6e7 - 40000, 0.25) + (cinnamonAmount.sub(1.6e7)).pow(0.125).mul(10);
                    } else {
                        return 100 + 30 * Math.sqrt(39900) + 20 * Math.pow(1.6e7 - 40000, 0.25) + 10 * Math.pow(6.4e9 - 1.6e7, 0.125) + (cinnamonAmount.sub(6.4e9)).pow(0.0625).mul(5);
                    }
                },
                
                // 计算蚂蚁加成
                calculateAntBonus() {
                    const drivenAntsBonus = this.antsDriven.add(1);
                    const notDrivenAntsPenalty = N(10).div(this.antsNotDriven.add(100).log(10)+8);
                    return drivenAntsBonus.pow(notDrivenAntsPenalty).pow(0.5);
                },
                
                // 更新蚁丘等级
                updateAntHillLevel(level) {
                    this.antHillLevel = N(level);
                    this.antReleaseSpeed = this.calculateAntReleaseSpeed();
                },
                
                // 更新蚂蚁数量
                updateAnts(deltaTime) {
                    // 计算新产生的未被驱赶的蚂蚁
                    const newAnts = this.antReleaseSpeed.mul(deltaTime);
                    this.antsNotDriven = this.antsNotDriven.add(newAnts);
                    
                    // 计算被驱赶的蚂蚁数量
                    const cinnamonEffect = this.calculateCinnamonEffect();
                    const drivenAnts = this.antsNotDriven.min(cinnamonEffect.mul(deltaTime));
                    
                    // 更新蚂蚁数量
                    this.antsNotDriven = this.antsNotDriven.sub(drivenAnts);
                    this.antsDriven = this.antsDriven.add(drivenAnts);
                },
                
                // 挑战相关方法
                
                // 检查挑战是否可以完成
                canCompleteChallenge(challengeId) {
                    const challenge = this.challenges[challengeId - 1];
                    const nextTarget = Decimal.pow(10, challenge.completedTimes.add(1).mul(100000));
                    return this.peiCount.gte(nextTarget);
                },
                
                // 开始挑战
                startChallenge(challengeId) {
                    // 先结束所有其他挑战
                    this.challenges.forEach(c => c.active = false);
                    
                    // 开始指定挑战
                    const challenge = this.challenges[challengeId - 1];
                    challenge.active = true;
                    
                    // 强制进行太空重置
                    this.spaceReset();
                },
                
                // 结束挑战
                endChallenge(challengeId) {
                    const challenge = this.challenges[challengeId - 1];
                    challenge.active = false;
                },
                
                // 完成挑战
                completeChallenge(challengeId) {
                    const challenge = this.challenges[challengeId - 1];
                    if (!this.canCompleteChallenge(challengeId)) return;
                    
                    // 增加完成次数
                    challenge.completedTimes = challenge.completedTimes.add(1);
                    this.totalChallengeCompletions = this.totalChallengeCompletions.add(1);
                    
                    // 结束挑战
                    this.endChallenge(challengeId);
                },
                
                // 计算挑战加成
                calculateChallengeBonus() {
                    return this.totalChallengeCompletions.pow(2).add(1);
                },
                
                // 检查当前是否有挑战活动
                isChallengeActive() {
                    return this.challenges.some(c => c.active);
                },

                //中生代山谷相关方法
                calcLifeBulkCost(index, amount) {
                    const pei = this.peiLives[index];
                    const r = 1.148698354997035;
                    const a1 = pei.baseCost.mul(Decimal.pow(r, pei.level));
                    if (amount === 1) return a1.div(this.calcCostMult(index));
                    return a1.mul(Decimal.pow(r, amount).sub(1)).div(r - 1).div(this.calcCostMult(index));
                },
                buyPeiLife(index, amount) {
                    const cost = this.calcLifeBulkCost(index, amount);
                    if (this.fosskie.gte(cost)) {
                        this.fosskie = this.fosskie.sub(cost);
                        this.peiLives[index].level = this.peiLives[index].level.add(amount);
                    }
                },
                buyMaxPeiLife(){
                    for(let i=0;i<28;i++) {
                        let amount=Math.floor(this.fosskie.mul(this.calcCostMult(i)).div(this.peiLives[i].baseCost).mul(1.148698354997035).max(1).log(1.148698354997035));
                        this.peiLives[i].level = this.peiLives[i].level.max(amount);
                    }
                },
                startLifeProd(index) {        
                    let last =Date.now();
                    const updateProgress = () => {
                        let now = Date.now();
                        const delta = (now - last) / 1000;
                        this.peiLives[index].progress += delta * (this.calcSpeedMult(index).gte(1e100)?1e100:this.calcSpeedMult(index).toNumber());
                        let ovf=this.calcSpeedMult(index).div(1e100).max(1);
                        if (this.peiLives[index].progress >= this.peiLives[index].duration) {
                            this.fosskie = this.fosskie.add(this.calcLifeProd(index).mul(Math.floor(this.peiLives[index].progress/this.peiLives[index].duration)).mul(ovf));
                            this.totalFosskie = this.totalFosskie.add(this.calcLifeProd(index).mul(Math.floor(this.peiLives[index].progress/this.peiLives[index].duration)).mul(ovf));
                            this.resetFosskie = this.resetFosskie.add(this.calcLifeProd(index).mul(Math.floor(this.peiLives[index].progress/this.peiLives[index].duration)).mul(ovf));
                            this.peiLives[index].progress = this.peiLives[index].progress % this.peiLives[index].duration;
                            cancelAnimationFrame(this.peiLives[index].timer);
                            if(this.peiLives[index].auto) this.startLifeProd(index);
                        } else {
                            this.peiLives[index].timer = requestAnimationFrame(updateProgress);
                        }
                        last = now;
                    };
                    updateProgress();
                },
                calcLifeProd(index){
                    return this.peiLives[index].level.mul(this.peiLives[index].baseProd).mul(this.calcLifeMult(index));
                },
                calcLifeCost(index){
                    return Decimal.pow(1.148698354997035,this.peiLives[index].level).mul(this.peiLives[index].baseCost);
                },
                calcLifeMult(index){
                    if(index==27) return Decimal.pow(1e18, this.peiLives[27].level.div(500).floor())
                    .mul(Decimal.pow(2,this.traits[27].level))
                    .mul(Decimal.pow(2,this.traits[28].level))
                    .mul(Decimal.pow(2,this.traits[29].level))
                    .mul(Decimal.pow(2, this.traits[39].level))
                    .mul(Decimal.pow(2, this.spaceU[0].level))
                    .mul(this.salt.div(1000).add(1))
                    .mul(this.saltU[0].level.add(1))
                    .mul(this.breakCount.gte(250)?this.breakCount.div(100):N(1))
                    .mul(this.refineryU[0].level.gte(1)?this.sugarCharge.add(1):1)
                    .mul(Decimal.pow(this.milkLevel.mul(0.005).add(1),this.milk))
                    .mul(this.calculateSpiceBonus().max(1));
                    else return Decimal.pow(1e20, this.peiLives[index].level.div(500).floor())
                    .mul(Decimal.pow(2, this.traits[index].level))
                    .mul(index%3==0?Decimal.pow(2,this.traits[27].level):index%3==1?Decimal.pow(2,this.traits[28].level):Decimal.pow(2,this.traits[29].level))
                    .mul(Decimal.pow(2, this.traits[39].level))
                    .mul(Decimal.pow(2, this.spaceU[0].level))
                    .mul(this.salt.div(1000).add(1))
                    .mul(this.saltU[0].level.add(1))
                    .mul(this.breakCount.gte(250)?this.breakCount.div(100):N(1))
                    .mul(this.refineryU[0].level.gte(1)?this.sugarCharge.add(1):1)
                    .mul(Decimal.pow(this.milkLevel.mul(0.005).add(1),this.milk))
                    .mul(this.calculateSpiceBonus().max(1));
                },
                calcSpeedMult(index){
                    if(index==27) return Decimal.pow(2,this.traits[30].level)
                    .mul(Decimal.pow(2,this.traits[31].level))
                    .mul(Decimal.pow(2,this.traits[32].level))
                    .mul((this.breakCount.gte(500)?this.breakCount.div(100):N(1)))
                    .mul(this.sweetenCount.gte(1)?100:1)
                    .mul(Decimal.pow(2, this.traits[40].level));
                    else return (this.breakCount.gte(500)?this.breakCount.div(100):N(1))
                    .mul(this.sweetenCount.gte(1)?100:1)
                    .mul(index/3%3<1?Decimal.pow(2,this.traits[30].level):index/3%3<2?Decimal.pow(2,this.traits[31].level):Decimal.pow(2,this.traits[32].level))
                    .mul(Decimal.pow(2, this.traits[40].level));
                },
                calcCostMult(index){
                    if(index==27) return Decimal.pow(2,this.traits[33].level)
                    .mul(Decimal.pow(2,this.traits[34].level))
                    .mul(Decimal.pow(2,this.traits[35].level))
                    .mul(this.breakCount.gte(750)?this.breakCount.div(100):N(1))
                    .mul(this.sweetenCount.gte(5)?100:1)
                    .mul(Decimal.pow(2, this.traits[41].level));
                    else return (this.breakCount.gte(750)?this.breakCount.div(100):N(1))
                    .mul(this.sweetenCount.gte(5)?100:1)
                    .mul(index/9%3<1?Decimal.pow(2,this.traits[33].level):index/9%3<2?Decimal.pow(2,this.traits[34].level):Decimal.pow(2,this.traits[35].level))
                    .mul(Decimal.pow(2, this.traits[41].level));
                },
                unlockLifeAuto(index){
                    if (this.fosskie.lt(this.peiLives[index].baseCost.mul(10))) return;
                    this.peiLives[index].auto = true;
                    this.startLifeProd(index);
                    this.fosskie = this.fosskie.sub(this.peiLives[index].baseCost.mul(10));
                },
                buyTrait(index){
                    if(this.traits[index].tier == 1 ){
                        if(this.icing.lt(this.traits[index].cost)) return;
                        this.icing = this.icing.sub(this.traits[index].cost);
                    }
                    else if(this.traits[index].tier == 2){
                        if(this.honey.lt(this.traits[index].cost)) return;
                        this.honey = this.honey.sub(this.traits[index].cost);
                    }
                    else if(this.traits[index].tier == 3){
                        if(this.caramel.lt(this.traits[index].cost)) return;
                        this.caramel = this.caramel.sub(this.traits[index].cost);
                    }
                    else return;
                    this.traits[index].level = this.traits[index].level.add(1);
                    this.traits[index].cost = Decimal.pow(3, this.traits[index].level).sub(1);
                },
                buyMaxTrait1(){
                    for(let i=0;i<27;i++) {
                        let amount=Math.floor(this.icing.add(1).log(3)+1);
                        this.traits[i].level = this.traits[i].level.max(amount);
                        this.traits[i].cost = Decimal.pow(3, this.traits[i].level).sub(1);
                    }
                },
                buyMaxTrait2(){
                    for(let i=27;i<39;i++) {
                        let amount=Math.floor(this.honey.add(1).log(3)+1);
                        this.traits[i].level = this.traits[i].level.max(amount);
                        this.traits[i].cost = Decimal.pow(3, this.traits[i].level).sub(1);
                    }
                },
                buyMaxTrait3(){
                    for(let i=39;i<42;i++) {
                        let amount=Math.floor(this.caramel.add(1).log(3)+1);
                        this.traits[i].level = this.traits[i].level.max(amount);
                        this.traits[i].cost = Decimal.pow(3, this.traits[i].level).sub(1);
                    }
                },
                icingReset() {
                    if (this.totalFosskie.lt(1e12)) return;
                    this.icing = this.icing.add(this.icingGain);
                    this.totalIcing = this.totalIcing.add(this.icingGain);
                    this.fosskie = N(0);
                    this.resetFosskie = N(0);
                    this.peiLives.forEach(pei => {
                        pei.level = N(0);
                    });
                    for(let i=0;i<27;i++) {
                        if(!this.automation[10].activate) cancelAnimationFrame(this.peiLives[i].timer);
                        this.peiLives[i].progress = 0;
                    }
                },
                honeyReset() {
                    if (this.totalFosskie.lt(1e48)) return;
                    this.honey = this.honey.add(this.honeyGain);
                    this.totalHoney = this.totalHoney.add(this.honeyGain);
                    this.icing = N(0);
                    this.totalIcing = N(0);
                    this.fosskie = N(0);
                    this.resetFosskie = N(0);
                    this.peiLives.forEach(pei => {
                        pei.level = N(0);
                    });
                    for(let i=0;i<27;i++) {
                        this.traits[i].level = N(0);
                        this.traits[i].cost = Decimal.pow(3, this.traits[i].level).sub(1);
                        if(!this.automation[10].activate) cancelAnimationFrame(this.peiLives[i].timer);
                        this.peiLives[i].progress = 0;}
                },
                sweetenReset(){
                    if (this.totalFosskie.lt(1e192)) return;
                    this.sweetenCount = this.sweetenCount.add(1);
                    this.honey = N(0);
                    this.totalHoney = N(0);
                    this.icing = N(0);
                    this.totalIcing = N(0);
                    this.fosskie = N(0);
                    this.resetFosskie = N(0);
                    this.peiLives.forEach(pei => {
                        pei.level = N(0);
                    });
                    for(let i=0;i<27;i++) {
                        if(!this.automation[10].activate) cancelAnimationFrame(this.peiLives[i].timer);
                        this.peiLives[i].progress = 0;
                    }
                    for(let i=0;i<39;i++) {
                        this.traits[i].level = N(0);
                        this.traits[i].cost = Decimal.pow(3, this.traits[i].level).sub(1);
                    }
                },
                caramelReset(){
                    if (this.totalFosskie.lt(1e308)) return;
                    this.caramel = this.caramel.add(this.caramelGain);
                    this.totalCaramel = this.totalCaramel.add(this.caramelGain);
                    this.honey = N(0);
                    this.totalHoney = N(0);
                    this.icing = N(0);
                    this.totalIcing = N(0);
                    this.fosskie = N(0);
                    this.resetFosskie = N(0);
                    this.peiLives.forEach(pei => {
                        pei.level = N(0);
                    });
                    for(let i=0;i<27;i++) {
                        if(!this.automation[10].activate) cancelAnimationFrame(this.peiLives[i].timer);
                        this.peiLives[i].progress = 0;
                    }
                    for(let i=0;i<39;i++) {
                        this.traits[i].level = N(0);
                        this.traits[i].cost = Decimal.pow(3, this.traits[i].level).sub(1);
                    }
                },
                buyRefineryU(index){
                    const upgrade=this.refineryU[index];
                    if(this.caramel.lt(upgrade.cost) | upgrade.level.gte(upgrade.maxLevel)) return;
                    this.caramel = this.caramel.sub(upgrade.cost);
                    this.refineryU[index].level = this.refineryU[index].level.add(1);
                    let t=[1,1e6,1e12,1e18,1e24]
                    this.refineryU[index].cost = Decimal.pow(1.148698354997035, upgrade.level).mul(t[index]);
                },
                buyMaxRefineryU(index){
                    for(let i=0;i<100;i++) this.buyRefineryU(index);
                },
                buyAllRefineryU(){
                    for(let i=0;i<5;i++) this.buyMaxRefineryU(i);
                },

                //超越相关方法
                calcCeleBulkCost(index, amount) {
                    const pei = this.peiCeles[index];
                    const r = 1.148698354997035;
                    const a1 = pei.baseCost.mul(Decimal.pow(r, pei.level));
                    if (amount === 1) return a1.div(this.calcCeleCostMult(index));
                    return a1.mul(Decimal.pow(r, amount).sub(1)).div(r - 1).div(this.calcCeleCostMult(index));
                },
                buyPeiCele(index, amount) {
                    const cost = this.calcCeleBulkCost(index, amount);
                    if (this.starkie.gte(cost)) {
                        this.starkie = this.starkie.sub(cost);
                        this.peiCeles[index].level = this.peiCeles[index].level.add(amount);
                        if(this.peiCeles[index].timer == null) this.startCeleProd(index);
                    }
                },
                buyMaxPeiCele(){
                    for(let i=0;i<56;i++) {
                        let amount=Math.floor(this.starkie.mul(this.calcCeleCostMult(i)).div(this.peiCeles[i].baseCost).mul(1.148698354997035).max(1).log(1.148698354997035));
                        this.peiCeles[i].level = this.peiCeles[i].level.max(amount);
                    }
                },
                startCeleProd(index) {        
                    let last =Date.now();
                    const updateProgress = () => {
                        let now = Date.now();
                        
                        const delta = (now - last) / 1000;
                        this.peiCeles[index].progress += delta * this.calcCeleSpeedMult(index).toNumber();
                        
                        if (this.peiCeles[index].progress >= this.peiCeles[index].duration) {
                            this.starkie = this.starkie.add(this.calcCeleProd(index).mul(Math.floor(this.peiCeles[index].progress/this.peiCeles[index].duration)));
                            this.totalStarkie = this.totalStarkie.add(this.calcCeleProd(index));
                            this.resetStarkie = this.resetStarkie.add(this.calcCeleProd(index));
                            this.milkExp = this.milkExp.add(this.calcCeleProd(index));
                            if(this.milkExp.gte(this.milkExpReq)){
                                this.milkLevel = this.milkLevel.add(1);
                                this.milk=this.milkCount;
                            }
                            this.peiCeles[index].progress = this.peiCeles[index].progress % this.peiCeles[index].duration;
                            cancelAnimationFrame(this.peiCeles[index].timer);
                            this.startCeleProd(index);
                        } else {
                            this.peiCeles[index].timer = requestAnimationFrame(updateProgress);
                        }
                        last = now;
                    };
                    updateProgress();
                },
                calcCeleProd(index){
                    return this.peiCeles[index].level.mul(this.peiCeles[index].baseProd).mul(this.calcCeleMult(index));
                },
                calcCeleCost(index){
                    return Decimal.pow(1.148698354997035,this.peiCeles[index].level).mul(this.peiCeles[index].baseCost);
                },
                calcCeleMult(index){
                    return (this.peiCeles[index].level.lte(200)?Decimal.pow(3, this.peiCeles[index].level.div(25).floor()):Decimal.pow(3, this.peiCeles[index].level.add(200).div(50).floor()))
                    .mul(Decimal.pow(2, this.enhans[index % 14].level))
                    .mul(this.refineryU[3].level.gte(1)?this.sweetenCount.add(1):1)
                    .mul(this.calculateSpiceBonus().max(1));
                },
                calcCeleSpeedMult(index){
                    return Decimal.pow(2, this.enhans[this.celetype[index]+15].level);
                },
                calcCeleCostMult(index){
                    let researchIndex = Math.floor(index / 4);
                    if(researchIndex < 14){
                        return Decimal.pow(2, this.astroResearch[researchIndex].level);
                    }
                    return N(1);
                },
                buyEnhan(index){
                    if(this.enhans[index].tier == 1 ){
                        if(this.cheese.lt(this.enhans[index].cost)) return;
                        this.cheese = this.cheese.sub(this.enhans[index].cost);
                    }
                    else if(this.enhans[index].tier == 2){
                        if(this.cream.lt(this.enhans[index].cost)) return;
                        this.cream = this.cream.sub(this.enhans[index].cost);
                    }
                    else if(this.enhans[index].tier == 3){
                        if(this.butter.lt(this.enhans[index].cost)) return;
                        this.butter = this.butter.sub(this.enhans[index].cost);
                    }
                    else return;
                    this.enhans[index].level = this.enhans[index].level.add(1);
                    this.enhans[index].cost = Decimal.pow(4, this.enhans[index].level).sub(1);
                },
                buyMaxEnhan1(){
                    for(let i=0;i<15;i++) {
                        let amount=Math.floor(this.cheese.add(1).log(4)+1);
                        this.enhans[i].level = this.enhans[i].level.max(amount);
                        this.enhans[i].cost = Decimal.pow(4, this.enhans[i].level).sub(1);
                    }
                },
                buyMaxEnhan2(){
                    for(let i=15;i<30;i++) {
                        let amount=Math.floor(this.cream.add(1).log(4)+1);
                        this.enhans[i].level = this.enhans[i].level.max(amount);
                        this.enhans[i].cost = Decimal.pow(4, this.enhans[i].level).sub(1);
                    }
                },
                buyMaxEnhan3(){
                    for(let i=30;i<40;i++) {
                        let amount=Math.floor(this.butter.add(1).log(4)+1);
                        this.enhans[i].level = this.enhans[i].level.max(amount);
                        this.enhans[i].cost = Decimal.pow(4, this.enhans[i].level).sub(1);
                    }
                },
                cheeseReset() {
                    if (this.totalStarkie.lt(1e12)) return;
                    this.cheese = this.cheese.add(this.cheeseGain);
                    this.totalCheese = this.totalCheese.add(this.cheeseGain);
                    this.starkie = N(0);
                    this.resetStarkie = N(0);
                    this.peiCeles.forEach(pei => {
                        pei.level = N(0);
                    });
                    for(let i=0;i<56;i++) {
                        cancelAnimationFrame(this.peiCeles[i].timer);
                        this.peiCeles[i].timer=null;
                        this.peiCeles[i].progress = 0;
                    }
                },
                creamReset() {
                    if (this.totalStarkie.lt(1e48)) return;
                    this.cream = this.cream.add(this.creamGain);
                    this.totalCream = this.totalCream.add(this.creamGain);
                    this.cheese = N(0);
                    this.totalCheese = N(0);
                    this.starkie = N(0);
                    this.resetStarkie = N(0);
                    this.peiCeles.forEach(pei => {
                        pei.level = N(0);
                    });
                    for(let i=0;i<56;i++) {
                        cancelAnimationFrame(this.peiCeles[i].timer);
                        this.peiCeles[i].timer=null;
                        this.peiCeles[i].progress = 0;
                    }
                    for(let i=0;i<15;i++) {
                        this.enhans[i].level = N(0);
                        this.enhans[i].cost = Decimal.pow(4, this.enhans[i].level);
                    }
                },
                dreamReset(){
                    if (this.totalStarkie.lt(1e192)) return;
                    this.dreamCount = this.dreamCount.add(1);
                    this.cream = N(0);
                    this.totalCream = N(0);
                    this.butter = N(0);
                    this.totalButter = N(0);
                    this.starkie = N(0);
                    this.resetStarkie = N(0);
                    this.peiCeles.forEach(pei => {
                        pei.level = N(0);
                    });
                    for(let i=0;i<56;i++) {
                        cancelAnimationFrame(this.peiCeles[i].timer);
                        this.peiCeles[i].timer=null;
                        this.peiCeles[i].progress = 0;
                    }
                    for(let i=0;i<30;i++) {
                        this.enhans[i].level = N(0);
                        this.enhans[i].cost = Decimal.pow(4, this.enhans[i].level);
                    }
                },
                butterReset(){
                    if (this.totalStarkie.lt(1e308)) return;
                    this.butter = this.butter.add(this.butterGain);
                    this.totalButter = this.totalButter.add(this.butterGain);
                    this.cream = N(0);
                    this.totalCream = N(0);
                    this.butter = N(0);
                    this.totalButter = N(0);
                    this.starkie = N(0);
                    this.resetStarkie = N(0);
                    this.peiCeles.forEach(pei => {
                        pei.level = N(0);
                    });
                    for(let i=0;i<56;i++) {
                        cancelAnimationFrame(this.peiCeles[i].timer);
                        this.peiCeles[i].timer=null;
                        this.peiCeles[i].progress = 0;
                    }
                    for(let i=0;i<30;i++) {
                        this.enhans[i].level = N(0);
                        this.enhans[i].cost = Decimal.pow(4, this.enhans[i].level);
                    }
                },
                buyCondenseryU(index){
                    const upgrade=this.refineryU[index];
                    if(this.caramel.lt(upgrade.cost) | upgrade.level.gte(upgrade.maxLevel)) return;
                    this.caramel = this.caramel.sub(upgrade.cost);
                    this.refineryU[index].level = this.refineryU[index].level.add(1);
                    let t=[1,1e6,1e12,1e18,1e24]
                    this.refineryU[index].cost = Decimal.pow(1.148698354997035, upgrade.level).mul(t[index]);
                },
                buyMaxCondenseryU(index){
                    for(let i=0;i<100;i++) this.buyCondenseryU(index);
                },

                calcResearchDuration(index){
                    return N(100).mul(Decimal.pow(3, this.astroResearch[index].level));
                },

                calcResearchSpeedMult(){
                    let speed = this.dreamCount.gte(1) ? this.dreamCount : N(1);
                    if(this.dreamCount.gte(40)){
                        speed = speed.mul(Decimal.pow(1.25, this.dreamCount.sub(40).add(1)));
                    }
                    return speed;
                },

                startAstroResearch(index){
                    for(let i=0;i<20;i++){
                        if(this.astroResearch[i].active && i !== index){
                            return;
                        }
                    }
                    if(this.astroResearch[index].active) return;
                    
                    this.astroResearch[index].active = true;
                    this.astroResearch[index].duration = this.calcResearchDuration(index);
                    
                    let last = Date.now();
                    const updateProgress = () => {
                        let now = Date.now();
                        const delta = (now - last) / 1000;
                        this.astroResearch[index].progress += delta * this.calcResearchSpeedMult().toNumber();
                        
                        if(this.astroResearch[index].progress >= this.astroResearch[index].duration){
                            this.astroResearch[index].level = this.astroResearch[index].level.add(1);
                            this.astroResearch[index].progress = 0;
                            this.astroResearch[index].duration = this.calcResearchDuration(index);
                            cancelAnimationFrame(this.astroResearch[index].timer);
                            this.startAstroResearch(index);
                        } else {
                            this.astroResearch[index].timer = requestAnimationFrame(updateProgress);
                        }
                        last = now;
                    };
                    updateProgress();
                },

                cancelAstroResearch(index){
                    if(this.astroResearch[index].timer){
                        cancelAnimationFrame(this.astroResearch[index].timer);
                        this.astroResearch[index].timer = null;
                    }
                    this.astroResearch[index].active = false;
                    this.astroResearch[index].progress = 0;
                },


                //探索中心相关方法

                
                //杂项
                format(decimal) {
                    let e = decimal.exponent.toFixed(0);
                    let m = decimal.mantissa.toFixed(3);
                    let ee = Math.floor(Math.log10(decimal.exponent)).toFixed(0);
                    let mm = (decimal.exponent / Math.pow(10, ee)).toFixed(3);
                    if(m == "10.000") m = "9.999";
                    if (mm == "10.000") mm = "9.999";
                    if (decimal.lt(10)) return decimal.toFixed(3);
                    if (decimal.lt(100)) return decimal.toFixed(2);
                    if (decimal.lt(1000)) return decimal.toFixed(1);
                    else if (decimal.lt(1e12)) return this.comma(decimal);
                    else if (decimal.lt("1e1000000000000")) return m + "e" + this.comma(e);
                    else if (decimal.lt("1e9000000000000000")) return m + "e" + mm + "e" + ee;
                    else return "END"
                },
                formatInt(decimal) {
                    let e = decimal.exponent.toFixed(0);
                    let m = decimal.mantissa.toFixed(3);
                    let ee = Math.floor(Math.log10(decimal.exponent)).toFixed(0);
                    let mm = (decimal.exponent / Math.pow(10, ee)).toFixed(3);
                    if (m == "10.000") m = "9.999";
                    if (mm == "10.000") mm = "9.999";
                    else if (decimal.lt(1e12)) return this.comma(decimal);
                    else if (decimal.lt("1e1000000000000")) return m + "e" + this.comma(e);
                    else if (decimal.lt("1e9000000000000000")) return m + "e" + mm + "e" + ee;
                    else return "END"
                },
                comma(num) {
                    if (num === null || num === undefined) return "END"
                    let init = num.toString()
                    let portions = init.split(".")
                    portions[0] = portions[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,")
                    return portions[0]
                },
                saveData() {
                // 1. 获取原始数据
                    return{
                        milkLevel: this.milkLevel,
                        milkExperience: this.milkExperience,
                        stardust: this.stardust,
                        celestials: this.celestials,
                        peiCount: this.peiCount,
                        thisAscendPei: this.thisAscendPei,
                        totalLifetimePei: this.totalLifetimePei,
                        totalClickPei: this.totalClickPei,
                        goldenPeiClick: this.goldenPeiClick,
                        enableClick: this.enableClick,
                        enableGolden: this.enableGolden,
                        ascensionCount: this.ascensionCount,
                        realityShards: this.realityShards,
                        totalRealityShards: this.totalRealityShards,
                        transcensionCount: this.transcensionCount,
                        transcendPoints: this.transcendPoints,
                        totalTranscendPoints: this.totalTranscendPoints,
                        breakCount: this.breakCount,
                        breakTimer: this.breakTimer,
                        hypercendCount: this.hypercendCount,
                        hypercendPoints: this.hypercendPoints,
                        totalHypercendPoints: this.totalHypercendPoints,
                        maxHypercendPoints: this.maxHypercendPoints,
                        hyperCharge: this.hyperCharge,
                        nutCount: this.nutCount,
                        spaceResetCount: this.spaceResetCount,
                        spaceRecord: this.spaceRecord,
                        nobreakRecord: this.nobreakRecord,

                        fosskie: this.fosskie,
                        totalFosskie: this.totalFosskie,
                        resetFosskie: this.resetFosskie,
                        icing: this.icing,
                        totalIcing: this.totalIcing,
                        honey: this.honey,
                        totalHoney: this.totalHoney,
                        sweetenCount: this.sweetenCount,
                        caramel: this.caramel,
                        totalCaramel: this.totalCaramel,
                        sugarCharge: this.sugarCharge,

                        milkLevel: this.milkLevel,
                        milkExp: this.milkExp,
                        starkie: this.starkie,
                        totalStarkie: this.totalStarkie,
                        resetStarkie: this.resetStarkie,
                        cheese: this.cheese,
                        totalCheese: this.totalCheese,
                        cream: this.cream,
                        totalCream: this.totalCream,
                        dreamCount: this.dreamCount,
                        butter: this.butter,
                        totalButter: this.totalButter,
                        milkCharge: this.milkCharge,

                        // 高级成就相关
                        advancedAchievements: this.advancedAchievements.map(a => ({ 
                            id: a.id, 
                            completedTimes: a.completedTimes 
                        })),
                        
                        // 挑战相关
                        challenges: this.challenges.map(c => ({ 
                            id: c.id, 
                            completedTimes: c.completedTimes 
                        })),
                        totalChallengeCompletions: this.totalChallengeCompletions,
                        
                        // 香料相关
                        cinnamon: this.cinnamon,
                        vanilla: this.vanilla,
                        cinnamonResetCount: this.cinnamonResetCount,
                        vanillaResetCount: this.vanillaResetCount,
                        
                        // 蚁丘相关
                        antHillLevel: this.antHillLevel,
                        antsNotDriven: this.antsNotDriven,
                        antsDriven: this.antsDriven,

                        milk: this.milk,
                        sugar: this.sugar,
                        salt: this.salt,
                        playTime: this.playTime,
                        playTime2: this.playTime2,
                        totalPlayTime: this.totalPlayTime,
                        lastUpdateTime: Date.now(),
                        
                        buildings: this.buildings.map(b => ( b.quantity )),
                        upgrades: this.upgrades.map(u => ( u.unlocked )),
                        achievements: this.achievements.map(a => ( a.unlocked )),
                        automationu: this.automation.map(u => (u.unlocked)),
                        automationa: this.automation.map(a => (a.activate)),
                        ascendU: this.ascendU.map(au => ( au.level )),
                        transcendU: this.transcendU.map(tu => (tu.level)),
                        hypercendU: this.hypercendU.map(hu => (hu.level)),
                        hyperChargeU: this.hyperChargeU.map(hu => (hu.unlocked)),
                        spaceU: this.spaceU.map(u => (u.level)),
                        saltU: this.saltU.map(u => (u.level)),

                        peiLives: this.peiLives.map(pl => (pl.level)),
                        peiLivesAuto: this.peiLives.map(pl => (pl.auto)),
                        traits: this.traits.map(t => (t.level)),
                        refineryU: this.refineryU.map(ru => (ru.level)),

                        peiCeles: this.peiCeles.map(ce => (ce.level)),
                        enhans: this.enhans.map(e => (e.level)),
                        astroResearch: this.astroResearch.map(ar => (ar.level)),
                        condenseryU: this.condenseryU.map(u => (u.level)),
                    }
                },
                loadData(save){
                    this.peiCount = save.peiCount || N(0);
                    this.thisAscendPei = save.thisAscendPei || N(0);
                    this.totalLifetimePei = save.totalLifetimePei || N(0);
                    this.totalClickPei = save.totalClickPei || N(0);
                    this.goldenPeiClick = save.goldenPeiClick || 0;
                    this.enableClick=save.enableClick || true;
                    this.enableGolden=save.enableGolden || true;
                    this.ascensionCount = save.ascensionCount || N(0);
                    this.realityShards = save.realityShards || N(0);
                    this.totalRealityShards = save.totalRealityShards || N(0);
                    this.transcensionCount = save.transcensionCount || N(0);
                    this.transcendPoints = save.transcendPoints || N(0);
                    this.totalTranscendPoints = save.totalTranscendPoints || N(0);
                    this.breakCount = save.breakCount || N(0);
                    this.breakTimer = save.breakTimer || N(0);
                    this.hypercendCount = save.hypercendCount || N(0);
                    this.hypercendPoints = save.hypercendPoints || N(0);
                    this.totalHypercendPoints = save.totalHypercendPoints || N(0);
                    this.maxHypercendPoints = save.maxHypercendPoints || N(0);
                    this.hyperCharge = save.hyperCharge || N(0);
                    this.nutCount = save.nutCount || N(0);
                    this.spaceResetCount = save.spaceResetCount || N(0);
                    this.spaceRecord = save.spaceRecord || N(0);
                    this.nobreakRecord = save.nobreakRecord || N(0);
                   
                    this.fosskie = save.fosskie || N(0);
                    this.totalFosskie = save.totalFosskie || N(0);
                    this.resetFosskie = save.resetFosskie || N(0);
                    this.icing = save.icing || N(0);
                    this.totalIcing = save.totalIcing || N(0);
                    this.honey = save.honey || N(0);
                    this.totalHoney = save.totalHoney || N(0);
                    this.sweetenCount = save.sweetenCount || N(0);
                    this.caramel = save.caramel || N(0);
                    this.totalCaramel = save.totalCaramel || N(0);
                    this.sugarCharge = save.sugarCharge || N(0);

                    this.milkLevel = save.milkLevel || N(0);
                    this.milkExp = save.milkExp || N(0);
                    this.starkie = save.starkie || N(0);
                    this.totalStarkie = save.totalStarkie || N(0);
                    this.resetStarkie = save.resetStarkie || N(0);
                    this.cheese = save.cheese || N(0);
                    this.totalCheese = save.totalCheese || N(0);
                    this.cream = save.cream || N(0);
                    this.totalCream = save.totalCream || N(0);
                    this.dreamCount = save.dreamCount || N(0);
                    this.butter = save.butter || N(0);
                    this.totalButter = save.totalButter || N(0);
                    this.milkCharge = save.milkCharge || N(0);

                    this.milk = save.milk || N(0);
                    this.sugar = save.sugar || N(0);
                    this.salt = save.salt || N(0);
                    this.playTime = save.playTime || 0;
                    this.playTime2 = save.playTime2 || 0;
                    this.totalPlayTime = save.totalPlayTime || 0;

                    // 高级成就相关
                    if (save.advancedAchievements) {
                        save.advancedAchievements.forEach(savedAchievement => {
                            const achievement = this.advancedAchievements.find(a => a.id === savedAchievement.id);
                            if (achievement) {
                                achievement.completedTimes = savedAchievement.completedTimes || N(0);
                            }
                        });
                    }
                    
                    // 挑战相关
                    if (save.challenges) {
                        save.challenges.forEach(savedChallenge => {
                            const challenge = this.challenges.find(c => c.id === savedChallenge.id);
                            if (challenge) {
                                challenge.completedTimes = savedChallenge.completedTimes || N(0);
                            }
                        });
                    }
                    this.totalChallengeCompletions = save.totalChallengeCompletions || N(0);
                    
                    // 香料相关
                    this.cinnamon = save.cinnamon || N(0);
                    this.vanilla = save.vanilla || N(0);
                    this.cinnamonResetCount = save.cinnamonResetCount || N(0);
                    this.vanillaResetCount = save.vanillaResetCount || N(0);
                    
                    // 蚁丘相关
                    this.antHillLevel = save.antHillLevel || N(0);
                    this.antsNotDriven = save.antsNotDriven || N(0);
                    this.antsDriven = save.antsDriven || N(0);
                    this.antReleaseSpeed = this.calculateAntReleaseSpeed();

                    this.buildings.forEach((b, index) => {
                        b.quantity = !save.buildings? N(0): save.buildings[index] || N(0);
                    });
                    this.upgrades.forEach((u, index) => {
                        u.unlocked = !save.upgrades? false:save.upgrades[index] || false;
                    });
                    this.achievements.forEach((a, index) => {
                        a.unlocked = !save.achievements? false:save.achievements[index] || false;
                    });
                    this.automation.forEach((a, index) => {
                        a.unlocked = !save.automationu? false:save.automationu[index] || false;
                        a.activate = !save.automationa? false:save.automationa[index] || false;
                    });
                    this.ascendU.forEach((au, index) => {
                        au.level = !save.ascendU? N(0):save.ascendU[index] || N(0);
                    });
                    this.transcendU.forEach((tu, index) => {
                        tu.level = !save.transcendU? N(0):save.transcendU[index] || N(0);
                    });
                    this.hypercendU.forEach((hu, index) => {
                        hu.level = !save.hypercendU? N(0):save.hypercendU[index] || N(0);
                    });
                    this.hyperChargeU.forEach((hu, index) => {
                        hu.unlocked = !save.hyperChargeU? false:save.hyperChargeU[index] || false;
                    });
                    this.spaceU.forEach((su, index) => {
                        su.level = !save.spaceU? N(0):save.spaceU[index] || N(0);
                    })
                    this.saltU.forEach((su, index) => {
                        su.level = !save.saltU? N(0):save.saltU[index] || N(0);
                    })

                    this.peiLives.forEach((pl, index) => {
                        pl.level = !save.peiLives? N(0):save.peiLives[index] || N(0);
                        pl.auto = !save.peiLivesAuto? false:save.peiLivesAuto[index] || false;
                    })
                    this.traits.forEach((t, index) => {
                        t.level = !save.traits? N(0):save.traits[index] || N(0);
                    })
                    this.refineryU.forEach((ru, index) => {
                        ru.level = !save.refineryU? N(0):save.refineryU[index] || N(0);
                    })

                    this.peiCeles.forEach((ce, index) => {
                        ce.level = !save.peiCeles? N(0):save.peiCeles[index] || N(0);
                    })
                    this.enhans.forEach((e, index) => {
                        e.level = !save.enhans? N(0):save.enhans[index] || N(0);
                    })
                    this.astroResearch.forEach((ar, index) => {
                        ar.level = !save.astroResearch? N(0):save.astroResearch[index] || N(0);
                    })
                    this.condenseryU.forEach((cu, index) => {
                        cu.level = !save.condenseryU? N(0):save.condenseryU[index] || N(0);
                    })

                    this.updateCost();
                    this.handleOfflineProduction(save.lastUpdateTime);
                },
                saveGame() {
                    console.log(this.saveData());
                    // 2. 转换为JSON字符串
                    const save= formatsave.encode(this.saveData())
                    console.log(save);
                    // 3. 显示给用户（示例）
                    navigator.clipboard.writeText(save);
                    alert("存档代码已复制到剪贴板");
                },
                loadGame() {
                    const save = prompt("请输入存档代码");
                        // 4. 解析JSON
                    const data = formatsave.decode(save);
                    transformToDecimal(data);
                        // 5. 应用存档数据
                    this.loadData(data);
                    alert("存档加载成功！");
                    this.localSave();
                },
                localSave() {
                    localStorage.pelkieClickerSave = formatsave.encode(this.saveData());
                },
                localLoad() {
                    if (!localStorage.pelkieClickerSave) return;
                    const data = formatsave.decode(localStorage.pelkieClickerSave);
                    transformToDecimal(data);
                    console.log(data);
                    this.loadData(data);
                },
                hardReset() {
                    if (confirm("是否硬重置?这将重置你的所有进度!")) {
                        // 用户点击了确定
                        this.peiCount = N(0);
                        this.thisAscendPei = N(0);
                        this.totalLifetimePei = N(0);
                        this.totalClickPei = N(0);
                        this.peiPerSecond= N(0);
                        this.peiPerClick= N(1);
                        this.goldenPeiClick = 0;
                        this.goldenPeiTimer = 0;
                        this.enableClick=true;
                        this.enableGolden=true;
                        this.goldenPeiEffects = {
                            clickMultiplier: N(1),
                            buildingMultiplier: N(1),
                            buildingCostReduction: N(1),
                            upgradeCostReduction: N(1),
                            randomBuildingBoost: null
                        };
                        this.buildings= Array.from({ length: 42 }, (_, i) => ({
                            id: i,
                            quantity: N(0),
                            baseCost: N(10).pow(i * (i - 1) / 40 + i + 1),
                            cost: N(10).pow(i * (i - 1) / 40 + i + 1),
                            baseProd: N(8).pow(i - 1),
                            production: N(8).pow(i - 1),
                        })),
                        this.upgrades= UPGRADES.map(u => ({
                                ...u,
                                unlocked: false,
                            })),
                        this.achievements= ACHIEVEMENTS.map(a => ({
                                ...a,
                                unlocked: false,
                            })),
                        this.automation=AUTOMATION.map(a => ({
                                ...a,
                                unlocked: false,
                                activate: false,
                            })),
                        this.ascendU= ASCENDU.map(r => ({
                                ...r,
                                level: N(0),
                            })),
                        this.transcendU= TRANSCENDU.map(r => ({
                                ...r,
                                level: N(0),
                            })),
                        this.hypercendU= HYPERCENDU.map(r => ({
                                ...r,
                                level: N(0),
                            })),
                        this.hyperChargeU= HYPERCHARGEU.map(r => ({
                                ...r,
                                unlocked: false,
                            }))
                        this.spaceU= SPACEU.map(r => ({
                            ...r,
                            level: N(0),
                        }))
                        this.saltU= SALTU.map(r => ({
                            ...r,
                            level: N(0),
                        }))
                        
                        this.peiLives= Array(28).fill().map((_,i) => ({
                            id: i+1,
                            level: N(0),       // 当前等级
                            progress: 0,       // 生产进度(秒)
                            auto: false,
                            timer: null,
                            duration: Math.pow(10, i/10+0.4),//生产所需时间(秒)
                            baseCost: N(12).pow(i+1),//基础成本
                            baseProd: N(8).pow(i+1)//基础产量
                        })),
                        this.traits= Array(42).fill().map((_,i) => ({
                            id: i+1,
                            tier: i<27?1:i<39?2:i<42?3:0,
                            level: N(0),
                            cost: N(1)
                        })),
                        this.refineryU=REFINERYU.map(r => ({
                            ...r,
                            level: N(0),
                        })),

                        this.peiCeles=Array(56).fill().map((_,i)=>({
                            id: i+1,
                            level: N(0),       // 当前等级
                            progress: 0,       // 生产进度(秒)
                            timer: null,
                            duration: Math.pow(10, (i+1)/10),//生产所需时间(秒)
                            baseCost: i==0?N(10):Decimal.pow(10,i+1+(i+1)*(i+1)/30),//基础成本
                            baseProd: i==0?N(2):Decimal.pow(8,i+1+(i+1)*(i+1)/30).div(4),//基础产量
                        })),
                        this.enhans= Array(40).fill().map((_,i) => ({
                            id: i+1,
                            tier: i<15?1:i<30?2:i<40?3:0,
                            level: N(0),
                            cost: N(1),
                        })),
                        this.astroResearch= Array(20).fill().map((_,i) => ({
                            id: i+1,
                            level: N(0),
                            duration: N(100),
                            progress: 0,
                            timer: null,
                            active: false,
                        })),
                        this.condenseryU= CONDENSERYU.map(r => ({
                            ...r,
                            level: N(0),
                        }))


                        this.ascensionCount = N(0);
                        this.realityShards = N(0);
                        this.totalRealityShards = N(0);
                        this.transcensionCount = N(0);
                        this.transcendPoints = N(0);
                        this.totalTranscendPoints = N(0);
                        this.breakCount=N(0);
                        this.breakTimer = N(0);
                        this.hypercendCount = N(0);
                        this.hypercendPoints = N(0);
                        this.totalHypercendPoints = N(0);
                        this.maxHypercendPoints = N(0);
                        this.hyperCharge = N(0);
                        this.nutCount = N(0);
                        this.spaceResetCount = N(0);
                        this.spaceRecord = N(0);
                        this.nobreakRecord = N(0);

                        this.fosskie = N(0);
                        this.totalFosskie = N(0);
                        this.resetFosskie = N(0);
                        this.icing = N(0);
                        this.totalIcing = N(0);
                        this.honey = N(0);
                        this.totalHoney = N(0);
                        this.sweetenCount = N(0);
                        this.caramel = N(0);
                        this.totalCaramel = N(0);
                        this.sugarCharge=N(0);

                        this.milkLevel = N(0);
                        this.milkExp = N(0);
                        this.starkie = N(0);
                        this.totalStarkie = N(0);
                        this.resetStarkie = N(0);
                        this.cheese = N(0);
                        this.totalCheese = N(0);
                        this.cream = N(0);
                        this.totalCream = N(0);
                        this.dreamCount = N(0);
                        this.butter = N(0);
                        this.totalButter = N(0);
                        this.milkCharge = N(0);
                        
                        // 高级成就相关重置
                        this.advancedAchievements.forEach(achievement => {
                            achievement.completedTimes = N(0);
                        });
                        
                        // 挑战相关重置
                        this.challenges.forEach(challenge => {
                            challenge.completedTimes = N(0);
                            challenge.active = false;
                        });
                        this.totalChallengeCompletions = N(0);
                        
                        // 香料相关重置
                        this.cinnamon = N(0);
                        this.vanilla = N(0);
                        this.cinnamonResetCount = N(0);
                        this.vanillaResetCount = N(0);
                        
                        // 蚁丘相关重置
                        this.antHillLevel = N(0);
                        this.antReleaseSpeed = N(0);
                        this.antsNotDriven = N(0);
                        this.antsDriven = N(0);

                        this.milk = N(0);
                        this.sugar = N(0);
                        this.salt=N(0);
                        this.playTime = 0;
                        this.playTime2 = 0;
                        this.totalPlayTime = 0;
                        this.lastUpdateTime= Date.now();

                        this.localSave();
                        this.currentArea=1;
                    }
                    else return;
                },
                handleOfflineProduction(savedTime) {
                    if (!savedTime) return;

                    const currentTime = Date.now();
                    const offlineTime = Math.min(currentTime - savedTime, this.ascendU[3].level.toNumber() * 21600000 + 21600000);
                    const offlineSeconds = offlineTime / 1000;

                    if (offlineSeconds > 1) {
                        // 计算离线收益
                        const production = this.totalProduction.mul(offlineSeconds*0.8);
                        this.peiCount = this.peiCount.add(production);
                        this.thisAscendPei = this.thisAscendPei.add(production);
                        this.totalLifetimePei = this.totalLifetimePei.add(production);
                        const fosskieproduction = this.fosskiePerSecond.mul(offlineSeconds*0.8);
                        this.fosskie = this.fosskie.add(fosskieproduction);
                        this.totalFosskie = this.totalFosskie.add(fosskieproduction);
                        this.resetFosskie = this.resetFosskie.add(fosskieproduction);
                        const starkieproduction = this.starkiePerSecond.mul(offlineSeconds*0.8);
                        this.starkie = this.starkie.add(starkieproduction);
                        this.totalStarkie = this.totalStarkie.add(starkieproduction);
                        this.resetStarkie = this.resetStarkie.add(starkieproduction);
                        this.playTime = this.playTime + offlineSeconds;
                        this.playTime2 = this.playTime2 + offlineSeconds;
                        this.totalPlayTime = this.totalPlayTime + offlineSeconds;
                        // 显示离线通知
                        this.showOfflineNotification(offlineSeconds, production, fosskieproduction, starkieproduction);
                    }
                },
                showOfflineNotification(seconds, a, b, c) {
                    const hours = Math.floor(seconds / 3600);
                    const mins = Math.floor((seconds % 3600) / 60);
                    const secs = Math.floor(seconds % 60);
                    const toast = document.createElement('div');
                    toast.className = 'offline-toast';
                    toast.innerHTML = `
                <p>你离线了 ${hours}h${mins}m${secs}s</p>
                <p>离线效率: 80%, 时长上限: ${this.ascendU[3].level.toNumber()*6+6}h</p>
                <p>获得了 ${seconds.toFixed(0)} 糖块计时</p>
                <p>获得 ${this.format(a)} 佩干</p>`
                + (this.hypercendU[2].level.gt(0)? `<p>获得了 ${this.format(b)} 化石饼干</p>`:``)
                + (this.refineryU[2].level.gt(0)? `<p>获得了 ${this.format(c)} 星尘饼干</p>`:``);
                    document.body.appendChild(toast);
                    setTimeout(() => toast.remove(), 5000);
                },
                updateCost(){
                    //佩干区域
                    for(let i=0;i<42;i++) this.buildings[i].cost = this.buildings[i].baseCost.mul(new Decimal(1.148698354997035).pow(this.buildings[i].quantity));
                    let a0=[1,3,5,7,50,77,100,777,999,9000,99999,222222,399999,1.5e7,1e8,2e8,1e9,1.92e9,9e9,1e10];
                    let p=[0,1334,10,0,0,0,100,0,0,0,0,2e6,0,0,0,2e8,0,0,0,0];
                    let q=[1,1,1,7,100,10,100,10,100,1e9,2,1,1,1,4,1000,10,1,1000,1];
                    for(let i=0;i<20;i++){
                        this.ascendU[i].cost = i==19?this.ascendU[19].level.add(3).pow(7).mul(1.5e7):N(a0[i]).add(this.ascendU[i].level.mul(p[i])).mul(Decimal.pow(q[i],this.ascendU[i].level))
                    }
                    let r=[1,1,1,1,1,1,1,1,1,1,1,1,10,100,1000,10000,1e5,1e5,1e6,1e6];
                    let s=[2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,4,4,10,1e6]
                    for(let i=0;i<20;i++){
                        this.transcendU[i].cost=Decimal.pow(s[i],this.transcendU[i].level).mul(r[i]);
                    }
                    let t=[1,1e6,1e12,1e18,1e24,1e100]
                    for(let i=0;i<6;i++) this.hypercendU[i].cost=Decimal.pow(1.148698354997035,this.hypercendU[i].level).mul(t[i]);
                    //中生代山谷区域
                    for(let i=0;i<27;i++) if(this.peiLives[i].auto & this.peiLives[i].level.gte(1)) this.startLifeProd(i);
                    for(let i=0;i<42;i++) this.traits[i].cost = Decimal.pow(3, this.traits[i].level).sub(1);
                    let u=[1,1e6,1e12,1e18,1e24]
                    for(let i=0;i<5;i++) this.refineryU[i].cost = Decimal.pow(1.148698354997035, this.refineryU[i].level).mul(u[i]);
                    //超越区域
                    for(let i=0;i<56;i++) if(this.peiCeles[i].level.gte(1)) this.startCeleProd(i);
                    for(let i=0;i<40;i++) this.enhans[i].cost = Decimal.pow(4, this.enhans[i].level).sub(1);
                    let v=[1,1e6,1e12,1e18,1e24]
                    for(let i=0;i<5;i++) this.condenseryU[i].cost = Decimal.pow(1.148698354997035, this.condenseryU[i].level).mul(v[i]);
                    
                    this.milk=this.milkCount;
                },
                // 其他方法...
            },
            computed: {
                // 带升级加成的总生产量
                sugarBonus(){
                    return this.upgrades.filter(u => u.buildingId == 110).reduce((prod, upgrade, i) => {
                        let factor = N(milkUpgradeBase[upgrade.id-1]*0.001);
                        return upgrade.unlocked ? prod.mul(factor.mul(this.sugar.min(1000)).mul(this.sugarUpgradeMult).add(1)) : prod;
                    }, N(1))
                    .mul([1,2,3,4,5,6,7,8,9,10].reduce((prod,i)=>{
                        return this.ascendU[15].level.gte(i)?prod.mul(this.sugar.min(1000).mul(0.001*i).mul(this.sugarUpgradeMult).add(1)):prod;
                    },N(1)))
                },
                sugarUpgradeMult(){
                    return this.transcendU[8].level.mul(0.1).add(1)
                    .mul(this.totalFosskie.div(65536).add(1).pow(0.25))
                    .mul(this.traits[38].level.mul(0.2).add(1));
                },
                milkBonus(){
                    return this.upgrades.filter(u => u.buildingId == 102).reduce((prod, upgrade, i) => {
                        let factor = N(milkUpgradeBase[upgrade.id-1]*0.001);
                        return upgrade.unlocked ? prod.mul(factor.mul(this.milk).mul(this.milkUpgradeMult).add(1)) : prod;
                    }, N(1))
                    .mul([1,2,3,4,5,6,7,8,9,10].reduce((prod,i)=>{
                        return this.ascendU[9].level.gte(i)?prod.mul(this.milk.mul(0.001*i).mul(this.milkUpgradeMult).add(1)):prod;
                    },N(1)))
                },
                milkUpgradeMult(){
                    return this.transcendU[9].level.mul(0.1).add(1)
                    .mul(this.totalStarkie.div(65536).add(1).pow(0.25));
                },
                upgradeBonus(){
                    return this.upgrades.filter(u => u.buildingId == 105).reduce((sum, upgrade) => {
                        return upgrade.unlocked ? sum.mul(1+Math.floor((upgrade.id+9)/10)/100) : sum;
                    }, N(1))
                    .mul(this.upgrades.filter(u => u.buildingId == 104 & u.id>=6).reduce((sum, upgrade, i) => {
                        let factor=[1.01,1.1,2,11,101]
                        return upgrade.unlocked ? sum.mul(factor[i]) : sum;
                    }, N(1)))
                    .mul(this.upgrades.filter(u => u.buildingId == 106).reduce((sum, upgrade) => {
                        return upgrade.unlocked ? sum.mul(1.1) : sum;
                    }, N(1)))
                    .mul(this.upgrades.filter(u=>u.buildingId==107 & u.id==4)[0].unlocked?Math.pow(1.01,Math.max(50-this.totalRealityShards.toNumber()/20,0)):1)
                    .mul(Decimal.pow(1.1,this.ascendU[1].level))
                    .mul(Decimal.pow(1.1+(this.breakCount.max(5).min(8).sub(4).mul(0.0223).toNumber()),this.transcendU[0].level))
                    .mul(Decimal.pow(65536,this.spaceU[1].level))
                    .mul(this.enableGolden&!this.transcendU[13].level.gte(1)?1:this.ascendU[8].level.add(this.transcendU[4].level).mul(0.1).add(1.4))
                    .mul(this.enableClick&!this.transcendU[13].level.gte(1)?1:this.ascendU[16].level.add(this.transcendU[4].level).mul(0.1).add(1.4))
                    .mul(Decimal.pow(this.milkLevel.mul(0.01).add(1),this.milk))
                    .mul(this.nobreakRecord.gte('1e100000')?this.nutCount.add(1).pow(4):1)
                    .mul(this.calculateSpiceBonus().max(1));
                },
                ascendBonus(){
                    return this.upgrades.filter(u => u.buildingId == 104 & u.id<=5).reduce((sum, upgrade, i) => {
                        let factor=[0.05,0.2,0.25,0.25,0.25]
                        return upgrade.unlocked ? sum.add(this.totalRealityShards.mul(factor[i])) : sum;
                    }, N(1));
                },
                transcendBonus(){
                    return this.transcensionCount.gte(1)?this.totalTranscendPoints.add(2):N(1);
                },
                breakBonus(){
                    return Decimal.pow(this.breakCount.gte(8)?10:4, this.breakCount);
                },
                hypercendBonus(){
                    return this.hyperEffect(0)
                    .mul(this.breakCount.gte(16)?this.totalHypercendPoints.add(4):1);
                },
                buildingCostMult(){
                    return (this.hypercendU[3].level.gte(1)?N(0.5).div(this.transcendU[5].level.mul(0.1).add(1)):this.goldenPeiEffects.buildingCostReduction)
                    .mul(this.ascendU[10].level.mul(-0.02).add(1))
                    .mul(Decimal.pow(0.99,this.transcendU[2].level));
                },
                upgradeCostMult(){
                    return (this.hypercendU[3].level.gte(1)?N(0.5).div(this.transcendU[5].level.mul(0.1).add(1)):this.goldenPeiEffects.upgradeCostReduction)
                    .mul(this.ascendU[10].level.mul(-0.02).add(1))
                    .mul(this.ascendU[12].level.gte(1)?0.2:1)
                    .mul(Decimal.pow(0.99,this.transcendU[3].level))
                },
                baseClick() {
                    let base = N(this.hypercendU[3].level.gte(1)?this.transcendU[5].level.toNumber()*177.8+1778:this.goldenPeiEffects.clickMultiplier);
                    let mult = this.upgrades.filter(u => u.buildingId == 1 && u.id < 4).reduce((prod, upgrade) => {
                        return upgrade.unlocked ? prod.mul(2) : prod;
                    }, N(1))
                    .add(this.upgrades.filter(u => u.buildingId == 1 && u.id == 4)[0].unlocked?
                        this.upgrades.filter(u => u.buildingId == 1 && u.id > 4 && u.id <= 20).reduce((prod, upgrade) => {
                            return upgrade.unlocked ? prod.mul(this.transcendU[6].level.mul(0.1).add(1).mul(this.transcendU[15].level.gte(1)?100:20)) : prod;
                        }, N(1)).mul(this.ascendU[13].level.gte(1)?1000: 1).mul(this.buildingCount):N(0))
                    .mul(this.upgrades.filter(u => u.buildingId == 101).reduce((prod, upgrade) => {
                        return upgrade.unlocked ? prod.mul(1.01) : prod;
                    }, N(1)))
                    .mul(Decimal.pow(1.1+(this.breakCount.max(5).min(8).sub(4).mul(0.025).toNumber()),this.transcendU[1].level));
                    return base.mul(mult);
                },
                totalClick(){
                    return this.baseClick.mul(this.sugarBonus).mul(this.milkBonus).mul(this.upgradeBonus)
                    .mul(this.ascendBonus).mul(this.transcendBonus).mul(this.breakBonus).mul(this.hypercendBonus)
                    .mul(this.hypercendU[3].level.gte(1)?this.transcendU[5].level.toNumber()*2.2+22:this.goldenPeiEffects.buildingMultiplier);
                },
                baseProduction() {
                    //if(this.buildings[41].quantity.gt(3e4)) return this.buildings[41].quantity.mul(this.buildings[41].baseProd).mul(this.buildingMult(41)).mul(40);
                    let base = this.buildings.reduce((sum, building, index) => {
                        building.production = building.quantity.mul(building.baseProd).mul(this.buildingMult(index)).mul(this.sugar.add(41.001).sub(index).div(42).floor().div(100).add(1))
                        return sum.add(building.production);
                    }, N(0));
                    return base;
                },
                totalProduction(){
                    return this.baseProduction.mul(this.milkBonus).mul(this.sugarBonus).mul(this.upgradeBonus)
                    .mul(this.ascendBonus).mul(this.transcendBonus).mul(this.breakBonus).mul(this.hypercendBonus)
                    .mul(this.hypercendU[3].level.gte(1)?this.transcendU[5].level.toNumber()*2.2+22:this.goldenPeiEffects.buildingMultiplier);
                },
                buildingCount() {
                    let sum = N(0);
                    for (i = 0; i < (this.buildings.length - 1); i++) sum = sum.add(this.buildings[i].quantity);
                    return sum;
                },
                unlockedUpgradesCount() {
                    return this.upgrades.filter(u => u.unlocked).length;
                },
                unlockedAchievementsCount() {
                    return this.achievements.filter(a => a.unlocked).length;
                },
                advancedAchievementsCount() {
                    return this.advancedAchievements.reduce((sum, achievement) => sum.add(achievement.completedTimes), N(0));
                },
                canAscend() {
                    return this.totalLifetimePei.gte(1e12);
                },
                canTranscend(){
                    return this.totalRealityShards.gte(1e12);
                },
                canBreak(){
                    return this.totalTranscendPoints.gte(Decimal.pow(10,this.breakCount).mul(1e12));
                },
                canHypercend(){
                    return this.totalLifetimePei.gte(1e308) & this.breakCount.gte(8);
                },
                totalShards() {
                    return (this.totalLifetimePei.gte(1e48) ? this.totalLifetimePei.pow(1 / 4).floor() : this.totalLifetimePei.div(1e12).pow(1 / 3).floor())
                    .mul(Decimal.pow(256,this.spaceU[3].level));;
                },
                nextShards() {
                    return this.totalShards.gte(1e12) ? this.totalShards.add(1).pow(4) : this.totalShards.add(1).pow(3).mul(1e12);
                },
                totalTP(){
                    return (this.totalRealityShards.gte(1e48) ? this.totalRealityShards.pow(1 / 4).floor() : this.totalRealityShards.div(1e12).pow(1 / 3).floor())
                    .mul(Decimal.pow(16,this.spaceU[5].level));
                },
                nextTP(){
                    return this.totalTP.max(this.totalTranscendPoints).gte(1e12) ? this.totalTP.max(this.totalTranscendPoints).add(1).pow(4) : this.totalTP.max(this.totalTranscendPoints).add(1).pow(3).mul(1e12);
                },
                nextBreak(){
                    return Decimal.pow(10,this.breakCount).mul(1e12);
                },
                HPGain(){
                    return Decimal.pow(this.totalLifetimePei, 1/308).sub(9).mul(this.HPmult).max(1).floor();
                },
                HPmult(){
                    return (this.breakCount.gte(24)?this.breakCount.mul(0.25).add(1):N(1))
                    .mul(this.hyperChargeU[6].unlocked?this.hyperEffect(7):1)
                    .mul(this.hyperChargeU[10].unlocked?this.hyperEffect(11):1)
                    .mul(this.hyperChargeU[11].unlocked?this.hyperEffect(12):1)
                    .mul(this.hyperChargeU[12].unlocked?this.hyperEffect(12):1)
                    .mul(this.hyperChargeU[13].unlocked?this.hyperEffect(12).pow(2/3):1)
                    .mul(this.hyperChargeU[14].unlocked?this.hyperEffect(12).pow(2/3):1)
                    .mul(this.hyperChargeU[15].unlocked?this.hyperEffect(12).pow(2/3):1)
                    .mul(Decimal.pow(2,this.spaceU[7].level))
                    .mul(this.sweetenCount.gte(16)?this.sweetenCount.mul(this.sweetenCount.gte(24)?10:2.5).add(1):1);
                },
                HCProduction(){
                    return this.hypercendU[0].level.pow(2)
                    .mul(this.hypercendU[1].level.mul(0.49).add(1).pow(2))
                    .mul(this.hypercendU[2].level.mul(0.19).add(1).pow(2))
                    .mul(this.hypercendU[3].level.mul(0.09).add(1).pow(2))
                    .mul(this.hypercendU[4].level.mul(0.04).add(1).pow(2))
                    .mul(this.hypercendU[5].level.mul(0.01).add(1).pow(2))
                    .mul(this.hyperChargeU[0].unlocked?this.hyperEffect(1):1)
                    .mul(this.hyperChargeU[1].unlocked?this.hyperEffect(2):1)
                    .mul(this.hyperChargeU[2].unlocked?this.hyperEffect(3):1)
                    .mul(this.hyperChargeU[3].unlocked?this.hyperEffect(4).pow(3):1)
                    .mul(this.hyperChargeU[4].unlocked?this.hyperEffect(5).pow(3):1)
                    .mul(this.hyperChargeU[5].unlocked?this.hyperEffect(6).pow(3):1)
                    .mul(this.hyperChargeU[7].unlocked?this.hyperEffect(8).pow(12):1)
                    .mul(this.hyperChargeU[8].unlocked?this.hyperEffect(9):1)
                    .mul(this.hyperChargeU[9].unlocked?this.hyperEffect(4).pow(3).mul(this.hyperEffect(8).pow(12)):1)
                    .mul(this.hyperChargeU[11].unlocked?this.hyperEffect(12).pow(24):1)
                    .mul(this.hyperChargeU[12].unlocked?this.hyperEffect(12).pow(24):1)
                    .mul(this.hyperChargeU[13].unlocked?this.hyperEffect(12).pow(16):1)
                    .mul(this.hyperChargeU[14].unlocked?this.hyperEffect(12).pow(16):1)
                    .mul(this.hyperChargeU[15].unlocked?this.hyperEffect(12).pow(16):1)
                    .mul(this.hyperChargeU[16].unlocked?this.hyperEffect(17).pow(45):1)
                    .mul(this.hyperChargeU[17].unlocked?this.hyperEffect(18).pow(45):1)
                    .mul(this.hyperChargeU[18].unlocked?this.hyperEffect(19).pow(45):1)
                    .mul(this.hyperChargeU[19].unlocked?this.hyperEffect(17).pow(15).mul(this.hyperEffect(18).pow(15)).mul(this.hyperEffect(19).pow(15)):1)
                    .mul(this.breakCount.gte(32)?Decimal.pow(2,this.breakCount.sub(26).max(1).min(64)):1)
                    .mul(Decimal.pow(4,this.spaceU[9].level));
                },
                canSpaceReset(){
                    return this.totalLifetimePei.gte("1e20000") && this.totalFosskie.gte(1e60);
                },
                nutGain(){
                    return Decimal.pow(10, Math.sqrt(this.totalLifetimePei.add(10).log(10) * this.totalFosskie.add(10).log(10))/1600)
                    .mul(this.sweetenCount.mul(0.05).add(1)).floor();
                },


                fosskiePerSecond(){
                    return this.peiLives.reduce((sum, p, index) => {
                        return p.auto? sum.add(p.baseProd.mul(p.level).mul(this.calcLifeMult(index).mul(this.calcSpeedMult(index)).div(p.duration))) : sum;
                    }, N(0));
                },
                fosskiePerClick(){
                    return this.fosskiePerSecond.div(20).add(1).mul(this.traits[36].level.mul(0.2).add(1));
                },
                icingGain(){
                    return (this.resetFosskie.gte(1e48)? this.resetFosskie.pow(1/4).floor(): this.resetFosskie.div(1e12).pow(1/3).floor())
                    .mul(this.sweetenCount.gte(3)?10000:1)
                    .mul(Decimal.pow(2,this.spaceU[2].level))
                    .mul(this.saltU[1].level.add(1));
                },
                honeyGain(){
                    return (this.resetFosskie.gte(1e192)? this.resetFosskie.pow(1/16).floor(): this.resetFosskie.div(1e48).pow(1/12).floor())
                    .mul(this.sweetenCount.gte(7)?10:1)
                    .mul(Decimal.pow(2,this.spaceU[4].level))
                    .mul(this.saltU[2].level.add(1));
                },
                nextSweeten(){
                    return Decimal.pow(1e16,this.sweetenCount).mul(1e192);
                },
                caramelMult(){
                    return (this.sweetenCount.gte(12)?this.sweetenCount.mul(this.sweetenCount.gte(24)?1:0.25).add(1):N(1))
                    .mul(Decimal.pow(2,this.spaceU[6].level))
                    .mul(this.nobreakRecord.gte('1e50000')?N(this.totalLifetimePei.add(10).log(10)).pow(1/6):1)
                    .mul(this.saltU[3].level.add(1));
                },
                caramelGain(){
                    return this.resetFosskie.pow(1/256).sub(10).mul(this.caramelMult).floor();
                },
                SCproduction(){
                    return this.refineryU[0].level
                    .mul(this.totalCaramel)
                    .mul(Decimal.pow(1.096478,this.refineryU[1].level))
                    .mul(Decimal.pow(1.071519,this.refineryU[2].level))
                    .mul(Decimal.pow(1.047129,this.refineryU[3].level))
                    .mul(Decimal.pow(1.023293,this.refineryU[4].level))
                    .mul(Decimal.pow(2,this.spaceU[8].level));
                },

                starkiePerSecond(){
                    return this.peiCeles.reduce((sum, p, index) => {
                        return sum.add(p.baseProd.mul(p.level).mul(this.calcCeleMult(index).mul(this.calcCeleSpeedMult(index)).div(p.duration)));
                    }, N(0));
                },
                starkiePerClick(){
                    return this.starkiePerSecond.div(20).add(1);
                },
                milkExpReq(){
                    return this.milkLevel.lt(58)?Decimal.pow(1000,this.milkLevel.toNumber()+1):N("e9e15");
                },
                cheeseGain(){
                    return (this.resetStarkie.gte(1e48)? this.resetStarkie.pow(1/4).floor(): this.resetStarkie.div(1e12).pow(1/3).floor())
                },
                creamGain(){
                    return (this.resetStarkie.gte(1e192)? this.resetStarkie.pow(1/16).floor(): this.resetStarkie.div(1e48).pow(1/12).floor())
                },
                nextDream(){
                    return Decimal.pow(1e16,this.dreamCount).mul(1e192);
                },
                butterMult(){
                    return N(1);
                },
                butterGain(){
                    return this.resetStarkie.pow(1/256).sub(10).mul(this.butterMult).floor();
                },
                MCproduction(){
                    return this.refineryU[0].level
                    .mul(this.totalButter)
                    .mul(Decimal.pow(1.096478,this.refineryU[1].level))
                    .mul(Decimal.pow(1.071519,this.refineryU[2].level))
                    .mul(Decimal.pow(1.047129,this.refineryU[3].level))
                    .mul(Decimal.pow(1.023293,this.refineryU[4].level))
                    ;
                },
                
                goldenPeiTimeCap(){
                    return (this.upgrades.filter(u => u.buildingId == 107 && u.id == 1)[0].unlocked ? 210 : 420) 
                    / (this.ascendU[5].level.toNumber()*0.1+1)
                    / (this.transcendU[17].level.toNumber()*0.05+1);
                },
                sugarTimeCap(){
                    return 3600 
                    / (this.ascendU[14].level.toNumber()*0.2+1)
                    / (this.transcendU[16].level.toNumber()*0.2+1)
                    / (this.breakCount.gte(40)?this.breakCount.sub(30).max(1).min(80).toNumber()*0.05+1:1)
                    //*(this.sugar.gte(1000)?this.sugar.toNumber()+1:1)
                },
                sugarGain(){
                    return this.breakCount.max(1).min(10)
                    .add(this.breakCount.gte(1000)?this.breakCount.div(1000):0)
                    .mul(this.sweetenCount.gte(2)?this.sweetenCount.toNumber()*0.1+1:1)
                    .mul(this.traits[37].level.toNumber()*0.2+1)
                    .mul(this.sweetenCount.gte(4)?2:1)
                    .mul(this.spaceU[11].level.mul(0.1).add(1));
                },
                milkCount(){
                    return N(this.unlockedAchievementsCount)
                    .add(this.advancedAchievementsCount)
                    .mul(this.breakCount.gte(3)?2:1)
                    .mul(this.spaceU[10].level.mul(0.1).add(1));
                },
                saltTimeCap(){
                    return 4000
                    /(this.sweetenCount.gte(6)?2:1)
                    /(this.spaceRecord.gte('1e80000')?2:1)
                    *(this.salt.toNumber()+1)
                },
                saltGain(){
                    return (this.sweetenCount.gte(20)?this.sweetenCount.mul(0.1).add(1):N(1));
                }
            },
            mounted() {
                this.localLoad();
                this.lastUpdate = Date.now();

                //主循环
                setInterval(() => {
                    const now = Date.now();
                    const delta = (now - this.lastUpdate) / 1000;
                    this.peiPerClick = this.totalClick;
                    this.peiPerSecond = this.totalProduction;
                    this.peiCount = this.peiCount.add(this.totalProduction.mul(delta));
                    this.thisAscendPei = this.thisAscendPei.add(this.totalProduction.mul(delta));
                    this.totalLifetimePei = this.totalLifetimePei.add(this.totalProduction.mul(delta));
                    this.breakTimer = this.breakTimer.add(delta);
                    if (this.playTime >= this.sugarTimeCap) {
                        this.playTime = this.playTime - this.sugarTimeCap;
                        this.sugar = this.sugar.add(this.sugarGain);
                    }
                    if(this.playTime2 >= this.saltTimeCap) {
                        this.playTime2 = this.playTime2 - this.saltTimeCap;
                        this.salt = this.salt.add(this.saltGain);
                    }
                    if(this.hypercendU[0].level.gte(1)) this.hyperCharge = this.hyperCharge.add(this.HCProduction.mul(delta));
                    if(this.refineryU[0].level.gte(1)) this.sugarCharge = this.sugarCharge.add(this.SCproduction.mul(delta));
                    if(this.automation[9].activate & this.breakCount.gte(8)) {
                        this.hypercendPoints = this.hypercendPoints.add(this.HPGain.mul(delta));
                        this.totalHypercendPoints = this.totalHypercendPoints.add(this.HPGain.mul(delta));
                        this.maxHypercendPoints = this.maxHypercendPoints.add(this.HPGain.mul(delta));
                    }
                    if(this.automation[15].activate) {
                        this.icing=this.icing.add(this.icingGain.mul(delta));
                        this.totalIcing=this.totalIcing.add(this.icingGain.mul(delta));
                    }
                    if(this.automation[17].activate) {
                        this.honey=this.honey.add(this.honeyGain.mul(delta));
                        this.totalHoney=this.totalHoney.add(this.honeyGain.mul(delta));
                    }
                    if(this.automation[20].activate) {
                        this.caramel=this.caramel.add(this.caramelGain.mul(delta));
                        this.totalCaramel=this.totalCaramel.add(this.caramelGain.mul(delta));
                    }
                    if(this.automation[23].activate) {
                        this.nutCount = this.nutCount.add(this.nutGain.mul(delta));
                    }
                    
                    // 更新蚂蚁数量
                    this.updateAnts(delta);
                    
                    this.lastUpdate = now;
                },10);

                //自动购买器循环
                setInterval(() => {
                    this.checkAchievements(101);
                    this.checkAchievements(102);
                    this.checkAchievements(103);
                    this.checkAchievements(104);
                    this.checkAchievements(105);
                    this.checkAchievements(106);
                    this.checkAdvancedAchievements();
                    if(this.automation[0].activate) this.buyAllBuilding();
                    if(this.automation[1].activate) this.buyAllUpgrades();
                    if(this.automation[2].activate) this.peiCount=this.peiCount.add(this.peiPerClick);
                    if(this.automation[3].activate) this.clickGoldenPei();
                    if(this.automation[4].activate) this.buyAllAscendU();
                    if(this.automation[5].activate) {this.realityShards=this.totalRealityShards.max(this.totalShards); this.totalRealityShards=this.totalRealityShards.max(this.totalShards);}
                    if(this.automation[6].activate) this.buyAllTranscendU();
                    if(this.automation[7].activate) {this.transcendPoints=this.totalTranscendPoints.max(this.totalTP); this.totalTranscendPoints=this.totalTranscendPoints.max(this.totalTP);}
                    if(this.automation[8].activate) {this.breakCount = this.breakCount.max(Math.floor(this.totalTranscendPoints.div(1e11).max(1).log(10)))}
                    if(this.automation[10].activate) this.buyMaxPeiLife();
                    if(this.automation[11].activate) this.buyMaxTrait1();
                    if(this.automation[12].activate) {this.fosskie = this.fosskie.add(this.fosskiePerClick);this.totalFosskie = this.totalFosskie.add(this.fosskiePerClick);this.resetFosskie = this.resetFosskie.add(this.fosskiePerClick);};
                    if(this.automation[13].activate) this.buyMaxTrait2();
                    if(this.automation[14].activate) this.buyAllHypercendU();
                    if(this.automation[16].activate) this.buyAllHyperChargeU();
                    if(this.automation[18].activate) {this.sweetenCount = this.sweetenCount.max(Math.floor(this.resetFosskie.div(1e176).max(1).log(1e16)))}
                    if(this.automation[19].activate) this.buyMaxTrait3();
                    if(this.automation[21].activate) this.buyAllRefineryU();
                    if(this.automation[22].activate) this.buyAllSpaceU();
                },100);

                //糖块、金佩勒循环
                setInterval(() => {
                    if(this.enableGolden) this.goldenPeiTimer++
                    this.playTime++;
                    if(this.spaceResetCount.gte(1)) this.playTime2=this.playTime2+(this.sugar.toNumber());
                    this.totalPlayTime++;
                    let t = this.goldenPeiTimeCap;
                    let l = this.upgrades.filter(u => u.buildingId == 107 && u.id == 1)[0].unlocked ? 26 : 13;
                    if (this.goldenPeiTimer >= t) {
                        this.goldenPeiVisible = true;
                        setTimeout(() => {
                            this.goldenPeiVisible = false;
                        }, 1000*l);
                        this.goldenPeiTimer = 0;
                    }
                }, 1000);

                //自动保存
                setInterval(() => {
                    this.localSave();
                },10000)
            }
        });
    </script>
</body>
</html>